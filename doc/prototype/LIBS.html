
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML> 
<HEAD>
<TITLE> 
    Object Libraries used by SMOKE
</TITLE>
</HEAD>
   
<BODY>
<H1>
    Object Libraries Used by SMOKE
</H1>

<VAR>!! under construction !!</VAR>

<H2> Introduction</H2>
SMOKE uses the following custom and third-party libraries.  Not all parts of SMOKE
use all of these libraries.  To see which libraries are actually used by a specific
program, consult the appropriate Makefile.  Some of the routines and libraries 
are not yet documented.
<UL>
    <LI>  <A HREF = "#emlib">libemlib.a</A>: Custom SMOKE emissions library
    <LI>  <A HREF = 
          "http://www.iceis.mcnc.org/EDSS/ioapi/H.AA.html#utility">libioapi.a</A>:
           EDSS/Models-3 Input/Output Applications Programming Interface library

    <LI>  <A HREF = "http://www.unidata.ucar.edu/packages/netcdf/">libnetcdf.a</A>:
           Unidata's Network Common Data Form library 
    <LI>  libmo5b: EPA's MOBILE5b library customized for use with SMOKE
    <LI>  libmo5av1: EPA's MOBILE5a library then customized for use with SMOKE
    <LI>  libeps2: EPA's Emissions Preprocessor System 2.0 utility library
</UL>

<HR> <!----------------------------------------------------------------->

<H2><A NAME = "emlib"> libemlib.a </A></H2>

    This library contains some utility routines and routines used by
    more than one SMOKE program.  The routines in it are the following:
    <UL> 
        <LI>                            AGRDSUM:
        <LI>                            CHKXLIN:
        <LI>                            GETFAC:
        <LI>  <A HREF = "#getpkt">      GETPKT: </A>
                                        read packets from control file
        <LI>                            GRPFAC:
        <LI>                            GRPSREF:
        <LI>                            GRPXREF:
        <LI>                            PGRDSUM:
        <LI>  <A HREF = "#rdtprof">     RDTPROF: </A>
                                        read and sort temporal profile packet
        <LI>  <A HREF = "#skipctl">     SKIPCTL: </A>
                                        skip control-file packet
        <LI>                            STATELST:
        <LI>  <A HREF = "#ungridb">     UNGRIDB: </A>
    </UL> 
    Machine-architecture specific versions of this library for SGI
    IRIX5, Sun Solaris 2 (SunOS5), and DEC Alpha/OSF1, can
    presently be found on the EPA research subnet workstations under 
    directory
    <STRONG>/pub/storage/xcc/work/m3em</STRONG> in subdirectories 
    <STRONG>IRIX5, SunOS5,</STRONG> and <STRONG>alphaOSF1</STRONG>.
    Optimized versions are in <STRONG>libemlib.a</STRONG>; versions
    compiled for debug can be found in <STRONG>libemlib.debug.a</STRONG>.
    

<HR><H3> <A NAME = "getpkt">LOGICAL FUNCTION GETPKT( NAME, CDEV )</A></H3>
      <PRE>
      CHARACTER*(*) NAME !  input:  packet name for packet to be skipped
      INTEGER       CDEV !  input:  unit number for ASCII control file
      </PRE> 
    
    rewinds Fortran unit CDEV (assumed to be a control file, 
    then reads through it until a line with control packet NAME is
    encountered.
<P> 

 
    <A HREF = "#gtpz0">GTPZ0</A> to do the transformations.
    <P> 


<HR><H3> <A NAME = "rdtprof">INTEGER FUNCTION RDTPROF</A>( DEV, HEAD, M, N, CODES,
              PFACS )</H3>
      <PRE>
      INTEGER       DEV   !  unit number for profiles file
      CHARACTER*(*) HEAD  !  name of this segment type ('MONTHLY', etc.)
      INTEGER       M     !  number of factors per code
      INTEGER       N     !  maximum number of codes
      INTEGER       CODES( N )      !  list of legal codes
      REAL          PFACS( M, N )   !  returned table of factors
      </PRE>

    Reads the indicated segment from temporal profiles file which must
    have been already opened on unit number DEV, sorts it, and returns 
    the number of records read for programs 
    <A HREF = "AREA.html#TMPAREA">TMPAREA</A>,
    <A HREF = "MOBILE.html#TMPMOBIL">TMPMOBIL</A>, and
    <A HREF = "POINT.html#TMPPOINT">TMPPOINT</A>. 
    <P> 


<HR><H3> <A NAME = "skipctl">LOGICAL FUNCTION SKIPCTL( 
                         NAME, CDEV, LINE, IREC )</A></H3>
      <PRE>
      CHARACTER*(*) NAME    !  packet name for packet to be skipped
      INTEGER       CDEV    !  unit number for control file
      CHARACTER*240 LINE    !  input line buffer
      INTEGER       IREC    !  current line number
      </PRE>
              
    Skips over the control packet with the indicated name in the control 
    file which must have been already opened on CDEV, by reading lines 
    until &quot;END&quot; is encountered for programs 
    <A HREF = "AREA.html#CTLAMAT">CTLAMAT</A> and 
    <A HREF = "POINT.html#CTLPMAT">CTLPMAT</A>.  Returns TRUE (FALSE) if 
    end-of-file not found (is found).
    <P> 


<HR><H3><A NAME = "ungridb"> 
SUBROUTINE UNGRIDB( NCOLS, NROWS, XORIG, YORIG, XCELL, YCELL,
                    NPTS, XLOC, YLOC, NU, CU ) </A></H3>
    <PRE>
    INTEGER         NCOLS, NROWS    !  number of grid columns, rows
    REAL*8          XORIG, YORIG    !  X,Y coords of LL grid corner
    REAL*8          XCELL, YCELL    !  X,Y direction cell size
    INTEGER         NPTS            !  number of target locations
    REAL            XLOC , YLOC     !  X,Y interpolation-target coordinates
    INTEGER         NU( 4,NPTS )    !  single-indexed subscripts into grid
    REAL            CU( 4,NPTS )    !  coefficients
    </PRE>
    Computes &quot;ungridding&quot; matrices used by subroutine
    <A HREF = "#bmatvec">BMATVEC</A> for program LAYPOINT, etc., to
    perform bilinear interpolation from a grid to a set of target
    (point source?) locations 
    <BLOCKQUOTE>
    { &lt;XLOC(S),YLOC(S)&gt;, S=1, ..., NPTS }
    </BLOCKQUOTE>
    More detail on the computation of these coefficients, etc., is
    given in the <A HREF = "#bmatvec">section on BMATVEC()</A>.
    <P> 


<HR> <!--trailing references .................................  -->

<A HREF = "index.html"> 
<STRONG>Top: </STRONG>  
SMOKE Root Document  </A>
<P> 


</BODY>      <!--end body  -->
</HTML>      <!--end html  -->

