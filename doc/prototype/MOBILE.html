
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML> 
<HEAD>
<TITLE> 
    Mobile Source Emissions
</TITLE>
</HEAD>
   
<BODY>
<H1>
    Mobile Source Emissions
</H1>

<H2> Contents </H2>
<UL>
    <LI>  <A HREF = "#Overview"> Processing overview</A>
    <LI>  <A HREF = "#Concepts"> Mobile-specific concepts</A>        
    <LI>  <A HREF = "#Dataflow"> Data flow</A>
        <UL>
            <LI>  <A HREF = "#Intro">Introduction</A>
            <LI>  <A HREF = "#data"> Data Preparation and Import</A>
            <LI>  <A HREF = "#spec"> Speciation Matrix Construction</A>
            <LI>  <A HREF = "#grid"> Gridding/Ungridding Matrix 
                                     Construction</A>
            <LI>  <A HREF = "#pred"> Preprocessing Surface Temperature</A>
            <LI>  <A HREF = "#facs"> Emissions Factor Processing</A>
            <LI>  <A HREF = "#temp"> Temporal Modeling</A>
            <LI>  <A HREF = "#cntl"> Control and Projection</A>
            <LI>  <A HREF = "#xfrm"> Data Transform</A>
        </UL>
    <LI>  <A HREF = "#programs"> Program Specifications</A>
    <LI>  <A HREF = "#dataset">  Mobile Source Data Set Definitions</A>
</UL>


<HR> 

<H2> <A NAME = "Overview"> Processing overview</A> </H2>
<b>  <A NAME = "Essence"> The Essence</A> </b><br>
The essence of mobile source emissions processing in SMOKE is converting link
and county (a.k.a., non-link) vehicle-miles-travelled (VMT) data to hourly
gridded emissions of the chemical species used by a air quality model.  In
order to do  this, SMOKE creates, manages, and applies MOBILE5 emissions
factors to the VMT based on a user-defined definition of a "mobile control
strategy".  This control strategy can define the motor-vehicles parameters
either for a specific year as it actually occurred, or for a hypothetical
control strategy in the past, present, or future.

<P>     <b>  <A NAME = "RawVMT">Raw VMT input data</A> </b><br> Typically, the
raw VMT data are available only as non-link data, that is,  in a form which has
been aggregated by county and <a href = "#RoadClasses"> AIRS AMS road type
code</a>. The AIRS AMS road class code can be replaced by the codes for <a href=
"#RoadClasses"> area type and facility type</a> (please refer to the table below
on that shows the relationship of these).  VMT data may also be available as
link data.  Links are straight road segments that by definition begin and end at
coordinates that may not cross a county boundary.  SMOKE handles both forms of
input data.  The format of these raw inputs can be found in the sections for the
<a href= "#MNLST"> MNLST</a> and <a href= "#MLKLST"> MLKLST</a> files.

<P>
<b>  <A NAME = "M5EmisFacs"> Emission factors created by MOBILE5</A> </b><br>
Emission factors are created in SMOKE using MOBILE5, for a wide variety
of exhaust and evaporative processes and pollutants.  Some of the MOBILE5 inputs
parameters implement control strategies (e.g.,  inspection and maintenance (I/M)
programs, anti-tampering programs (ATPs), and reformulated gas (RFG) ).  Other
MOBILE5 inputs  define other factors contributing to the value of the emissions
factors, such as vehicle registrations (which help define the mix of different
vehicle  types), fuel volatility parameters, speeds, and temperature.  All of
these different dependencies cause mobile SMOKE to be more complicated than
other SMOKE component models.

<P> <b>  <A NAME = "RemainingSteps"> Remaining steps</A> </b><br> 
The remaining mobile source processing steps are speciation, temporal
allocation, projection of VMT (not yet supported by SMOKE), and gridding. 
These are implemented using the standard  emissions cross-reference and profile
approach in which each combination of county, road class, and link is
indirectly assigned a profile number by using a cross-reference file.  A given
profile number is used to find the appropriate temporal profile, speciation
profile, etc., that transform the raw data using factors from the profiles.


<H2> <A NAME = "Concepts"> Mobile-specific concepts</A> </H2>

<P>
<b> <A NAME = "Sources"> Sources</A></b><br>
SMOKE mobile sources are defined in two groups: link and non-link.
Both sources contribute vehicle-miles-traveled (VMT) to the "mobile inventory".
They are defined by the following attributes:
<ul>

<li><b>Link sources:</b> State and county FIPS code, <a href = "#RoadClasses"> 
AIRS AMS road type code </a>, Link ID, (X,Y) coordinates at the start of the link,
(X,Y) coordinates at the end of the link</li> <li><b>Non-link sources:</b>
State and county FIPS code and <a href = "#RoadClasses">AIRS AMS road type code </a>
</li>
</ul>

A link is a straight road segment.  Curved roads must be broken into several
segments for proper spatial allocation. A GIS is typically used to perform
link-source input preparation, but this activity is not integrated into SMOKE. 
Note that because the FIPS code is part of the link-source definition, it is
mandatory that the link coordinates not cross a county boundary.  Finally, the
code used for identifying road class is permitted to be replaced by the
combination of the area type codes and facility type codes (see the section on
AIRS AMS road class code and area/facility IDs).

<P> 
<b> <A NAME = "TempIn"> Temperature inputs</A></b><br> Because the MOBILE5
emission factors used by SMOKE are significantly influenced by temperature, the
most desirable approach from an accuracy standpoint is to model mobile
emissions using gridded, temporalized emissions from a meteorological model.
However, in order to retain the performance benfits of source-based SMOKE
processing, SMOKE has been designed to "ungrid" the temperatures to get a
source-based temperature.  For processing of all kinds, SMOKE expects the a
gridded, temporalized surface-layer temperature file <a href = "#TKDAT">
TKDAT</a> is available.  In order to model emissions using a spatially or
temporally uniform temperature, the program <a href = "UTILS.html#FAKETEMP"> 
FAKETEMP</a> must be used.  This program can create the gridded, temporalized
file expected by SMOKE, but allows the user to make the temperatures uniform 
either spatially, temporally, or both.

<P>
All of the emission factors depend on temperature in some way.  The non-diurnal
emission factors depend on a single temperature, which can be treated as a
source-temperature for a given hour.  They also depend on the minimum
and maximum temperature per day, which in SMOKE, are treated as the minimum and
maximum per source per day.  The diurnal emission factors depend only on the
minimum and maximum temperatures, and in SMOKE, are applied to the
source-based VMT using the minimum and maximum temperatures per source per day.

<P>  
<b> <A NAME = "Ungridding"> Temperature ungridding</A></b><br> The
performance benefits of SMOKE processing can essentially by retained in mobile
processing through the use of "ungridded" temperatures.  These temperatures are
created by averaging the temperatures in the grid cells intersecting the
source, weighted by the fraction of the source's area (for non-link sources)
or length (for link sources) intersecting with those grid cells.   The
ungridding is implemented by building an "ungridding matrix" <a href =
"#MUMAT"> MUMAT</a>, which must be created by <a href = "#GRDMMAT">
GRDMMAT</a> early on in SMOKE processing.

<P>
<b> <A NAME = "PSI"> Parameter Scheme Index (PSI)</A></b><br>

Each emission factor created, managed, and applied by SMOKE has an associated
parameter scheme index (PSI).  The PSI is then defined by 20 indices into
tables containing different input data types used by the MOBILE5 model. The
PSIs are defined in the <a href="#MPREF"> MPREF</a> file, the use of which
will be described in detail in other sections.  A PSI can also be defined by
referencing other PSIs and specifying multipliers for each.  For example, PSI
005 could be calculated from 50 percent of PSI 003 and 50 percent of PSI 002. 
Altough complicated, the PSIs provide significant benefits, including (1)
permitting SMOKE to reduce the number of MOBILE5 runs for a given scenario, (2)
permit SMOKE to reuse MOBILE5 emission factors between scenarios, and (3)
permit the clear definitions of mobile control strategies.

<P>
<b> <A NAME = "Control"> Mobile control strategies</A></b><br> The PSIs
facilitate the clear definition of control strategies.  Such definition is
important since SMOKE's speed creates the possibility of hundreds of
mobile-source control strategies to be run. The components of a control
strategy include all of the control features available in the MOBILE5 model,
such as inspection and maintenance programs, anti-tampering programs, and
reformulated gasoline.  In addition, control strategies can be developed which
explore the mixing of emission factors from different regions in a single
region.  For example, one could examine the impact of control programs in South
Carolina and Georgia on interstate roads in North Carolina. The record of the
control strategy definition is in the file containing the PSI definitions for a
given scenario.


<P>
<b> <A NAME = "EmisProcMode"> Emission processes and emission types</A></b><br>
Mobile SMOKE currently permits many, but not all, of the emissions-forming
processes modeled in the MOBILE5 used by SMOKE.  The supported <b> emission 
processes</b> are the following.
<ul>
<li><b>EXH:</b> "exhaust" emissions for out-of-tailpipe contributions</li>
<li><b>EVP:</b> "evaporative" emissions processes.  Note: EVP = HOT + CRC + WDL.</li>
<li><b>RNL:</b> "running loss" evaporative emissions from running vehicles not accounted for by
         other processs</li>
<li><b>RST:</b> "resting loss" evaporative emissions from resting vehicles, representing the
         time-period after the hot-soak is complete, but not associated with diurnal
         temperature variation.</li>
<li><b>WDL:</b> "weighted diurnal emissions" represent evaporative emissions from the carbon
         canisters (a control feature), that have been sitting for an assumed
         distribution of partial day, full day, and multiple day.</li>
<li><b>DNL:</b> "diurnal emissions" are evaporative emissions due entirely to
         diurnal variations in temperature, but in MOBILE5 depend only on the
         minimum and maximum temperatures during the day.</li>
<li><b>HOT:</b> "hot soak" emissions represent evaporative emissions occuring during
         the time a warmed-up engine has stopped running and is cooling
         down.</li>
<li><b>CRC:</b> "crankcase" emissions are evaporative emissions eminating from the 
         crankcase of vehicles </li>   
</ul>
<b>Emission types</b> are the combinations arising from combining the emission
processes with each of the pollutants output by MOBILE5, for example, EXH_NOX
or EVP_VOC. Each emission type is associated with emission factors produced 
by the MOBILE5 emission factors model.  Mobile SMOKE currently supports the 
following pollutants output by MOBILE5 (although only one volatile component
can be used at once):
<UL>
   <LI> <b>EXH_CO</b>  (g/mi):   Exhaust CO
   <LI> <b>EXH_NOX</b> (g/mi):   Exhaust NOX
   <LI> <b>EXH_VOC</b> (g/mi):   Exhaust VOC
   <LI> <b>EVP_VOC</b> (g/mi):   Evaporative VOC
   <LI> <b>RNL_VOC</b> (g/mi):   Running VOC
   <LI> <b>RST_VOC</b> (g/mi):   Resting VOC, by mile
   <LI> <b>WDL_VOC</b> (g/mi):   Weighted diurnal VOC
   <LI> <b>DNL_VOC</b> (g/mi):   Diurnal VOC
   <LI> <b>HOT_VOC</b> (g/trip): Hot soak evaporative VOC
   <LI> <b>CRC_VOC</b> (g/mi):   Crankcase VOC
</UL>
<p>   
    Because the EVP emissions are a sum of the WDL, HOT, and CRC emissions, it
    is not corrcect to use EVP and any of these three at the same time. 
    Furthermore, since SMOKE does not yet permit input of trip information,
    using the HOT emission factors is incorrect as well.  The recommended
    configuration is the following emission types: EXH_CO, EXH_NOX, EXH_VOC,
    EVP_VOC, RNL_VOC, RST_VOC, DNL_VOC.
    The list of all possible emission types is in the EMTLST variable
    in the <b> MBDIMS3.EXT</b> include file.  

<P>
<b> <A NAME = "GeneralSpc"> Generalized speciation</A></b><br>
The SMOKE mobile processor takes a generalized speciation approach to
applying the speciation profiles.  The inventory pollutants, model species, and
emission processes are all controled using the speciation list file
<a href="#SPCS">SPCS</a>.  The point, area, and biogenics processors will
all have this capability eventually, but do not at this time.  In addition,
SMOKE needs to know about all possible inventory pollutants and model species,
and this information is defined in the <a href= "INCLUDES.html#chdgen">
CHDGEN3.EXT</a> include file.
<p>

<b> <A NAME = "RoadClasses"> Road Classes</A></b><br>

    Mobile source road class information is found in the INCLUDE file
    <A HREF = "INCLUDES.html#mbdims">MBDIMS3.EXT</A>.  Descriptions of the
    road classes and their associated numeric codes are as follows:
<P>

<Table>
<tr align=center>
   <td> <b>Name </b>
   <td> <b>AIRS AMS road type code </b>
   <td> <b>Area type code </b>
   <td> <b>Facility type code </b>
<tr align=center>
   <td align=left> Rural Interstate 
   <td> 110 
   <td> 1 
   <td> 1 
</tr>

<tr align=center>
   <td align=left> Rural Principle Arterial 
   <td> 130 
   <td> 1 
   <td> 2 
</tr>
<tr align=center>
   <td align=left> Rural Minor Arterial 
   <td> 150 
   <td> 1 
   <td> 6 
</tr>
<tr align=center>
   <td align=left> Rural Major Collector 
   <td> 170 
   <td> 1 
   <td> 7 
</tr>
<tr align=center>
   <td align=left> Rural Minor Collector 
   <td> 190 
   <td> 1 
   <td> 8 
</tr>
<tr align=center>
   <td align=left> Rural Local 
   <td> 210 
   <td> 1 
   <td> 9 
</tr>
<tr align=center>
   <td align=left> Urban Interstate 
   <td> 230 
   <td> 0 
   <td> 1 
</tr>
<tr align=center>
   <td align=left> Urban Freeway 
   <td> 250 
   <td> 0 
   <td> 2 
</tr>
<tr align=center>
   <td align=left> Urban Principle Arterial 
   <td> 270 
   <td> 0 
   <td> 4 
</tr>
<tr align=center>
   <td align=left> Urban Minor Arterial 
   <td> 290 
   <td> 0 
   <td> 6 
</tr>
<tr align=center>
   <td align=left> Urban Collector 
   <td> 310 
   <td> 0 
   <td> 7 
</tr>
<tr align=center>
   <td align=left> Urban Local 
   <td> 330 
   <td> 0 
   <td> 9 
</tr>
</table>
<P>

<b> <A NAME = "VehicleTypes"> Vehicle Types</A></b><br>

    Mobile source vehicle type information is found in the INCLUDE file
    <A HREF = "INCLUDES.html#mbdims">MBDIMS3.EXT</A>.  
    The vehicle types are described in the table below.  The codes (e.g., 01 )
    are used in the cross-reference files.<p>
    
<dl>
    <dt> &nbsp; <dd><b>01 </b> LDGV: Light Duty Gasoline Vehicles
    <dt> &nbsp; <dd><b>02 </b> LDGT1: Light Duty Gasoline Trucks 1
    <dt> &nbsp; <dd><b>03 </b> LDGT2: Light Duty Gasoline Trucks 2
    <dt> &nbsp; <dd><b>04 </b> HDGV: Heady Duty Gasoline Vehicles
    <dt> &nbsp; <dd><b>05 </b> LDDV: Light Duty Deisel Vehicles
    <dt> &nbsp; <dd><b>06 </b> LDDT: Light Duty Deisel Trucks
    <dt> &nbsp; <dd><b>07 </b> HDDV: Heavy Duty Deisel Vehicles
    <dt> &nbsp; <dd><b>08 </b> MC:   Motorcycles
</dl>

<H2> <A NAME = "Dataflow"> Dataflow</A> </H2>

<H3><A NAME = "Intro"> Introduction </A></H3>

<b> <A NAME = "Complex"> Mobile more complex than other source types</A></b><br>
Mobile source emissions processing is more complex than SMOKE processing for other
source types, and consequently, it deviates significantly from the general <a
href = "figs/smokfig3.gif"> SMOKE submodel structure</a>.  
The greater complexity of
mobile emissions processing stems from the emission factors, because they are
used to implement control strategies, and because they depend on temperature. 
Particularly for regional simulation, but also for urban simulation,
temperatures vary by grid cell and by hour; therefore, the temperature
dependence of emissions factors entangles the inital stages of mobile emissions
processing and control with the temporalization and gridding stages. 
Furthermore, the emission factors depend on other data that vary at different
temporal and spatial scales that does temperature.  These interactions have led
to some of the inefficiencies and inaccuracies of existing mobile emission
processing systems, and further, suggest that mobile emissions processing does
not fit cleanly into the SMOKE framework.

<P> The following <b>data flow diagram</b> provides a conceptual
overview of the mobile-source processing stages. (Details on the various items
on the figure are given in the next section.)
<P>
<img align=center src="figs/MOBILEnew.gif" alt="Mobile overview diagram">
<P>
A similar diagram is available in the following formats: in
    <A HREF = "figs/MOBIL.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.jpg">JPEG</A>.

<P> In addition, diagrams giving an overview 
    of the main line of SMOKE processing  and how mobile source
    processing fits into that whole are available for 
    <b>UAM</b> air quality modeling in
    <A HREF = "figs/OVERVIEW.UAM.ps">Postscript</A>, in
    <A HREF = "figs/OVERVIEW.UAM.gif">GIF</A>, in
    <A HREF = "figs/OVERVIEW.UAM.xbm">X bitmap</A>, and in
    <A HREF = "figs/OVERVIEW.UAM.jpg">JPEG</A>; 
    and also for <b>EDSS</b> air quality modeling in
    <A HREF = "figs/OVERVIEW.EDSS.ps">Postscript</A>, in
    <A HREF = "figs/OVERVIEW.EDSS.gif">GIF</A>, in
    <A HREF = "figs/OVERVIEW.EDSS.xbm">X bitmap</A>, and in
    <A HREF = "figs/OVERVIEW.EDSS.jpg">JPEG</A>.  Note that additional
    options for analysis and quality assurance processing are detailed
    in the diagrams on mobile source processing.
    <P> 


<H3><A NAME = "data"> Data Preparation and Import </A></H3>

    The mobile source submodel of SMOKE accepts input VMT data for both link
    and non-link sources.  It does not (yet) accept EPS2.0 formatted mobile
    source inputs.  The raw input format is similar to that of EMS-95, but the
    fields in the input files must be delimited by spaces, commas, or some
    other recognized delimiter.  For more information on the input and output
    formats, refer to the sections on individual input and output files.
    
    <P> <b> If raw VMT inputs are used:</b> .
    
    <b><A HREF="#RAWMOBIL"> RAWMOBIL</A> program:</b> Reads in all of the
    raw VMT data and other source characteristics for link and non-link sources
    
    <ul>
    <li>INPUTS:
        <ul>
        
        <li> <a href="#MNLST"> MNLST</a>  (ASCII): Contains a list of all of the
        raw non-link mobile source input files (MNLST section includes format
        for those files)
        <li> <a href="#MLKLST"> MLKLST</a> (ASCII): Contains a list of all of the
        raw link mobile source input files (MLKLST section includes format for
        those files)
        <li> <A HREF = "MERGE.html#ZONES">ZONES</A> (ASCII): Time-zone cross reference
        file (per state/county)
        
        
        </ul> 

    <li>OUTPUTS:
        <ul>
        
	<li> <a href="#MOBL">MOBL</a> (NetCDF): Sorted list of mobile
	sources, called the "emissions source attributes database" or the
	"SMOKE inventory" file.  This file contains the codes (FIPS, Road
	class, link ID ) identifying each source and the average day VMT for
	each source.  This file is used by the <a href= "#GRDMMAT">
	GRDMMAT</a>, <a href= "#PREDIUR"> PREDIUR</a>, <a
	href= "#SPCMMAT"> SPCMMAT</a>, and <a href= "#TMPMOBIL">
	TMPMOBIL</a>, <em><a href= "QA.html#GRDMOBIL"> GRDMOBIL</a> </em>, and
	<a href= "QA.html#CSGMOBIL"> CSGMOBIL</a> programs.<P>

        </ul>

    <li>NOTE:
        <p>
    Both the <a href="#MNLST"> MNLST</a> and <a href="#MLKLST"> MLKLST</a> files are
    optional, but at least one is needed for each run. 
 
    </ul>

    <p> <b> If EPS2.0 raw inputs are used, </b> then you will have to wait for
    the <b> EPSMOBIL</b> processor.

    <p>
    <b>Data flow diagrams</b> for the data preparation and 
    import of mobile source processing are available in 
    <A HREF = "figs/MOBIL.RAW.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.RAW.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.RAW.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.RAW.jpg">JPEG</A>.
    <P> 


<H3><A NAME = "spec"> Speciation Matrix Construction </A></H3>

    <b><A HREF="#SPCMMAT"> SPCMMAT</A> program:</b> Creates the
    mobile-source speciation matrix used to transform each <a href=
    "#EmisProcMode"> emissions type </a> to its model species.
    
    <ul>
    <li>INPUTS:
        <ul>
        
        <li> <a href="MOBL"> MOBL</a>  (NetCDF): SMOKE inventory file from <a
        href= "#RAWMOBIL" > RAWMOBIL</a> 
        <li> <a href="MSPRO"> MSPRO</a> (ASCII): EPS2.0- formatted speciation
           profile
        <li> <A HREF = "#MSREF"> MSREF</A> (ASCII): EPS2.0- formatted 
        speciation cross- references
        <li> <a href= "#MSCNV"> MSCNV</a> (ASCII): Volatile conversion
        factors (e.g., VOC to TOG)
        <li> <a href= "#SPCS"> SPCS</a> (ASCII): Generalized speciation
        file
        
        </ul> 

    <li>OUTPUTS:
        <ul>
        
	<li> <a href="#MSMAT"> MSMAT</a> (NetCDF): Speciation matrix, used
	by  <a href= "MERGE.html#CSGMERGE"> CSGMERGE</a>, and/or <a href=
	"MERGE.html#CSGLMERGE"> CSGLMERGE</a>, and/or <a href= "MERGE.html#CSGLDAYMRG">
	CSGLDAYMRG</a>, and optionally by <em> <a href="QA.html#CSGMOBIL">
	CSGMOBIL</a></em>.<P>

        </ul>
    <li>NOTES:
    <p>
    
    The speciation profiles are matched to the source- level emissions using
    the cross- reference file.  The following source characteristics are used
    to apply these profiles: State and County FIPS code, AIRS AMS road type code,
    link ID (uses stack portion of file format), vehicle type and <a href=
    "#EmisProcMode"> emission type</a>. The cross- reference can be created to
    apply profiles using defaults at any of these levels.
    
    <p>
    The volatile conversion factors are used only if the speciation profiles
    for the volatile inventory pollutant are for a pollutant other than the
    that in the inventory. The need for this file is determined at run time
    automatically by the program. The volatile pollutant that the program will
    expect on input is determined at run time by the <a href= "#SPCS">
    SPCS</a> input file.
    
    </ul>
 
    <P> 
    <b>Data flow diagrams</b> for speciation matrix construction 
    are available in 
    <A HREF = "figs/MOBIL.SPC.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.SPC.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.SPC.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.SPC.jpg">JPEG</A>.
    <P> 


<H3><A NAME = "grid"> Gridding/Ungridding Matrix Construction </A></H3>

    <b><A HREF = "#GRDMMAT"> GRDMMAT</A> program:</b> 
    
    Creates the mobile-source gridding matrix used to transform inventory VMT
    or time- stepped inventory pollutants to gridded output.
    
    <ul>
    <li>INPUTS:
        <ul>
        <li><a href= "#MOBL"> MOBL</a> (NetCDF): SMOKE inventory file from
        the <A HREF= "#RAWMOBIL"> RAWMOBIL</A> program
     	<li> <a href= "MERGE.html#GRIDDESC"> GRIDDESC</a> (ASCII): Parameters
	describing grid and grid projection (of Earth's surface to the plane of
	the grid)
	<li><A HREF= "#MGPRO">MGPRO</A> (ASCII): EPS2.0- formatted or
	"EMS-95"- formatted surrogates
	<li><A HREF= "#MGREF">MGREF</A> (ASCII): EPS2.0- formatted or
	"EMS-95"- formatted surrogate cross- reference file
	<li><em> <A HREF= "#LNKDEF">LNKDEF</A> </em> (ASCII): EPS2.0-
	formatted link definition file

        </ul>
    <li>OUTPUTS:
        <ul>
        
	<li><A HREF = "#MGMAT"> MGMAT</A> (NetCDF): Gridding matrix, used
	by  <a href= "MERGE.html#CSGMERGE"> CSGMERGE</a>, and/or <a href=
	"MERGE.html#CSGLMERGE"> CSGLMERGE</a>, and/or <a href= "MERGE.html#CSGLDAYMRG">
	CSGLDAYMRG</a>, and optionally by <em> <a href="QA.html#CSGMOBIL">
	CSGMOBIL</a> </em> and/or <em> <a href="QA.html#GRDMOBIL"> GRDMOBIL</a>
	</em>
	
	<li><A HREF= "#MUMAT"> MUMAT</A> (NetCDF): Ungridding matrix, used
	by <a href= "#TMPMOBIL"> TMPMOBIL</a> and <a href= "#PREDIUR">
	PREDIUR</a>.
        
        </ul>
        
    <li>NOTES:
        <p>
        The gridding surrogates are matched to the source- level VMT and/or
        emissions using the cross- reference file.  The following source
        characteristics are used to apply these surrogates: State and County
        FIPS code, road class.  The surrogates are not used, of course, for
        link sources.
        
        <p>   
	Three types of gridding methods are used.  Sources which are explicit
	links are gridded/ungridded  by computing intersections between the
	grid cells and the link (so that if half of the length of a link lies
	in a particular cell,  for example, half of the VMT and half of the
	emissions due to the  link are allocated to that cell).  For those
	counties and road classes  for which <A HREF = "#LNKDEF">LNKDEF</A>
	supplies a listing of the road link coordinates, the links are
	intersected with the grid cells, and VMT and emissions are
	gridded/ungridded on the basis of the accumulated fractions of link
	length.  For all other sources, the allocation is performed on the
	basis of surrogate coefficients assigned to sources using the cross
	reference file.
    
    </ul>
 
    <P>
    <b>Data flow diagrams</b> for gridding matrix 
    construction are available in 
    <A HREF = "figs/MOBIL.GRD.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.GRD.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.GRD.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.GRD.jpg">JPEG</A>.
    <P> 


<H3><A NAME = "pred"> Preprocessing Surface Temperatures</A></H3>

    <b><A HREF = "#PREDIUR"> PREDIUR</A> program:</b> 
    
    Processes the surface temperature data in order to calculate the minimum
    and maximum temperatures per day per source, and the minimum and maximum
    temperatures per PSI.

    <ul>
    <li>INPUTS:
        <ul>
        <li><a href= "#MOBL"> MOBL</a> (NetCDF): SMOKE inventory file from
        the <A HREF= "#RAWMOBIL"> RAWMOBIL</A> program
	<li><A HREF= "#MUMAT"> MUMAT</A> (NetCDF): Ungridding matrix, from
        <a href= "#GRDMMAT"> GRDMMAT</a>
	<li><A HREF= "#TKDAT"> TKDAT</A> (NetCDF): Gridded, hourly
	temperatures from meteorology model
	<li><A HREF= "#MPLIST"> MPLIST</A> (ASCII): Simulation-specific
	emissions factors cross- reference file

        </ul>
    <li>OUTPUTS:
        <ul>
        
	<li><A HREF= "#MINMAXT"> MINMAXT</A> (NetCDF): Minimum/maximum
	temperature and index per day for each source, used by <A HREF=
	"#TMPMOBIL"> TMPMOBIL</a>
	<li><a href= "#MEFTEMP"> MEFTEMP</a> (ASCII): Minimum/maximum
	temperature indices for each emission factor, used by <a href=
	"#EMISFAC"> EMISFAC</a>.
	
        </ul>
        
    <li>NOTES:
    
    </ul>

    <p>
    <b>Data flow diagrams</b> for the pre-processing for diurnal
    emission factors are available in 
    <A HREF = "figs/MOBIL.PRD.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.PRD.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.PRD.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.PRD.jpg">JPEG</A>.
    <P> 

<H3><A NAME = "facs"> Emission Factors Processing </A></H3>

    <b><A HREF = "#EMISFAC"> EMISFAC</A> program:</b> 
    
    Drives MOBILE5 to create emission factors for the mobile simulation.

    <ul>
    <li>INPUTS:
        <ul>
        <li><a href= "#MEFTEMP"> MEFTEMP</a> (NetCDF): Minimum/maximum
	temperature indices for each emission factor from 
	<A HREF= "#TMPMOBIL"> TMPMOBIL</A>
	<li><A HREF= "#MPLIST"> MPLIST</A> (ASCII): Simulation-specific
	emissions factors cross- reference file
	<li><A HREF= "#MPREF"> MPREF</a> (ASCII): MOBILE5 parameters cross-
	reference (defines PSIs)
	<li><em><A HREF= "#MEFSND"> MEFSND_IN</A> </em> (NetCDF): Existing
	non-diurnal emission factors from <a href= "#EMISFAC"> EMISFAC</a>
	<li><em><A HREF= "#MEFSD"> MEFSD_IN</A> </em> (NetCDF): Existing
	diurnal emission factors from <a href= "#EMISFAC"> EMISFAC</a>
	<li><em><A HREF= "#MEFUPD"> MEFUPD</A> </em>(ASCII): List of PSIs to
	update in existing emission factor files
	<li> MANY ASCII MOBILE5 input tables, some of which are optional

        </ul>
    <li>OUTPUTS:
        <ul>
        
	<li><A HREF= "#MEFSND"> MEFSND</A>  (NetCDF): 
	Non-diurnal emission factors
	<li><A HREF= "#MEFSD"> MEFSD</A> (NetCDF): 
	Diurnal emission factors 
	
        </ul>
        
    <li>NOTES:
        <p>
        This program can be configured to run using either MOBILE5a (version 1)
        or MOBILE5b.  This choice must be made at compile- time.
        <p>
        
        If the user wishes to use the MOBILE5 input file format directly, the
        <a href= "#MPREF"> MPREF</a> file is the input file that must
        contain these inputs.  The user can concatonate these input files, and
        make some small modifications to the top of each input file segment, as
        described in the  <a href= "#MPREF"> MPREF</a> file documentation.
        <p>
        
        The  <a href= "#EMISFAC"> EMISFAC</a> output files are valid for
        only one year of emission factors, therefore, it is recommended that
        the user maintain one set of files for each year being modeled.  This
        can be done by using the update feature of the program, instead of
        creating a new set of outputs for each run.  Some users may wish to
        maintain a set of emission factor output files for each <em>
        scenario</em>.  This is permitted, but may decrease total emissions
        processing performance, since no emission factors from the previous
        scenario can be reused.
        
    </ul>

    <P> 
    <b>Data flow diagrams</b> for the processing of emissions
    factors are available in 
    <A HREF = "figs/MOBIL.FAC.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.FAC.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.FAC.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.FAC.jpg">JPEG</A>.
    <P> 
    
<H3><A NAME = "temp"> Temporal Processing </A></H3>

    <b><A HREF = "#TMPMOBIL"> TMPMOBIL</A> program:</b> Create the mobile
    source hourly <a href="#EmisProcMode"> emission type</a> emissions file by
    applying the emission factors to the VMT data. the VMT mix, the
    monthly, weekly, and diurnal temporal profiles based on inventory source
    characteristics and the cross-reference file.
    
    <ul>
    <li>INPUTS:
        <ul>
        <li><a href= "#MOBL"> MOBL</a> (NetCDF): SMOKE inventory file from
        the <A HREF= "#RAWMOBIL"> RAWMOBIL</A> program
	<li><A HREF= "#MEFSND"> MEFSND</A>  (NetCDF): 
	Non-diurnal emission factors from <a href= "#EMISFAC"> EMISFAC</a>
	<li><A HREF= "#MEFSD"> MEFSD</A> (NetCDF): 
	Diurnal emission factors from <a href= "#EMISFAC"> EMISFAC</a>
	<li><A HREF= "#TKDAT"> TKDAT</A> (NetCDF): Gridded, hourly
	temperatures from meteorology model
	<li><A HREF= "#MUMAT"> MUMAT</A> (NetCDF): Ungridding matrix, from
        <a href= "#GRDMMAT"> GRDMMAT</a>
	<li><A HREF= "#MINMAXT"> MINMAXT</A> (NetCDF): Minimum/maximum
	temperature and index per day for each source from
        <A HREF = "#PREDIUR"> PREDIUR</A>   
	<li><A HREF= "#MPLIST"> MPLIST</A> (ASCII): Simulation-specific
	emissions factors cross- reference file
	<li><a href= "#MVMTM"> MVMTM</a> (ASCII): VMT mix data
	<li><a href= "#MTPRO"> MTPRO</a> (ASCII): EPS2.0- formatted
	temporal profiles
	<li><A HREF= "#MTREF"> MTREF</a> (ASCII): EPS2.0- formatted
	temporal cross-reference
        <li> <a href= "#SPCS"> SPCS</a> (ASCII): Generalized speciation
        file

        </ul>
    <li>OUTPUTS:
        <ul>
        
	<li><A HREF= "#MTMP"> MTMP</a> (NetCDF): Hourly emission type
	emissions, used by <a href= "MERGE.html#CSGMERGE"> CSGMERGE</a>, and/or <a
	href= "MERGE.html#CSGLMERGE"> CSGLMERGE</a>, and/or <a href=
	"MERGE.html#CSGLDAYMRG"> CSGLDAYMRG</a>, and optionally by <em> <a
	href="QA.html#CSGMOBIL"> CSGMOBIL</a> </em> and/or <em> <a
	href="QA.html#GRDMOBIL"> GRDMOBIL</a></em>
	
        </ul>
        
    <li>NOTES:  <p> The temporal profiles are matched to the source- level
    emissions using the cross- reference file.  The following source
    characteristics are used to apply these profiles: State and County FIPS
    code, AIRS AMS road type code, link ID (uses stack portion of file format),
    <a href="#VehicleTypes"> vehicle type</a>, and <a href= "#EmisProcMode"> 
    emissions process</a>.
    
    <p>
    The emission factors are matched to the source- level VMT using the <a
    href= "#MPLIST"> MPLIST</a> file.  The following source characteristics
    are used to apply the emission factors: State and County FIPS code, AIRS AMS
    road type code, link ID, and hour.
    
    <p>
    The VMT Mix records are matched to the source- level VMT using the <a href=
    "#MVMTM"> MVMTM</a> file.  The following source characteristics are
    used to apply the VMT mix to the aggregate VMT: inventory year, State and
    County FIPS code, AIRS AMS road type code, link ID.

    </ul>
    
    <P> 
    <b>Data flow diagrams</b> for temporal allocation are 
    available in 
    <A HREF = "figs/MOBIL.TMP.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.TMP.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.TMP.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.TMP.jpg">JPEG</A>.
    <P> 


<H3><A NAME = "cntl"> Control and Projection </A></H3>

    No projection routine yet exists in mobile SMOKE.  Controls
    are currently applied only through the MOBILE5 control features
    specified for use by the <A HREF="#EMISFAC"> EMISFAC</A> program.
    Note that due to the
    dependence upon MOBILE5 for the modeling of mobile source
    controls, it is necessary to rerun the temporal model
    <A HREF = "#temp">TMPMOBIL</A> for each new control program
    to be imposed.
    <P>

    <b>Data flow diagrams</b> for applying control
    strategies are available in 
    <A HREF = "figs/MOBIL.FAC.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.FAC.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.FAC.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.FAC.jpg">JPEG</A>.
    <P> 



<H3><A NAME = "xfrm"> Data Transform</A></H3>


    Data transforms are made by combining the inventory VMT
    (from <a href= "#MOBL"> MOBL</a>) or the hourly pollutant emissions
    (from <A HREF = "#MTMP"> MTMP</A>)
    with the various matrices.  Several different types of these transforms are
    possible, for air-quality model input preparation, analysis, or
    visualization.  Please refer to the section on <a href="MERGE.html"> MERGE
    PROCESSING</a> for the detailed input and output file lists.


    <p>
    <b>Three-dimensional air quality modeling inputs merged with other source
    types</b><br>

    The <A HREF = "MERGE.html#CSGLMERGE"> CSGLMERGE</A> and <A HREF =
    "MERGE.html#CSGLDAYMRG"> CSGLDAYMRG</A> programs are used to build
    three-dimensional air quality modeling inputs, appropriate for use in <a
    href= "http://www.iceis.mcnc.org/EDSS/EDSSPage.html#MAQSIP"> MAQSIP</a> or SAQM.   These program read
    all of the component files from the area, point, mobile, and biogenics
    processing stages, and create a single merged output file, <b>EMIS3D</b> or
    <b> EMISC3D</b>. 
    The utility program <a href= "MERGE.html#SMK2SAQM"> SMK2SAQM</a> must be used to
    convert the three-dimensional output file to the format expected by the
    SAQM model.
    
    <p>
    The <b>EMIS3D</b> file can be read by the <a href="http://www.iceis.mcnc.org/EDSS/pave_doc/Pave.html"> PAVE</a>
    visualization package, but the SAQM file cannot.
    
    <p> <b>Two-dimensional air quality modeling inputs merged with other source
    types (UAM)</b><br> 
  
    The <A HREF = "MERGE.html#CSGMERGE"> CSGMERGE</A> program is similar to the
    programs just described for three-dimensional output, but produces a
    two-dimension (single-layer) emissions output file.  This program reads all of
    the component files from the area, point, mobile, and biogenics processing
    stages, and creates a single merged output file, <b>EMIS2D</b> or
    <b>EMISC2D</b>. This
    program is used for UAM-style processing, which separates the air quality
    emissions input files into two files: an elevated and a non-elevated file. 
    The <A HREF = "MERGE.html#CSGMERGE"> CSGMERGE</A> program creates the
    non-elevated file.  In order to convert the <b>EMIS2D</b> file to the
    'EMISSIONS' file format expected by the UAM, the <a href= "MERGE.html#SMK2EMIS">
    SMK2EMIS</a> utility routine must be used. For more information, refer to
    the documentation for the individual programs and for <A HREF =
    "MERGE.html"> merge</A> processing.
  
    <p> The <b>EMIS2D</b> file can be read by the <a href=
    "http://www.iceis.mcnc.org/EDSS/pave_doc/Pave.html"> PAVE</a> visualization package, as can the output
    from <a href= "MERGE.html#SMK2EMIS"> SMK2EMIS</a>
    
    <p> 
    <b>Two-dimensional gridded, hourly, model species emissions</b><br>
 
    The <A HREF = "QA.html#CSGMOBIL"> CSGMOBIL</A> program can be used to generate
    a gridded, model species, hourly mobile-source-only emissions files.   The
    program reads the hourly inventory pollutants file <a href=
    "#MTMP"> MTMP</a>, the gridding matrix <a href= "#MGMAT">
    MGMAT</a>, and the speciation matrix <a href= "#MSMAT"> MSMAT</a>.  The
    outputs from this program can be useful for both analysis and quality
    assurance purposes, but they are not essential to preparing emissions
    inputs for air quality modeling.  This progam outputs the  <b>MGTS</b> file
    (Mobile gridded, hourly, model species), which can be read by the <a
    href="http://www.iceis.mcnc.org/EDSS/pave_doc/Pave.html"> PAVE</a> visualization package.

    <p>
    <b>Gridded, (hourly) inventory pollutant emissions</b><br>
    
    The <A HREF = "QA.html#GRDMOBIL"> GRDMOBIL</A> program can be used to generate
    a gridded VMT data or hourly inventory pollutant mobile-source-only
    emissions files.  The program reads either the inventory file <a href=
    "#MOBL"> MOBL</a> or the hourly emission types file <a href=
    "#MTMP"> MTMP</a>, and the gridding matrix <a href= "#MGMAT">
    MGMAT</a>.  The outputs from this program can be useful for both analysis
    and quality assurance purposes, but they are not essential to preparing
    emissions inputs for air quality modeling.  Depending on the input files,
    this progam outputs the following files:
    
       <ul>
       <li><b>MGRD:</b> Gridded VMT</li>
       <li><b>MGRT:</b> Gridded, hourly, inventory pollutants</li>
       </ul>    
       
    These files can be read by the <a href="http://www.iceis.mcnc.org/EDSS/pave_doc/Pave.html"> PAVE</a>
    visualization package.

    <p>
    <b>Data flow diagrams</b> for generation of gridded, 
    optionally speciated, optionally temporally 
    allocated mobile source emissions are available in 
    <A HREF = "figs/MOBIL.OTHER.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.OTHER.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.OTHER.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.OTHER.jpg">JPEG</A>.
    
    <P> 

<HR>

<H2> <A NAME = "programs"> Mobile Source Programs</A> </H2>

<UL>
    <LI><b>Primary Programs:</b>

    <UL>

        <LI>  <b> <A HREF = "#CTLMMAT"> 
              CTLMMAT</A></b>:  construct mobile source 
              <A HREF = "#MCMAT"> control (projection) matrix 
              file MCMAT</A>

        <LI>  <b><A HREF = "#EMISFAC"> 
              EMISFAC</A></b>:  construct or update master
              MOBILE5 emission factors files
              <A HREF = "#MEFSD">MEFSD</A> and
              <A HREF = "#MEFSND">MEFSND</A>

        <LI>  <b><A HREF = "#GRDMMAT"> 
              GRDMMAT</A></b>:  construct mobile source 
              <A HREF = "#MGMAT">gridding matrix file MGMAT</A> and
              <A HREF = "#MUMAT">ungridding matrix file 
              MUMAT</A>

        <LI>  <b><A HREF = "#PREDIUR"> 
              PREDIUR</A></b>:  preprocess surface temperature data to
              create
              <A HREF = "#MINMAXT"> min/max temp per source file MINMAXT</A>
              and  <A HREF = "#MEFTEMP"> min/max temp per emission 
              factor file MEFTEMP</A>

        <LI>  <b><A HREF = "#RAWMOBIL"> 
              RAWMOBIL</A></b>:  construct mobile source
              binary direct access
              <A HREF = "#MOBL">emissions file MOBL</A>

        <LI>  <b><A HREF = "#SPCMMAT"> 
              SPCMMAT</A></b>:   construct mobile source
              <A HREF = "#MSMAT"> speciation matrix file MSMAT</A>

        <LI>  <b><A HREF = "#TMPMOBIL"> 
              TMPMOBIL</A></b>:  construct hourly vehicle-typed
              mobile source <A HREF = "#MTMP"> temporally allocated
              VMT file MTMP</A>

    </UL>

    <LI><b>Quality Assurance Programs (also see Quality Assurance section):</b>
    <UL>
        <LI>  <b><A HREF = "QA.html#CSGMOBIL"> 
              CSGMOBIL</A></b>:  construct mobile source gridded
              speciated optionally-controlled, temporally allocated (or
              optionally annual)<A HREF = "QA.html#MGTS"> mobile emissions
              file MGTS</A>

        <LI>  <b><A HREF = "QA.html#GRDMOBIL"> 
              GRDMOBIL</A></b>:  construct mobile source
              gridded VMT or inventory-speciated optionally
              temporally allocated (or optionally annual)
              <A HREF = "QA.html#MGRD"> VMT file MGRD</A>
              <A HREF = "QA.html#MGRD"> emissions file MEGRD</A>
    </UL>

    <LI><b>Related Merge Programs (also see Merge section):</b>
    <LI><b>Utilities and Preprocessors (also see Utilities section):</b>
</UL>

<HR>
<H2><a name="CTLMMAT"> CTLMMAT</a> </H2>

    <H2> Summary </H2>

CTLMMAT has not yet been created.  It's purpose will be to implement
control strategy effects that cannot be implemented by MOBILE5.  These
controls will need to be independent of temperature and other gridded data
Because there is little or no precedence for implementing mobile source 
controls in this way, there is much room for innovation with this processor.
We welcome input from any interested parties.
<P>

<HR>
<P>
<H2><a name="EMISFAC"> EMISFAC</a> </H2>

<table >
<tr>
<td><A HREF = "#EMISFAC_DESC"> Description</A>
<td><A HREF = "#EMISFAC_PRORD"> Processing Order</A>
<td><A HREF = "#EMISFAC_INFIL"> Input Files</A>
<td><A HREF = "#EMISFAC_INPAR"> Input Params</A>
<td><A HREF = "#EMISFAC_INENV"> Input Envt Vars</A>
<tr>
<td><A HREF = "#EMISFAC_OUTFIL"> Output Files</A>
<td><A HREF = "#EMISFAC_INCL"> Include File Params</A>
<td><A HREF = "#EMISFAC_UPCOM"> Upcoming Features</A>
<td><A HREF = "#EMISFAC_BUGS"> Known Bugs</A>
<td><A HREF = "#EMISFAC_USAGE"> Usage</A>
</table>

<H3><A NAME = "EMISFAC_DESC"> Description </A></H3>

<b>Overview.</b> The program EMISFAC ensures that the emissions factors needed
for a model run are available by driving EPA's Office of Mobile Sources MOBILE
model to generate diurnal and non-diurnal Emission Factors (EFs) representing
several different <a href= "#EmisProcMode"> emission processes 
</a> for more information). EMISFAC can operate using
essentially the MOBILE input files directly or using a series of tables (which
can be generated by spreadsheets) containing non-default MOBILE inputs. Because
it manages the running of the MOBILE for the emissions, very complex
combinations of emission factors can be generated in a relatively short period
of time. These combinations of emission factors are the way an emissions modeler
implements a mobile control strategy.<p>

<b> MOBILE model.</b> Currently EMISFAC can be compiled to use either MOBILE5a
or MOBILE5b.  Small modifications have been made to both based on the Lake
Michigan Ozone Study (LMOS) changes.  These changes ensure that the evaporative 
emission factors no longer have a diurnal component, which permits additive
operations on the evaporative emission and the diurnal emissions without double
counting. Additional changes have been made so that EMISFAC can better interface
with MOBILE to manage the emission factor simulations.<p>

<b>Parameter Scheme Index.</b> An important concept in mobile emissions modeling
is the Parameter Scheme Index (PSI). The PSIs represent a unique combination of
MOBILE inputs.  For example, one PSI could be used for all counties in a state
with inspection and maintenance (I/M) programs, and another PSI for all counties
with I/M programs. The counties without I/M programs would be assigned the PSI
associated with the non-I/M MOBILE inputs, and the counties with I/M programs
assigned the PSI associated with the I/M MOBILE inputs. The MOBILE parameters
cross-reference file, <a href= "#MPREF"> MPREF</a>, is used to associate the
PSIs with the MOBILE inputs (this is the file in which the user can put all of
the MOBILE input files, for example). The simulation-specific emission factors
cross- reference file, <a href= "#MPLIST"> MPLIST</a>, is used to associate
the PSIs (hence the emission factors) to the mobile sources. The PSIs in <a
href= "#MPLIST"> MPLIST</a> must be a sub-set of the PSIs in <a href=
"#MPREF"> MPREF</a> <p>

<b>Efficiencies.</b> EMISFAC has greater efficiency than other methods of
emission factor processing, which stems from the use of the PSI, and which is
embodied in the input and output configuration of the program.  EMISFAC outputs
two files containing emission factors: a diurnal emission factors file,  <A
HREF= "#MEFSD"> MEFSD</A>, and a non-diurnal emission factors file, <A HREF=
"#MEFSND"> MEFSND</A>.  The emission factors are stored in these files for
each PSI in <a href= "#MPREF"> MPREF</a>, for all vehicle types, and for all
temperatures. <p>

These files are intended to be "master lists" of emission factors, and used for
many different strategy run; therefore, one efficiency is being able to
<b>reuse</b> the emission factors in these files for many different runs. Since
the <a href= "#MPREF"> MPREF</a> stores the definitions of all of the
emission factors in <A HREF="#MEFSD"> MEFSD</A> and <A HREF="#MEFSND">
MEFSND</A>, there is always a record of what these emission factors represent.
When new emission factors need to be added, or existing ones need to be
corrected, the user can update these files instead of generating new files.<p>

EMISFAC can <b> reduce </b> the number of MOBILE runs not only by permitted
reuse and updating, but also by running MOBILE for only those speeds required in
the definitions of the PSIs and for a limited number of temperatures. The
treatment of temperatures is explained in more detail below. <p>

Finally, EMISFAC has efficiency by permitting users to <b> recycle</b> emission
factors.  Implementation of this is described in the section about <a href=
"#MPREF"> MPREF</a>, but in general, this feature allows users to create a
new PSI based on a combination of other PSIs.  Such treatment can be useful when
the emissions modeler knows the percentages of VMT in one county contributed by
vehicles from other counties that have different emission factors. <p>

<b>Temperatures.</b> The processor has been designed to limit the number of
temperatures for which MOBILE must be run. Temperatures are treated differently
for diurnal and non-diurnal EFs.  In order to calculate diurnal EFs, requires
outputs from <a href= "#PREDIUR"> PREDIUR</a> that give information on the
minimum/maximum temperatures for all days in the run for each EF.  For
non-diurnal EFs, EMISFAC requires a run-time-specified starting and ending
temperature (in degree F) for which EFs are to be calculated.  It then 
calculates all EFs on a 2 degree F increment over that interval. Note that when
the user inputs MOBILE files directly, the temperatures in this file are
ignored.<P>

<H3><A NAME = "EMISFAC_PRORD"> Processing Order</A></H3>

EMISFAC must be run after <a href= "#RAWMOBIL">
RAWMOBIL</a>, <a href= "#GRDMMAT"> GRDMMAT</a>, and <a href= "#PREDIUR">
PREDIUR</a>.  If diurnal emission factors are being used, EMISFAC must be run
for each new meteorology scenario to update the diurnal emission factor master
file for the new minimum and maximum temperature combinations from the new
meteorology. If a new control stratgy is added, EMISFAC must be run to create
the emission factors added as part of the strategy. The following <b> data flow
diagram</b> provides a conceptual overview of using EMISFAC. <p>

<img align=center src="figs/MOBIL.FAC.gif" alt="Mobile emission factor generation diagram">
<p>
A similar diagram is also available in 
    <A HREF = "figs/MOBIL.FAC.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.FAC.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.FAC.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.FAC.jpg">JPEG</A>.

<H3><A NAME = "EMISFAC_INFIL"> Input Files </A></H3>
The <a href= " "> logical file names </a> (see introduction for definition of
these) of the input files and their descriptions are the following.
        <ul>
        <li><a href= "#MEFTEMP"> MEFTEMP</a> (NetCDF): Minimum/maximum
	temperature indices for each emission factor from 
	<A HREF= "#TMPMOBIL"> TMPMOBIL</A>
	<li><A HREF= "#MPLIST"> MPLIST</A> (ASCII): Simulation-specific
	emissions factors cross- reference file
	<li><A HREF= "#MPREF"> MPREF</a> (ASCII): MOBILE5 parameters cross-
	reference (defines PSIs)
	<li><em><A HREF= "#MEFSND"> MEFSND_IN</A> </em> (NetCDF): Existing
	non-diurnal emission factors from <a href= "#EMISFAC"> EMISFAC</a>
	<li><em><A HREF= "#MEFSD"> MEFSD_IN</A> </em> (NetCDF): Existing
	diurnal emission factors from <a href= "#EMISFAC"> EMISFAC</a>
	<li><em><A HREF= "#MEFUPD"> MEFUPD</A> </em>(ASCII): List of PSIs to
	update in existing EF files
	<li> Many tables of MOBILE parameters, all of which are optional, 
	as noted
        
	    <ul>
	    <li><em><A HREF = "#MACUM"> MACUM</a> </em> (ASCII):
	    mileage accumulation rates profiles file
	    <li><em><A HREF = "#MAVSPD"> MAVSPD</a> </em> (ASCII): average
	    speeds profiles file (Only optional if not using tables at all)
	    <li><em><A HREF = "#MBSEXH"> MBSEXH</a> </em> (ASCII): basic
	    exhaust emissions rates profiles file
	    <li><em><A HREF = "#MCTOFF"> MCTOFF</a> </em> (ASCII): cutoffs
	    point records for I/M 240
	    <li><em><A HREF = "#MDLSF"> MDLSF</a> </em> (ASCII): diesel
	    fuels sales fractions profiles file
	    <li><em><A HREF = "#MEFATP"> MEFATP</a> </em> (ASCII):
	    anti-tampering programs effects profiles file
	    <li><em><A HREF = "#MEFIM"> MEFIM</a> </em> (ASCII): inspection
	    and maintanence programs effects profiles file
	    <li><em><A HREF = "#MEFLEV"> MEFLEV</a> </em> (ASCII): LEV
	    program effects profiles file
	    <li><em><A HREF = "#MEFRFL"> MEFRFL</a> </em> (ASCII): refueling
	    controls parameters profiles file
 	    <li><em><A HREF = "#MLAPMO"> MLAPMO</a> </em> (ASCII): LAP/
	    month profiles file (Only optional if not using tables at all)
	    <li><em><A HREF = "#MLOAD"> MLOAD</a> </em> (ASCII): A/C usages,
	    extra loading, trailer, humidity effects profiles file
 	    <li><em><A HREF = "#MNEVAP"> MNEVAP</a> </em> (ASCII): New
	    evaporative emissions tests profiles file
 	    <li><em><A HREF = "#MOPMOD"> MOPMOD</a> </em> (ASCII): operating
	    modes profiles file (Only optional if not using tables at all)
	    <li><em><A HREF = "#MOXYF"> MOXYF</a> </em> (ASCII): oxygenated
	    fuels parameters profiles file
	    <li><em><A HREF = "#MPREST"> MPREST</a> </em> (ASCII):
	    functional pressure test profiles file
	    <li><em><A HREF = "#MPURGT"> MPURGT</a> </em> (ASCII):
	    functional purge test profiles file
 	    <li><em><A HREF = "#MRGDS"> MRGDS</a> </em> (ASCII):
	    registration distributions profiles file
	    <li><em><A HREF = "#MTLEN"> MTLEN</a> </em> (ASCII): trip length
	    distribution profiles file
	    <li><em><A HREF = "#MTRATE"> MTRATE</a> </em> (ASCII): tampering
	    rates profiles file

            </ul>
    </ul>

<H3><A NAME = "EMISFAC_INPAR"> Input Parameters </A></H3>
     <ul>
     <li><b>Modeling year</b>: Enter the year for which the emission factors
     should be calculated.  Only one year for each set of output emissions
     factor files is permited.  Valid entries include any year from 1970 - 2020
     valid for MOBILE5a runs, and 1970 - 2050 valid for MOBILE5b.
     <li><b>Type of hydrocarbon emission</b>: Valid entries include the
     following, where
        <ul>
        <li> THC: Total Hydrocarbon (flame ionization detector hydrocarbons,
             methane, ethane)
        <li> NMH: Non-methane Hydrocarbons (THC less methane)
        <li> VOC: Volatile Organic Compounds (NMH less ethane and corrected for
             aldehydes)
        <li> TOG: Total Organic Gases (THC corrected for aldehydes)
        <li> NMO: Non-methane Organic Gases (NMH corrected for non-hydrocarbon
             reactive compounds, i.e. formaldehyde and acetaldehyde)
        </ul>
     <li><b>Start temperature</b>: First temperature for generating non-diurnal
     emission factors.  Valid range is 50. to 100. degrees F, but can be changed
     through the include file parameters.
     <li><b>End temperature:</b> Last temperature for generating non-diurnal
     emission factors.  Valid range is 50. to 110. degrees F, but can be changed
     through the include file parameters.
     </ul>

<H3><A NAME = "EMISFAC_INENV"> Input Environment Variables </A></H3>
     <ul>
     <li><b>EMS_LOC </b>: Location of all MOBILE supplemental input tables, such
     as imdata.d, tech12.d, etc. (See MOBILE documentation for more
     information).
     <li><b>MO5AIN</b>: Full path and file name of temporary work file for
     building MOBILE input files.
     <li><b>DEFAULT_IM</b>: This variable has two settings:
         <ul>
         <li><b>Y</b>: Use default I/M factors files throughout
         <li><b>N</b>: Prompt for I/M factors files for each I/M program
         </ul>
     <li><b>LOGFILE</b>: If this environment variable is defined as a valid
     physical file name, the program's
     errors, warnings, notes, and other information will be recorded in this
     file. Otherwise, that information will be written to standard output.<p>
     </ul>
     
<H3><A NAME = "EMISFAC_OUTFIL"> Output Files </A></H3>
     <ul>
     <li><A HREF= "#MEFSND"> MEFSND</A>  (NetCDF): 
     Non-diurnal emission factors
     <li><A HREF= "#MEFSD"> MEFSD</A> (NetCDF): 
     Diurnal emission factors 
     </ul>

<H3><A NAME = "EMISFAC_INCL"> Include file parameters </A></H3>

The following include files are used by EMISFAC.  In this section, we highlight
included parameters that users may need to modify to suit their particular
simulation needs for this program, and these are listed in alphabetical order
for each  include file. The include filess are listed in the order that they
appear in the source code. Refer to the section on <a href= "INCLUDES.html">
include files</a> for specific details about the parameters.

     <ul>
     <li><a href= "INCLUDES.html# "> CHDGEN3.EXT</a>: Generalized speciation 
     parameters
     <li><a href= "INCLUDES.html# "> MBDIMS3.EXT</a>: Mobile-specific parameters
        <ul>
        <li><b>MAXT_MIN</b>: Minumum for the maximum temperature for EFs
        <li><b>MAXT_MAX</b>: Maximum for the maximum temperature for EFs
        <li><b>MAXTMP</b>: Maximum number of temperatures for non-diurnal emissions
        <li><b> MAXT12</b>: Maximum number of Tech-IV+ configurations
        <li><b>MAXT4P</b>: Maximum number of Tech I-II configurations
        <li><b>MINT_MIN</b>: Minumum for the minimum temperature for EFs
        <li><b>MINT_MAX</b>: Maximum for the minimum temperature for EFs
        <li><b>MXBER</b>: Maximum number of Basic Emission Rates records
        <li><b>MXFACS</b>: Maximum number in any MOBILE profiles table
        <li><b>MXM5PSI</b>: Maximum number of PSIs per MOBILE5A or MOBILE5B packet
        <li><b>MXNPT</b>: Maximum number of other PSIs in combination (recycled) PSI
        <li><b>MXPLST</b>: Maximum number of MPLIST cross-reference entries
        <li><b>MXPPS</b>: Maximum number of PSIs per source
        <li><b>MXPREF</b>: Maximum number of PSIs using MOBILE input parameter
            tables
        <li><b>MXPSI</b>: Maximum total number of PSIs
        <li><b>MXTMMI</b>: Maximum number of minimum and maximum temperature 
            combinations per PSI
        <li><b>SAVTMP</b>: Maximum number of saved temperatures or minimum and maximum
            temperature combinations used for multi-scenario MOBILE input files
        <li><b>TINTV</b>: Temperature increment for diurnal and non-diurnal EFs
        </ul>
     <li><a href= "INCLUDES.html# "> PARMS3.EXT</a>: I/O API parameters
     <li><a href= "INCLUDES.html# "> IODECL3.EXT</a>: I/O API function 
         declarations
     <li><a href= "INCLUDES.html# "> FDESC3.EXT</a>: I/O API file description 
     data structures
     <li><a href= "INCLUDES.html# "> NETCDF.EXT</a>: NetCDF declarations
     </ul>
     
<H3><A NAME = "EMISFAC_UPCOM"> Upcoming Features </A></H3>
     <ul> 
     <li>Support of MOBILE6 (once MOBILE6 is released by EPA OMS)
     </ul>
<H3><A NAME = "EMISFAC_BUGS"> Known Bugs </A></H3>

    <ul>
    <li>No bugs known at this time
    </ul>
    <p>
If problems other than those on this list are found, please report to <ADDRESS> <A HREF="mailto:smoke@mcnc.org"> smoke@mcnc.org </A></ADDRESS>

<H3><A NAME = "EMISFAC_USAGE"> Usage</A></H3>
 
<PRE>
#
#   set up environment variables (logical names) of input files:
#
 
setenv MO5AIN  &lt;path-name for temporary MOBILE5a input file&gt
setenv MEFSD   &lt;path-name for master diurnal EF file&gt
setenv MEFSND  &lt;path-name for master non-diurnal EF file&gt
setenv MEFTEMP &lt;path-name for minimum/maximum temperature per PSI file&gt
setenv MPLIST  &lt;path-name for parameter scheme list&gt
setenv MPREF   &lt;path-name for general MOBILE5a parameter x-ref file&gt

setenv MACUM   &lt;path-name for mileage accumulation rates profiles file&gt
setenv MAVSPD  &lt;path-name for average speeds profiles file&gt
setenv MBSEXH  &lt;path-name for basic exhaust emissions rates profiles file&gt
setenv MCTOFF  &lt;path-name for cutoffs point records for I/M 240&gt
setenv MDLSF   &lt;path-name for diesel fuels sales fractions profiles file&gt
setenv MEFATP  &lt;path-name for anti-tampering programs effects profiles file&gt
setenv MEFIM   &lt;path-name for inspection and maintanence programs effects profiles file&gt
setenv MEFLEV  &lt;path-name for LEV program effects profiles file&gt
setenv MEFRFL  &lt;path-name for refueling controls parameters profiles file&gt
setenv MLAPMO  &lt;path-name for LAP/ month profiles file&gt
setenv MLOAD   &lt;path-name for A/C usages, extra loading, trailer, humidity effects profiles file&gt
setenv MNEVAP  &lt;path-name for new evaporative emissions tests profiles file&gt
setenv MOPMOD  &lt;path-name for operating modes profiles file&gt
setenv MOXYF   &lt;path-name for oxygenated fuels parameters profiles file&gt
setenv MRGDS   &lt;path-name for functional pressure test profiles file&gt
setenv MPREST  &lt;path-name for functional purge test profiles file&gt
setenv MPURGT  &lt;path-name for registration distributions profiles file&gt
setenv MTLEN   &lt;path-name for trip length distribution profiles file&gt
setenv MTRATE  &lt;path-name for tampering rates profiles file&gt


#
#   now run the program, using a here-document to supply the input (note, the
#   command-line inputs to this program vary depending on the characteristics
#   of a specific scenario).
#
emisfacl &lt&lt EOF
Yes, continue with the program
MO5AIN                     ! Temporary MOBILE5a input file 
NONE                       ! Non-diurnal master list file or none
NONE                       ! Diurnal master list file or none
MEFTEMP                    ! EF-based min/max temperature file
MPLIST                     ! Simulation-specific parameter scheme list
MPREF                      ! general MOBILE5a parameter x-ref file
1988                       ! modeling year
VOC                        ! type of hydrocarbon emission desired
55.                        ! start temperature in deg F
105.                       ! end temperature in deg F
MEFSND                     ! Non-diurnal master list file
MEFSD                      ! Diurnal master list file
MLAPMO                     ! LAP/month records index
MOPMOD                     ! Operating modes for all vehicle types
EOF
#
#   done
#
</PRE>

<hr> 

<H2> <a name="GRDMMAT"> GRDMMAT </a></H2>
<table >
<tr>
<td><A HREF = "#GRDMMAT_DESC"> Description</A>
<td><A HREF = "#GRDMMAT_PRORD"> Processing Order</A>
<td><A HREF = "#GRDMMAT_INFIL"> Input Files</A>
<td><A HREF = "#GRDMMAT_INPAR"> Input Params</A>
<td><A HREF = "#GRDMMAT_INENV"> Input Envt Vars</A>
<tr>
<td><A HREF = "#GRDMMAT_OUTFIL"> Output Files</A>
<td><A HREF = "#GRDMMAT_INCL"> Include File Params</A>
<td><A HREF = "#GRDMMAT_UPCOM"> Upcoming Features</A>
<td><A HREF = "#GRDMMAT_BUGS"> Known Bugs</A>
<td><A HREF = "#GRDMMAT_USAGE"> Usage</A>
</table>

<H3><A NAME = "GRDMMAT_DESC"> Description </A></H3>



    <b>Overview.</b> This program constructs both gridding and <a
    href="#Ungridding"> ungridding</a> matrices <A HREF = "#MGMAT">MGMAT</A>
    and <A HREF = "#MUMAT">MUMAT</A>.  The former is used to transform
    source-based records to gridded records, and is used to transform gridded
    meteorology into source-level meteorology for the programs <A HREF =
    "#TMPMOBIL">TMPMOBIL</A> and <A HREF = "#PREDIUR"> PREDIUR</A>. 
    This program also generates statistics report about the dimensionality and
    &quot;fullness&quot; of the sparse matrices constructed. <p>

    <b>Ungridding.</b>The performance benefits of SMOKE processing can
    essentially by retained in mobile processing through the use of "ungridded"
    temperatures. These temperatures are created by averaging the temperatures
    in the grid cells intersecting the source, weighted by the fraction of the
    source's area (for non-link sources) or length (for link sources)
    intersecting with those grid cells. <p>

    <b>Gridding.</b> Three types of gridding methods are used.  Sources which
    are explicit links are gridded/ungridded  by computing intersections between
    the grid cells and the link (so that if half of the length of a link lies in
    a particular cell,  for example, half of the VMT and half of the emissions
    due to the  link are allocated to that cell).  For those counties and road
    classes  for which <A HREF= "#LNKDEF"> LNKDEF</A> supplies a listing
    of the road link coordinates, the links are intersected with the grid cells,
    and VMT and emissions are gridded/ungridded on the basis of the accumulated
    fractions of link length.  For all other sources, the allocation is
    performed on the basis of surrogate coefficients assigned to sources using
    the cross reference file.<p>
    
    <b>Gridding surrogates.</b> Gridding surrogates are used to transform the
    county-based (non-link) sources to a gridded domain. These surrogates are
    factors that indicate the fraction of a source (county) should be allocated
    to each grid cell. There are many different types of surrogates.  The most
    simple is the "area" surrogate, which is simply the fraction of the
    are from each county that intersects with the grid cells overlapping that
    county. Other surrogates commonly used for mobile emissions processing are
    the "major highways" surrogate and the "population" surrogate.
    
    <b>Gridding cross-reference usage.</b> The gridding cross-reference file
    describes which gridding surrogates are to be used for specific sources or
    types of sources.  GRDMMAT permits the assigning of surrogates to sources
    based on the state and county FIPS code and the road class. A hierarchical
    system is used to apply the surrogates in which the most specific
    assignments are applied first, followed by the next most specific, etc. For
    example, the cross-reference file could have a default set for all counties
    and road classes to use population as a surrogate, but a handful of
    counties and road classes to use major highways.

<H3><A NAME = "GRDMMAT_PRORD"> Processing Order</A></H3>

    The GRDMMAT processor must be proceeded by the <A HREF="#RAWMOBIL">
    RAWMOBIL</A> processor, and it must come before the <A HREF="#PREDIUR">
    PREDIUR</A> processor. Because the output files <A HREF="#MGMAT">
    MGMAT</A> and <A HREF="#MUMAT"> MUMAT</A> depend only on the grid
    structure, a single run of GRDMMAT can be used for many runs of <A HREF=
    "#PREDIUR"> PREDIUR</A> (for multiple temperature input files),  <A
    HREF="#TMPMOBIL"> TMPMOBIL</A> (for multiple periods or  multiple
    control strategies), and the other programs which depend on them. The
    following <b> data flow diagram</b> provides a conceptual overview of using
    GRDMMAT. <p>
        
    <img src="figs/MOBIL.GRD.gif" alt="Mobile gridding diagram"><p>
    
    A similar diagram is also available in 
    <A HREF = "figs/MOBIL.GRD.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.GRD.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.GRD.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.GRD.jpg">JPEG</A> formats.<P>

<H3><A NAME = "GRDMMAT_INFIL"> Input Files </A></H3>
The <a href= " "> logical file names </a> (see introduction for definition of
these) of the input files and their descriptions are the following.

        <ul>
        <li><a href= "#MOBL"> MOBL</a> (NetCDF): SMOKE inventory file from
        the <A HREF= "#RAWMOBIL"> RAWMOBIL</A> program
     	<li> <a href= "MERGE.html#GRIDDESC"> GRIDDESC</a> (ASCII): Parameters
	describing grid and grid projection (of Earth's surface to the plane of
	the grid)
	<li><A HREF= "#MGPRO">MGPRO</A> (ASCII): EPS2.0- formatted or
	"EMS-95"- formatted surrogates
	<li><A HREF= "#MGREF">MGREF</A> (ASCII): EPS2.0- formatted or
	"EMS-95"- formatted surrogate cross- reference file
	<li><em> <A HREF= "#LNKDEF">LNKDEF</A> </em> (ASCII): EPS2.0-
	formatted link definition file
        </ul>

<H3><A NAME = "GRDMMAT_INPAR"> Input Parameters </A></H3>
    <ul> 
    <li>NONE 
    </ul>
    
<H3><A NAME = "GRDMMAT_INENV"> Input Environment Variables </A></H3>
    <ul>
    <li><b>LOGFILE</b>: If this environment variable is defined as a valid
    physical file name, the program's
    errors, warnings, notes, and other information will be recorded in this
    file. Otherwise, that information will be written to standard output.<p>
    </ul>
    
<H3><A NAME = "GRDMMAT_OUTFIL"> Output Files </A></H3>
        <ul>
        
	<li><A HREF = "#MGMAT"> MGMAT</A> (NetCDF): Gridding matrix, used
	by  <a href= "MERGE.html#CSGMERGE"> CSGMERGE</a>, and/or <a href=
	"MERGE.html#CSGLMERGE"> CSGLMERGE</a>, and/or <a href= "MERGE.html#CSGLDAYMRG">
	CSGLDAYMRG</a>, and optionally by <em> <a href="QA.html#CSGMOBIL">
	CSGMOBIL</a> </em> and/or <em> <a href="QA.html#GRDMOBIL"> GRDMOBIL</a>
	</em>
	
	<li><A HREF= "#MUMAT"> MUMAT</A> (NetCDF): Ungridding matrix, used
	by <a href= "#TMPMOBIL"> TMPMOBIL</a> and <a href= "#PREDIUR">
	PREDIUR</a>.
        
        </ul>

<H3><A NAME = "GRDMMAT_INCL"> Include file parameters </A></H3>

The following include files are used by GRDMMAT.  In this section, we highlight
included parameters that users may need to modify to suit their particular
simulation needs for this program, and these are listed in alphabetical order
for each  include file. The include filess are listed in the order that they
appear in the source code. Refer to the section on <a href= "INCLUDES.html">
include files</a> for specific details about the parameters.

    <UL> 
    <li><a href= "INCLUDES.html#grdims"> GRDIMS3.EXT</a>: grid parameters
        <UL> 
        <LI>  <b>NGRID</b>: the number of cells in the grid
        <LI> <b>NMATX</b>: the number of gridding coefficients.  This
        parameter significantly affects the size of the GRDMMAT output files.
        <LI> <b>GRDNM</b>: The name of the grid being used, as defined in the
        <a href= "MERGE.html#GRIDDESC"> GRIDDESC</a> file.
        </UL>
        
    <li><a href= "INCLUDES.html#mbdims"> MBDIMS3.EXT</a>: mobile-source dimensioning parameters
        <UL>  
        <LI><b>NMSRC</b>: Number of mobile sources

        <LI><b>MXCFIP</b>: Maximum number of cells per State and County FIPS
        code

        <LI><b>MXSCEL</b>: Maximum number of sources per cell

        <LI><b>MXLNKD</b>: Maximum number of links in the LINKDEF file

        <LI><b>MXGCOF</b>: Maximum number of coefficients in the output
            matrices

        </UL>
    <li><a href= "INCLUDES.html#parms3"> PARMS3.EXT</a>:  I/O API parameters
    <li><a href= "INCLUDES.html#iodecl3"> IODECL3.EXT</a>: I/O API function declarations
    <li><a href= "INCLUDES.html#fdesc3"> FDESC3.EXT</a>:  I/O API file description data structures.
    </UL>
    <p>
        
    GRDMMAT reports the total number of coefficients in the gridding and
    ungridding matrices, and the maximum, minimum, and mean numbers of sources
    per cell in the gridding matrix and cells per source in the ungridding
    matrix.  It can be run with output file logical names set to
    &quot;NONE&quot;, in order to find out the  maximum numbers, for use in
    dimensioning the work arrays  used  internally for computing the gridding
    matrix.<p>

    In case the dimensioning for the matrix or for internal work arrays is
    insufficient, GRDMMAT will recognize and report the fact to the  program
    log; in that case, the user needs to increase the dimensioning by changing
    the appropriate PARAMETER statements and re-compile the relevant parts of
    SMOKE.  <P>

<H3><A NAME = "GRDMMAT_UPCOM"> Upcoming Features </A></H3>
    <ul>
    <li>Updated processing algorithm to reduce memory requirements
    </ul>

<H3><A NAME = "GRDMMAT_BUGS"> Known Bugs </A></H3>
    <ul>
    <li>No bugs known at this time
    </ul>
    <p>
If problems other than those on this list are found, please report to <ADDRESS><A
HREF="mailto:smoke@mcnc.org"> smoke@mcnc.org </A></ADDRESS>
    
<H3><A NAME = "GRDMMAT_USAGE"> Usage</A></H3>

<PRE>
#
#   set up environment variables (logical names) of input files:
#
setenv GRIDDESC &lt;path-name for grid definitions file&gt;
setenv LNKDEF   &lt;path-name for link definitions file&gt;
setenv MGREF    &lt;path-name for surrogate cross-reference file&gt;
setenv MGPRO    &lt;path-name for surrogate coefficient file&gt;
setenv MOBL     &lt;path-name for area source inventory file&gt;
setenv MGMAT    &lt;path-name for output gridding matrix&gt;
setenv MUMAT    &lt;path-name for output ungridding matrix&gt;
#
# now run the program, using a here-document to supply the input:
#
grdmmat  &lt;&lt;  EOF
Yes, continue with the program
MOBL                 !  logical name of mobile source inventory file
MGREF                !  " " for surrogate cross-reference file
MGPRO                !  " " surrogate coefficient file
LNKDEF               !  " " link definitions file, or "NONE"
MGMAT                !  " " output gridding matrix, or "NONE"
MUMAT                !  " " output ungridding matrix, or "NONE"
EOF
#
</PRE><P> 

<HR> 

<H2> <a name="PREDIUR"> PREDIUR </a></H2>
 
<table >
<tr>
<td><A HREF = "#PREDIUR_DESC"> Description</A>
<td><A HREF = "#PREDIUR_PRORD"> Processing Order</A>
<td><A HREF = "#PREDIUR_INFIL"> Input Files</A>
<td><A HREF = "#PREDIUR_INPAR"> Input Params</A>
<td><A HREF = "#PREDIUR_INENV"> Input Envt Vars</A>
<tr>
<td><A HREF = "#PREDIUR_OUTFIL"> Output Files</A>
<td><A HREF = "#PREDIUR_INCL"> Include File Params</A>
<td><A HREF = "#PREDIUR_UPCOM"> Upcoming Features</A>
<td><A HREF = "#PREDIUR_BUGS"> Known Bugs</A>
<td><A HREF = "#PREDIUR_USAGE"> Usage</A>
</table>

<H3><A NAME = "PREDIUR_DESC"> Description </A></H3>



    <b>Overview.</b> The program PREDIUR processes the surface layer temperature
    data  file <A HREF="#TKDAT"> TKDAT</A> in order to calculate the minimum
    and maximum temperatures per day per source. It also creates a file that
    contains the minimum and maximum temperatures per emission factor. This
    program is necessary to be able to create and apply the diurnal emission
    factors in the <A HREF="#EMISFAC"> EMISFAC</A> and  <A
    HREF="#TMPMOBIL"> TMPMOBIL</A> programs. <p>

    <b>Definition of a "day".</b> PREDIUR seeks to obtain the minimum and
    maximum temperature for a source for each day, which is necessary for
    processing diurnal emissions.  However, the definition of a "day" differs
    for sources in different time zones.  Instead of trying to determine the
    different days for the different sources, PREDIUR bases each source's "day"
    on the GMT time zone. If the sources of interest are in time zones other
    than GMT, this is okay for all U.S, time zones, as the 4 to 9 hour
    difference will have a small impact on the determination of minimum and
    maximum daily temperatures, because the maximum daily temperature typically
    occurs in  mid-afternoon, and the minimum daily temperature typically
    occurs in the early morning hours. <p>

    <b>Time zone for input temperatures.</b> The program assumes that the time
    zone of the temperature data is GMT.  If the available temperature data are
    not in GMT, the <a href= "http://www.iceis.mcnc.org/EDSS/ioapi/H.M3TSHIFT.html"> m3tshift</a> IO/API
    program can be used to convert the temperature data. <p>
    
    <b>Minimum/Maximum range and increment.</b> Only certain minimum and
    maximum combinations are allowable in SMOKE, depending on the parameters
    defined at compile time in the INCLUDE file <A HREF= "INCLUDE.html#mbdims">
    MBDIMS3.EXT</A> . A mimimum for the minimum temperatures (MINT_MIN), 
    maximum for the minimum temperatures (MINT_MAX), minimum for the maximum
    temperatures (MAXT_MIN), maximum for the maximum temperatures (MAXT_MAX),
    and a temperature interval (TINTV) are all set in the INCLUDE file. These
    parameters should be set prior to compiling SMOKE, depending on the actual
    range expected during mobile emissions processing.  The values of these
    parameters are constrained by the limitations of MOBILE5 such that the
    minima must be between 0 degrees F and 100 degrees F, and the maxima must
    be between 10 degrees F and 110 degrees F. <p>

    <b>Minimum/Maximum Indexing.</b> In SMOKE, a sequential index
    code for each min/max temperature  combination is assigned by sorting all
    temperature combinations  with maximum temperature cycling fastest.   All
    combinations are retained in this sorted order, including combinations that
    do not make sense (such as  min=60 and max=50), and the index to each of
    these combinations is set to its placement in the sorted list.  These
    indices are assigned to each source and written to the <A HREF=
    "#MINMAXT"> MINMAXT</A> file.  If the actual min/max for the source
    violates any of the constraints of MOBILE5 (such as max - min &gt 40 degrees
    F) or if the minimum and/or maximum is  outside the compile-time range,  a
    warning is written to standard I/O and the nearest valid index number is
    assigned. These index codes are also used to summarize the min/max
    temperature combinations needed for each PSI (see <A HREF= "#MPREF">
    MPREF</A>), and this information is stored in the  <A HREF="#MEFTEMP">
    MEFTEMP</A> file. <p>
    
<H3><A NAME = "PREDIUR_PRORD"> Processing Order</A></H3>
    The PREDIUR processor must be proceeded by the <A HREF="#GRDMMAT">
    GRDMMAT</A> processor in order to create a valid ungridding matrix.  
    Each PREDIUR run does not necessarily require a 
    <A HREF="#GRDMMAT"> GRDMMAT</A> run, because the ungridding matrix 
    may be used for multiple PREDIUR runs. The following <b> data flow
    diagram</b> provides a conceptual overview of using PREDIUR. <p>
     
    <img src= "figs/MOBIL.PRD.gif" alt="Mobile preprocessing for diurnal emission factors diagram"><p>
    
    A similar diagram is also available in
    <A HREF="figs/MOBIL.PRD.ps "> Postscript </A>, in
    <A HREF="figs/MOBIL.PRD.gif"> GIF </A>, in 
    <A HREF="figs/MOBIL.PRD.xbm"> X bitmap </A>, and in 
    <A HREF="figs/MOBIL.PRD.jpg"> JPEG </A> formats. 
    <P>
 
<H3><A NAME = "PREDIUR_INFIL"> Input Files </A></H3>
        <ul>
        <li><a href= "#MOBL"> MOBL</a> (NetCDF): SMOKE inventory file from
        the <A HREF= "#RAWMOBIL"> RAWMOBIL</A> program
	<li><A HREF= "#MUMAT"> MUMAT</A> (NetCDF): Ungridding matrix, from
        <a href= "#GRDMMAT"> GRDMMAT</a>
	<li><A HREF= "#TKDAT"> TKDAT</A> (NetCDF): Gridded, hourly
	temperatures (degrees Kelvin) from meteorology model
	<li><A HREF= "#MPLIST"> MPLIST</A> (ASCII): Simulation-specific
	emissions factors cross- reference file
        </ul>

<H3><A NAME = "PREDIUR_INPAR"> Input Parameters </A></H3>
    <ul>
    
    <li> <b>Starting date</b>: Enter the starting date in Julian format
    (YYYYDDD) or Gregorian format (YYYYMMDD) for the first day of temperatures
    needing preprocessing.  If this date is incompatible with the date(s) of the
    <A HREF="#TKDAT"> TKDAT</A> an error will result.  The value of the
    starting date should be given with respect to the GMT time zone.

    <li> <b>Starting time</b>: Enter the starting time in the format HHMMSS for
    the first hour of the output file.  If this time is incompatible with the
    time(s) of the <A HREF="#TKDAT"> TKDAT</A> an error will result. The
    value of the starting time should be given with repect to the GMT time zone.

    <li> <b>Duration</b> in hours specifies how many hours of temperature data
    will be preprocessed. If the duration is incompatible with the duration(s)
    of the <A HREF="#TKDAT"> TKDAT</A> an error will result.
    </ul>
    
<H3><A NAME = "PREDIUR_INENV"> Input Environment Variables </A></H3>
    <ul>
    <li><b>LOGFILE</b>: If this environment variable is defined as a valid
    physical file name, the program's
    errors, warnings, notes, and other information will be recorded in this
    file. Otherwise, that information will be written to standard output.<p>
    </ul>
    
<H3><A NAME = "PREDIUR_OUTFIL"> Output Files </A></H3>
        <ul>
        
	<li><A HREF= "#MINMAXT"> MINMAXT</A> (NetCDF): Minimum/maximum
	temperature and index per day for each source, used by <A HREF=
	"#TMPMOBIL"> TMPMOBIL</a>
	<li><a href= "#MEFTEMP"> MEFTEMP</a> (ASCII): Minimum/maximum
	temperature indices for each emission factor, used by <a href=
	"#EMISFAC"> EMISFAC</a>.
	
        </ul>
    
<H3><A NAME = "PREDIUR_INCL"> Include file parameters </A></H3>

The following include files are used by PREDIUR.  In this section, we highlight
included parameters that users may need to modify to suit their particular
simulation needs for this program, and these are listed in alphabetical order
for each  include file. The include filess are listed in the order that they
appear in the source code. Refer to the section on <a href= "INCLUDES.html">
include files</a> for specific details about the parameters.

    <UL> 
    <li><a href= "INCLUDES.html#grdims"> GRDIMS3.EXT</a>: grid parameters
        <UL> 
        <LI>  <b>NGRID</b>: the number of cells in the grid
        <LI> <b>NMATX</b>: the number of gridding coefficients.  This
        parameter significantly affects the size of the GRDMMAT output files.
        </UL>
        
    <li><a href= "INCLUDES.html#mbdims"> MBDIMS3.EXT</a>: mobile-source dimensioning parameters
        <UL>  
        <LI><b>NMSRC</b>: Number of mobile sources
        <li><b>MXPLST</b>: Maximum number of MPLIST cross-reference entries
        <li><b>MXPPS</b>: Maximum number of PSIs per source
        <li><b>MXPSI</b>: Maximum total number of PSIs
        <li><b>MXTMMI</b>: Maximum number of minimum and maximum temperature 
        </UL>
        
    <li><a href= "INCLUDES.html#parms3"> PARMS3.EXT</a>:  I/O API parameters
    <li><a href= "INCLUDES.html#iodecl3"> IODECL3.EXT</a>: I/O API function declarations
    <li><a href= "INCLUDES.html#fdesc3"> FDESC3.EXT</a>:  I/O API file description data structures.
    <li><a href= "INCLUDES.html#const3"> CONST3.EXT</a>:  Physical and
         mathematical constants.
    </UL>
    <p>
        
    In case the dimensioning for the matrix or for internal work arrays is
    insufficient, PREDIUR will recognize and report the fact to the  program
    log; in that case, the user needs to increase the dimensioning by changing
    the appropriate PARAMETER statements and re-compile the relevant parts of
    SMOKE.  <P>
    
<H3><A NAME = "PREDIUR_UPCOM"> Upcoming Features </A></H3>
    <ul> 
    <li> Update minimum/maximum temperature storage to use only valid min/max
    temperature combinations.  This will decrease storage requirements for the
    output file and memory requirements.<p>
    </ul>
    
<H3><A NAME = "PREDIUR_BUGS"> Known Bugs </A></H3>
    <ul>
    <li>No bugs known at this time
    </ul>
    <p>
    
If problems other than those on this list are found, please report to <ADDRESS><A
HREF="mailto:smoke@mcnc.org"> smoke@mcnc.org</A></ADDRESS> 
    
<H3><A NAME = "PREDIUR_USAGE"> Usage</A></H3>

<PRE>
#
#   set up environment variables (logical names) of input files:
#

setenv MOBL     &lt;path-name for SMOKE mobile source annual inventory file&gt;
setenv MUMAT    &lt;path-name for mobile source ungridding matrix file&gt;
setenv TKDAT    &lt;path-name for surface temperature file&gt;
setenv MPLIST   &lt;path-name for emissions simulation-specific x-ref list&gt;
setenv MEFTEMP  &lt;path-name for minimum/maximum temperature per PSI file&gt
setenv MINMAXT  &lt;path-name for ungridded min/max temperature file&gt;

#
#   now run the program, using a here-document to supply the input (note, the
#   command-line inputs to this program vary depending on the characteristics
#   of a specific scenario).
#
prediur &lt&lt EOF
Yes, continue with the program
MOBL                    !  mobile source annual inventory file
MUMAT                   !  ungridding matrix file
TKDAT                   !  surface temperature file
MPLIST                  !  emissions simulation-specific x-ref list
1988200                 !  starting date, YYYYDDD or YYYYMMDD
000000                  !  starting time, HHMMSS
24                      !  output duration (hours)
MINMAXT                 !  ungridded min/max temperature file
MEFTEMP                 !  EF-based min/max temperature file
EOF
#
#   done
#
</PRE>

<HR> 


<P>
<H2><a name="RAWMOBIL"> RAWMOBIL</a></H2>

<table >
<tr>
<td><A HREF = "#RAWMOBIL_DESC"> Description</A>
<td><A HREF = "#RAWMOBIL_PRORD"> Processing Order</A>
<td><A HREF = "#RAWMOBIL_INFIL"> Input Files</A>
<td><A HREF = "#RAWMOBIL_INPAR"> Input Params</A>
<td><A HREF = "#RAWMOBIL_INENV"> Input Envt Vars</A>
<tr>
<td><A HREF = "#RAWMOBIL_OUTFIL"> Output Files</A>
<td><A HREF = "#RAWMOBIL_INCL"> Include File Params</A>
<td><A HREF = "#RAWMOBIL_UPCOM"> Upcoming Features</A>
<td><A HREF = "#RAWMOBIL_BUGS"> Known Bugs</A>
<td><A HREF = "#RAWMOBIL_USAGE"> Usage</A>
</table>

<H3><A NAME = "RAWMOBIL_DESC"> Description </A></H3>


<b> Overview.</b> RAWMOBIL inputs non-link (county) and link-based
vehicle-miles-traveled (VMT) data and creates a sorted list of mobile sources
<a href="#MOBL">MOBL</a>, called the "emissions source attributes database"
or the "SMOKE inventory" file.  Each entry in this file is a <a
href="#Sources">mobile source</a>, and has associated VMT. It is not
necessary to define the source on a more specific basis, such as the <a href=
"#VehicleTypes"> vehicle type</a>, because all operations of other processing
stages are performed on <b>all</b> vehicle types.  This is not to say that all
vehicle types for each source get the same temporal profile or speciation
profile. This source definition is simply a very useful and appropriate way of
breaking up an inventory for SMOKE-style processing, but is not the only way
the source could have been defined.<P>

<b> Multiple Raw VMT Input Files.</b> The program can read source data from
many individual link and non-link VMT input files by using special input files
that list these raw data files.  These files are <a href= "#MNLST">
MNLST</a> and <a href= "#MLKLST"> MLKLST</a>. These files are also used to set
the inventory year for each of the individual input files (see the sections on 
MNLST and MLKLST for more information). The current version of mobile SMOKE
supports the use of only the same inventory year for all input files, because
VMT projection has not yet been added to the system.<p>

<b>Input format.</b> For the input format of the files for this program, please
refer to the sections on <a href= "#MNLST"> MNLST (non-link raw data input
format) </a> and <a href="#MLKLST"> MLKLST (link raw data input format) </a>.<p>

<b>Units of input data.</b> The SMOKE system expects that VMT data are in units
of miles/day.  This "day" can take many forms, depending on the intention of
the user and the temporal adjustments applied in latter processing stages.  For
example, the day could be average annual  day, average summer day, or peak July
day.<P>

<H3><A NAME = "RAWMOBIL_PRORD"> Processing Order</A></H3>

<b>Order of processing:</b> The RAWMOBIL processor must be run before
all of the other mobile SMOKE processors. The following <b> data flow
diagram</b> provides a conceptual overview of using RAWMOBIL. <p>

<img align=center src="figs/MOBIL.RAW.gif" alt="Mobile raw data import diagram">

<P> (This diagram is also available in <A
HREF="figs/MOBIL.RAW.ps "> Postscript </A>, in <A HREF="figs/MOBIL.RAW.gif"> GIF </A>, in
<A HREF="figs/MOBIL.RAW.xbm"> X bitmap </A>, and in <A HREF="figs/MOBIL.RAW.jpg"> JPEG
</A> formats.)<P>
 

<H3><A NAME = "RAWMOBIL_INFIL"> Input Files </A></H3>
        <ul>
        
        <li> <a href="#MNLST"> MNLST</a>  (ASCII): Contains a list of all of the
        raw non-link mobile source input files
        <li> <a href="#MLKLST"> MLKLST</a> (ASCII): Contains a list of all of the
        raw link mobile source input files
        <li> <A HREF = "MERGE.html#ZONES">ZONES</A> (ASCII): Time-zone cross reference
        file (per state/county)
                
        </ul> 
     
<H3><A NAME = "RAWMOBIL_INPAR"> Input Parameters </A></H3>
     <ul>

     <li> <b>UTM zone for link data:</b> Enter the UTM to which all
     link data will be converted.  This zone is placed in the file header by
     use in latter processing stages.

     </ul>
     
<H3><A NAME = "RAWMOBIL_INENV"> Input Environment Variables </A></H3>
     <ul>
     <li><b>LOGFILE</b>: If this environment variable is defined as a valid
     physical file name, the program's
     errors, warnings, notes, and other information will be recorded in this
     file. Otherwise, that information will be written to standard output.<p>
     </ul>
     
<H3><A NAME = "RAWMOBIL_OUTFIL"> Output Files </A></H3>
        <ul>
        
	<li> <a href="#MOBL">MOBL</a> (NetCDF): Sorted list of mobile
	sources, called the "emissions source attributes database" or the
	"SMOKE inventory" file.  This file contains the codes (FIPS, Road
	class, link ID) identifying each source and the average day VMT for
	each source.  This file is used by the <a href= "#GRDMMAT">
	GRDMMAT</a>, <a href= "#PREDIUR"> PREDIUR</a>, <a
	href= "#SPCMMAT"> SPCMMAT</a>, and <a href= "#TMPMOBIL">
	TMPMOBIL</a>, <em><a href= "QA.html#GRDMOBIL"> GRDMOBIL</a> </em>, and
	<a href= "QA.html#CSGMOBIL"> CSGMOBIL</a> programs.<P>

        </ul>

<H3><A NAME = "RAWMOBIL_INCL"> Include file parameters </A></H3>
        
The following include files are used by RAWMOBIL.  In this section, we
highlight included parameters that users may need to modify to suit their
particular simulation needs for this program, and these are listed in
alphabetical order for each include file. The include filess are listed in the
order that they appear in the source code. Refer to the section on <a href=
"INCLUDES.html"> include files</a> for specific details about the parameters.

    <ul>
    <li><a href= "INCLUDES.html#mbdims"> MBDIMS3.EXT</a>: mobile-source dimensioning parameters
        <UL>  
        <li><b>MXLSRC</b>: Maximum number of link sources
        <li><b>MXNSRC</b>: Maximum number of non-link sources
        <li><b>MXPLST</b>: Maximum number of MPLIST cross-reference entries
        <li><b>MXPPS</b>: Maximum number of PSIs per source
        <li><b>MXPSI</b>: Maximum total number of PSIs
        <li><b>MXTMMI</b>: Maximum number of minimum and maximum temperature 
        <LI><b>NMSRC</b>: Number of mobile sources
        <li><b>NRCLAS</b>: Number of road classes
        </UL>
    <li><a href= "INCLUDES.html#tmdims"> TMDIMS3.EXT</a>: Temporal allocation
    dimensioning parameters    
    <li><a href= "INCLUDES.html#parms3"> PARMS3.EXT</a>:  I/O API parameters
    <li><a href= "INCLUDES.html#iodecl3"> IODECL3.EXT</a>: I/O API function declarations
    <li><a href= "INCLUDES.html#fdesc3"> FDESC3.EXT</a>:  I/O API file description data structures.
    <li><a href= "INCLUDES.html#const3"> CONST3.EXT</a>:  Physical and
         mathematical constants.
    </UL>
    <p>
        
    In case the dimensioning for the matrix or for internal work arrays is
    insufficient, RAWMOBIL will recognize and report the fact to the  program
    log; in that case, the user needs to increase the dimensioning by changing
    the appropriate PARAMETER statements and re-compile the relevant parts of
    SMOKE.  <P>

<H3><A NAME = "RAWMOBIL_UPCOM"> Upcoming Features </A></H3>
    <ul>
    <li> Multiple inventory years in the same input file - will require
    creation of CTLMMAT, a program that will create the control and 
    projection matrices.
    <li> <b>UTM zone</b> will no longer be necessary when all 
    coordinates will be converted to LAT/LON.
    
    </ul>

<H3><A NAME = "RAWMOBIL_BUGS"> Known Bugs </A></H3>
    <ul>
    <li>No bugs known at this time
    </ul>
    
<H3><A NAME = "RAWMOBIL_USAGE"> Usage</A></H3>
<PRE>
#
#   set up environment variables (logical names) of input files:
#

setenv MNLST  &lt;path-name for mobile main raw data files list;&gt
setenv MLKLST &lt;path-name for mobile link-specific VMT data files list;&gt
setenv ZONES  &lt;path-name for time-zone-to-FIPS file;&gt
setenv MOBL   &lt;path-name for SMOKE mobile source file;&gt
#
# now run the program, using a here-document to supply the input:
#
rawmobil &lt&lt EOF
Yes, continue with the program
ZONES                      ! time-zone-to-FIPS file
17                         ! UTM zone for output link sources
MLKLST (or "NONE")         ! link sources input data file list
MNLST  (or "NONE")         ! non-link sources input data file list
MOBL                       ! output inventory file
EOF
#
#   done
#
</PRE>

<HR> 

<H2> <a name="SPCMMAT">SPCMMAT </a></H2>

<table >
<tr>
<td><A HREF = "#SPCMMAT_DESC"> Description</A>
<td><A HREF = "#SPCMMAT_PRORD"> Processing Order</A>
<td><A HREF = "#SPCMMAT_INFIL"> Input Files</A>
<td><A HREF = "#SPCMMAT_INPAR"> Input Params</A>
<td><A HREF = "#SPCMMAT_INENV"> Input Envt Vars</A>
<tr>
<td><A HREF = "#SPCMMAT_OUTFIL"> Output Files</A>
<td><A HREF = "#SPCMMAT_INCL"> Include File Params</A>
<td><A HREF = "#SPCMMAT_UPCOM"> Upcoming Features</A>
<td><A HREF = "#SPCMMAT_BUGS"> Known Bugs</A>
<td><A HREF = "#SPCMMAT_USAGE"> Usage</A>
</table>

<H3><A NAME = "SPCMMAT_DESC"> Description </A></H3>

<b>Overview.</b> SPCMMAT creates the speciation matrix for the mobile sources.
This matrix is then used in the merge step to apply the speciation factors to
the emissions for each <a href= "#EmisProcMode"> emission type</a> in the
temporalized emissions file.<p>

<b>Generalized speciation.</b> This program is capable of setting the model
species that will be output at run-time.  This is controlled by the speciation
list file <a href= "#SPCS"> SPCS</a>. For more information on <a href=
"#GeneralSpc"> generalized speciation</a>, please refer to the <a href=
"#Concepts"> mobile-specific concepts</a> section. <p>

<b>Volatile conversions.</b> In some cases, the volatile pollutant in the
inventory is not the same as the volatile pollutant for which the volatile
speciation profiles, <a href= "#MSPRO"> MSPRO</a>, are available.  SMOKE will
permit these disparate inputs to be used, but an additional input is required
that contains factors to convert the volatile inventory pollutant to that of
the profile.  This additional input is known as the volatile conversion factors
file, <a href= "#MSCNV"> MSCNV</a>.<p>

<b>Speciation cross-reference usage.</b>

    The speciation cross-reference file describes which speciation profiles are
    to be used for transforming the volatile inventory pollutant to the
    volatile model species for specific sources or types of sources.  SPCMMAT
    permits the assigning of profiles to sources based on the state and county
    FIPS code, the road class, the link ID, the vehicle type, and the emissions
    process. A hierarchical system is used to apply the profiles in which the
    most specific assignments are applied first, followed by the next most
    specific, etc. For example, the cross-reference file could have all of one
    state to use one profile, but diurnal emissions processes in that state
    would use another profile.
       
<H3><A NAME = "SPCMMAT_PRORD"> Processing Order</A></H3>
    
    The SPCMMAT processor is independent of the other mobile sources
    processors, and can therefore be run at any time after <a href= "#RAWMOBIL">
    RAWMOBIL </a> program and before one the merge programs <A HREF =
    "QA.html#CSGMOBIL"> CSGMOBIL</A>, <A HREF = "MERGE.html#CSGMERGE">CSGMERGE</A>, or
    <A HREF = "MERGE.html#CSGLMERGE"> CSGLMERGE</A>. The following <b> data flow
    diagram</b> provides a conceptual overview of using SPCMMAT. <p>
 
    <img align=center src="figs/MOBIL.SPC.gif" alt="Mobile speciation diagram" > <p>
    
    A similar diagram is also available in 
    <A HREF = "figs/MOBIL.SPC.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.SPC.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.SPC.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.SPC.jpg">JPEG</A><p>
    
<H3><A NAME = "SPCMMAT_INFIL"> Input Files </A></H3>
        <ul>
        
        <li> <a href="MOBL"> MOBL</a>  (NetCDF): SMOKE inventory file from <a
        href= "#RAWMOBIL" > RAWMOBIL</a> 
        <li> <a href="MSPRO"> MSPRO</a> (ASCII): EPS2.0- formatted speciation
        cross-references
        <li> <A HREF = "#MSREF"> MSREF</A> (ASCII): EPS2.0- formatted 
        speciation cross- refereences
        <li> <a href= "#MSCNV"> MSCNV</a> (ASCII): Volatile conversion
        factors (e.g., VOC to TOG)
        <li> <a href= "#SPCS"> SPCS</a> (ASCII): Generalized speciation
        file
        
        </ul>
    
<H3><A NAME = "SPCMMAT_INPAR"> Input Parameters </A></H3>
     <ul>
     <li>NONE
     </ul>

<H3><A NAME = "SPCMMAT_INENV"> Input Environment Variables </A></H3>
     <ul>
     <li><b>LOGFILE</b>: If this environment variable is defined as a valid
     physical file name, the program's
     errors, warnings, notes, and other information will be recorded in this
     file. Otherwise, that information will be written to standard output.<p>
     </ul>
     
<H3><A NAME = "SPCMMAT_OUTFIL"> Output Files </A></H3>
        <ul>
        
	<li> <a href="#MSMAT"> MSMAT</a> (NetCDF): Speciation matrix, used
	by  <a href= "MERGE.html#CSGMERGE"> CSGMERGE</a>, and/or <a href=
	"MERGE.html#CSGLMERGE"> CSGLMERGE</a>, and/or <a href= "MERGE.html#CSGLDAYMRG">
	CSGLDAYMRG</a>, and optionally by <em> <a href="QA.html#CSGMOBIL">
	CSGMOBIL</a></em>.<P>

        </ul>

<H3><A NAME = "SPCMMAT_INCL"> Include file parameters </A></H3>
    
The following include files are used by SPCMMAT.  In this section, we
highlight included parameters that users may need to modify to suit their
particular simulation needs for this program, and these are listed in
alphabetical order for each include file. The include filess are listed in the
order that they appear in the source code. Refer to the section on <a href=
"INCLUDES.html"> include files</a> for specific details about the parameters.

    <UL>
    <li><a href= "INCLUDES.html#chdgen"> CHDGEN.EXT</a>: generalizes speciation parameters
        <UL>  
        <li><b>MXIPOL</b>: Maximum number of inventory pollutants
        <li><b>MXMPOL</b>: Maximum number of model pollutants
        <li><b>MXSCNV</b>: Maximum number of volatile conversion facotors
        <li><b>MXSPRO</b>: Maximum number of speciation profiles
        </UL>
    <li><a href= "INCLUDES.html#mbdims"> MBDIMS3.EXT</a>: mobile-source dimensioning parameters
        <UL>  
        <li><b>MXDET</b>: Maximum number of diurnal emission types
        <li><b>MXEPRC</b>: Maximum number of MC emissions processes
        <li><b>MXNDET</b>: Maximum number of non-diurnal emission types
        <LI><b>NMSRC</b>: Number of mobile sources
        <li><b>NRCLAS</b>: Number of road classes
        <li><b>NVTYPE</b>: Number of vehicle types
        </UL>
    <li><a href= "INCLUDES.html#parms3"> PARMS3.EXT</a>:  I/O API parameters
    <li><a href= "INCLUDES.html#iodecl3"> IODECL3.EXT</a>: I/O API function declarations
    <li><a href= "INCLUDES.html#fdesc3"> FDESC3.EXT</a>:  I/O API file description data structures.
    </UL>
    <p>
        
    In case the dimensioning for the matrix or for internal work arrays is
    insufficient, SPCMMAT will recognize and report the fact to the  program
    log; in that case, the user needs to increase the dimensioning by changing
    the appropriate PARAMETER statements and re-compile the relevant parts of
    SMOKE.  <P>
    
<H3><A NAME = "SPCMMAT_UPCOM"> Upcoming Features </A></H3>
    <ul>
    <LI>NONE
    </ul>
    
<H3><A NAME = "SPCMMAT_BUGS"> Known Bugs </A></H3>
    <ul>
    <LI>No bugs known at this time
    </ul>
    
<H3><A NAME = "SPCMMAT_USAGE"> Usage</A></H3>

<PRE>
#
#   set up environment variables (logical names) of input files:
#
setenv MOBL    &lt;path-name for area source inventory file&gt;
setenv MSCNV   &lt;path-name for volatile conversion factors file&gt;
setenv MSMAT   &lt;path-name for output speciation matrix&gt;
setenv MSPRO   &lt;path-name for speciation profile file&gt;
setenv MSREF   &lt;path-name for speciation cross-reference file&gt;
setenv SPCS    &lt;path-name for speciation list file&gt;
#
# now run the program, using a here-document to supply the input:
#
spcmmat  &lt;&lt;  EOF
Yes, continue with the program
MOBL                    !  area source inventory file
MSREF                   !  speciation cross-reference file
MSPRO                   !  speciation profile (coefficient) file
SPCS                    !  speciation list file
MSCNV                   !  volatile conversion file (optional)
MSMAT                   !  output speciation matrix
EOF
#
</PRE>
 
<HR>  

<H2> <a name="TMPMOBIL">TMPMOBIL </a></H2> 

<table >
<tr>
<td><A HREF = "#TMPMOBIL_DESC"> Description</A>
<td><A HREF = "#TMPMOBIL_PRORD"> Processing Order</A>
<td><A HREF = "#TMPMOBIL_INFIL"> Input Files</A>
<td><A HREF = "#TMPMOBIL_INPAR"> Input Params</A>
<td><A HREF = "#TMPMOBIL_INENV"> Input Envt Vars</A>
<tr>
<td><A HREF = "#TMPMOBIL_OUTFIL"> Output Files</A>
<td><A HREF = "#TMPMOBIL_INCL"> Include File Params</A>
<td><A HREF = "#TMPMOBIL_UPCOM"> Upcoming Features</A>
<td><A HREF = "#TMPMOBIL_BUGS"> Known Bugs</A>
<td><A HREF = "#TMPMOBIL_USAGE"> Usage</A>
</table>

<H3><A NAME = "TMPMOBIL_DESC"> Description </A></H3>



    <b>Overview.</b> The TMPMOBIL program starts with average day VMT and ends
    with hourly emissions foreach modeled <a href= "#EmisProcMode"> emissions
    type</a>.  The average day VMT for each source (county, road class,
    optional link) are divided into VMT for each vehcile type.  For each hour,
    these VMT are then multiplied by the emission factors for the source, hour,
    and source-temperature, and by the temporal profiles needed to apply the
    monthly, weekly, and hourly temporal adjustements. The resulting emissions
    are stored for each <a href= "#EmisProcMode"> emissions type</a>.<p>
    
    <b>Application of VMT Mix.</b>
    Each FIP/roadclass- or link-based source has all of the VMT for all
    vehicle types.  In order to apply emission factors based on vehicle
    type, the VMT must be disaggregated to the vehicle types using 
    fractions known as the VMT mix.  The VMT mix is applied using the
    <A HREF="#MVMTM"> MVMTM</A> file, which has both the 
    cross-reference information and
    the VMT mix percentages.  Currently, SMOKE does not permit the VMT mix
    to vary by date or hour, but does permit it to vary by year.  This
    limitation will be updated to include hour-specific VMT mix percentages
    on a need basis.
    <P>

    <b>Interpolation of emission factors.</b>
    During processing, the emission factor values used for a given source/
    vehicle type/emission type is estimated for an exact temperature
    from the emission factors calculated at the surrounding temperatures on
    the even increment.  
    <P>

    For example, given a temperature range starting at 50 degrees F and an 
    increment of 2 degrees F, a non-diurnal factor required at 77.5 would 
    be linearly interpolated from the factors calculated 
    (by <A HREF="#EMISFAC"> EMISFAC</A>) at 76 and 78 degrees F.
    <P>
    Diurnal emission factors require four factors for a two-dimensional 
    linear interpolation.  Given a minimum-minimum and minimum-maximum of
    50 degrees F and a 2 degree F interval, suppose an 
    emission factor is required at minimum = 77.5 and maximum = 99.5.  The
    four diurnal emission factors that would be needed are at [min,max]
    temperatures of [76,98], [78,98], [76,100], and [78,100].
    <P>
     
    <b>Temporal cross-reference matching.</b>
    In case of missing entries in the temporal cross reference file, TMPMOBIL
    first looks for cross reference entries for other 
    <A HREF="#VehicleTypes"> vehicle types</A> or <A HREF="#EmisProcMode"> 
    emission processes</A> at the same level in the search hierarchy before 
    descending to the next level in the hierarchy.  For example, if 
    a source has a temporal cross reference entry for vehicle type LDGV 
    but not for HDDV, TMPMOBIL will use the source-specific LDGV temporal 
    cross reference entry for allocating VMT for HDDV from that source in
    preference to using a spatially-less-specific default HDDV temporal 
    profile.  Using the cross-reference, the temporal profiles can be applied 
    by state and county FIPS code, AIRS AMS road type code, link ID, vehicle type,
    and emissions type.<P> 

<H3><A NAME = "TMPMOBIL_PRORD"> Processing Order</A></H3>
    The TMPMOBIL processor must be proceeded by the RAWMOBIL, GRDMMAT, 
    PREDIUR, and EMISFAC processors so that all required inputs will
    exist.  The following <b>data flow diagrams</b> provides a conceptual
    overview of using TMPMOBIL<p>
    
    <img align=center src="figs/MOBIL.TMP.gif" alt="Mobile temporal processing diagram"> <p>
    
    A similar diagram is also available in 
    <A HREF = "figs/MOBIL.TMP.ps">Postscript</A>, in
    <A HREF = "figs/MOBIL.TMP.gif">GIF</A>, in
    <A HREF = "figs/MOBIL.TMP.xbm">X bitmap</A>, and in
    <A HREF = "figs/MOBIL.TMP.jpg">JPEG</A>.
    
<H3><A NAME = "TMPMOBIL_INFIL"> Input Files </A></H3>
    The program TMPMOBIL uses the following input files:<br>
        <ul>
        <li><a href= "#MOBL"> MOBL</a> (NetCDF): SMOKE inventory file from
        the <A HREF= "#RAWMOBIL"> RAWMOBIL</A> program
	<li><A HREF= "#MEFSND"> MEFSND</A>  (NetCDF): 
	Non-diurnal emission factors from <a href= "#EMISFAC"> EMISFAC</a>
	<li><A HREF= "#MEFSD"> MEFSD</A> (NetCDF): 
	Diurnal emission factors from <a href= "#EMISFAC"> EMISFAC</a>
	<li><A HREF= "#TKDAT"> TKDAT</A> (NetCDF): Gridded, hourly
	temperatures from meteorology model
	<li><A HREF= "#MUMAT"> MUMAT</A> (NetCDF): Ungridding matrix, from
        <a href= "#GRDMMAT"> GRDMMAT</a>
	<li><A HREF= "#MINMAXT"> MINMAXT</A> (NetCDF): Minimum/maximum
	temperature and index per day for each source from
        <A HREF = "#PREDIUR"> PREDIUR</A>   
	<li><A HREF= "#MPLIST"> MPLIST</A> (ASCII): Simulation-specific
	emissions factors cross- reference file
	<li><a href= "#MVMTM"> MVMTM</a> (ASCII): VMT mix data
	<li><a href= "#MTPRO"> MTPRO</a> (ASCII): EPS2.0- formatted
	temporal profile
	<li><A HREF= "#MTREF"> MTREF</a> (ASCII): EPS2.0- formatted
	temporal cross-reference
        <li> <a href= "#SPCS"> SPCS</a> (ASCII): Generalized speciation
        file

        </ul>
        

<H3><A NAME = "TMPMOBIL_INPAR"> Input Parameters </A></H3>
     Other inputs specified at run-time include the following:

    <ul>
    <li><b>Simulation time zone:</b>
          The number of hours East of Greenwich Mean Time (taking
	  daylight savings time into account  if appropriate):  Eastern
	  Standard Time is Zone 5, for example; Eastern Daylight Time is Zone 4.

    <li><b>Starting date:</b> The starting date for the simulation
         (YYYYDDD)|(YYYYMMDD). If this date is incompatible
          with the date(s) of the <A HREF="#TKDAT"> TKDAT</A> or 
          <A HREF="#MINMAXT"> MINMAXT</A> an error will result.
    <li><b>Starting time:</b> The starting time of the simulation (HHMMSS).
          If this time is incompatible
          with the time(s) of the <A HREF="#TKDAT"> TKDAT</A> or 
          <A HREF="#MINMAXT"> MINMAXT</A> an error will result.
       <br>
    <li><b>Duration:</b> The number of hours that output
          data will be created.  If the duration is incompatible
          with the duration(s) of the <A HREF="#TKDAT"> TKDAT</A> or
          <A HREF="#MINMAXT"> MINMAXT</A> an error will result.
    </ul>

<H3><A NAME = "TMPMOBIL_INENV"> Input Environment Variables </A></H3>
     <ul>
     <li><b>ZONE4WM</b>: The variable has two settings:
         <ul>
         <li><b>Y</b>: (Default) Consider the time zone of  each source when
         applying weekly and monthly temporal profiles.  This approach is a more
         accurate use of temporal profiles.<p>
         
	 The practical implication of this is that Sunday June 1st
	 starts _not_ at the output time zone's "Sunday" and "June", but at
	 each source's "Sunday" and "June".  For example, setting this variable
	 to 'N' means that the start of North Carolina's Sunday  is the same as
	 the start of England's Sunday, if we were processing in GMT.  With
	 this variable set to 'Y', England and NC start their respective
	 Sundays and Junes 5 hours (or 4 hours during daylight savings) apart. 
	 In addition, Missouri (in the central time zone) starts it's Sunday
	 one hour after that in North Carolina.<p>

         <li><b>N</b>: Do not consider the time zone of each source when
         applying weekly and monthly temporal profiles. Code performance is
         greater using this setting, but emissions can be less accurate,
         therefore, this setting should be
         used only in very specific circumstances:
             <ul> 
             <li> When there are multiple time zones in the inventory, but the
                  user knows that the output grid only contains one time zone
                  <b> AND</b> the output time zone input to this program
                  is the same as the time zone as is spanned by the gridded 
                  region. 
             
             <li> When SMOKE output from a simulation with multiple time zones
                  is being compared to EMS-95 or to EPS.
             </ul> 
         </ul>
     <li><b>LOGFILE</b>: If this environment variable is defined as a valid
     physical file name, the program's
     errors, warnings, notes, and other information will be recorded in this
     file. Otherwise, that information will be written to standard output.<p>
     </ul>
     
<H3><A NAME = "TMPMOBIL_OUTFIL"> Output Files </A></H3>
        <ul>
        
	<li><A HREF= "#MTMP"> MTMP</a> (NetCDF): Hourly emission type
	emissions, used by <a href= "MERGE.html#CSGMERGE"> CSGMERGE</a>, and/or <a
	href= "MERGE.html#CSGLMERGE"> CSGLMERGE</a>, and/or <a href=
	"MERGE.html#CSGLDAYMRG"> CSGLDAYMRG</a>, and optionally by <em> <a
	href="QA.html#CSGMOBIL"> CSGMOBIL</a> </em> and/or <em> <a
	href="QA.html#GRDMOBIL"> GRDMOBIL</a></em>
	
        </ul>
        
<H3><A NAME = "TMPMOBIL_INCL"> Include file parameters </A></H3>

The following include files are used by TMPMOBIL.  In this section, we
highlight included parameters that users may need to modify to suit their
particular simulation needs for this program, and these are listed in
alphabetical order for each include file. The include filess are listed in the
order that they appear in the source code. Refer to the section on <a href=
"INCLUDES.html"> include files</a> for specific details about the parameters.

    <UL>
    <li><a href= "INCLUDES.html#mbdims"> MBDIMS3.EXT</a>: mobile-source dimensioning parameters
        <UL>  
        <li><b>MAXTMP</b>: Maximum number of temperatures for non-diurnal emissions
        <li><b>MXDET</b>: Maximum number of diurnal emission types
        <li><b>MXEPRC</b>: Maximum number of MC emissions processes
        <li><b>MXNDET</b>: Maximum number of non-diurnal emission types
        <li><b>MXPLST</b>: Maximum number of MPLIST cross-reference entries
        <li><b>MXPPS</b>: Maximum number of PSIs per source
        <li><b>MXPSI</b>: Maximum total number of PSIs
        <li><b>MXTMMI</b>: Maximum number of minimum and maximum temperature 

        <li><b>MXPSI</b>: Maximum total number of PSIs
        <li><b>NMINMAX</b>: 
        <LI><b>NMSRC</b>: Number of mobile sources
        <li><b>NRCLAS</b>: Number of road classes
        <li><b>NVTYPE</b>: Number of vehicle types
        </UL>
    <li><a href= "INCLUDES.html#chdgen"> CHDGEN.EXT</a>: generalizes speciation parameters
        <UL>  
        <li><b>MXIPOL</b>: Maximum number of inventory pollutants
        </UL>
        
    <li><a href= "INCLUDES.html#grdims"> GRDIMS3.EXT</a>: grid parameters
        <UL> 
        <LI> <b>NGRID</b>: the number of cells in the grid
        <LI> <b>NMATX</b>: the number of gridding coefficients.
        </UL>
        
    <li><a href= "INCLUDES.html#tmdims"> TMDIMS3.EXT</a>: Temporal allocation
    dimensioning parameters    
        <ul>
        <li><b>DAYS:</b> Array containing the names of weekdays, but Monday is
        first day (as per EPS2.0 style of processing).
        </ul>
    <li><a href= "INCLUDES.html#parms3"> PARMS3.EXT</a>:  I/O API parameters
    <li><a href= "INCLUDES.html#iodecl3"> IODECL3.EXT</a>: I/O API function declarations
    <li><a href= "INCLUDES.html#fdesc3"> FDESC3.EXT</a>:  I/O API file description data structures.
    <li><a href= "INCLUDES.html#const3"> CONST3.EXT</a>:  Physical and
         mathematical constants.
    </UL>
    <p>
        
    In case the dimensioning for the matrix or for internal work arrays is
    insufficient, TMPMOBIL will recognize and report the fact to the  program
    log; in that case, the user needs to increase the dimensioning by changing
    the appropriate PARAMETER statements and re-compile the relevant parts of
    SMOKE.  <P>
    
<H3><A NAME = "TMPMOBIL_UPCOM"> Upcoming Features </A></H3>
    <ul> 
    <li> Update minimum/maximum temperature storage to use only valid min/max
    temperature combinations.  This will decrease memory requirements.<p>
    </ul>  
<H3><A NAME = "TMPMOBIL_BUGS"> Known Bugs </A></H3>
    <ul>
    <li>Time zone not taken into consideration when weekly and monthly temporal
    profiles are applied
    </ul>

<H3><A NAME = "TMPMOBIL_USAGE"> Usage</A></H3>
 
<PRE>
#  setenvs for logical file names:
#
setenv MEFSD    &lt;path-name for diurnal emissions factors file&gt;
setenv MEFSND   &lt;path-name for non-diurnal emissions factors file&gt;
setenv MINMAXT  &lt;path-name for ungridded min/max temperature file&gt;
setenv MOBL     &lt;path-name for SMOKE mobile source annual inventory file&gt;
setenv MPLIST   &lt;path-name for emissions simulation-specific x-ref list&gt;
setenv MTMP     &lt;path-name for mobile source time stepped emissions file&gt;
setenv MTPRO    &lt;path-name for mobile source temporal profile file&gt;
setenv MTREF    &lt;path-name for mobile source temporal cross reference file&gt;
setenv MUMAT    &lt;path-name for mobile source ungridding matrix file&gt;
setenv MVMTM    &lt;path-name for mobile source VMT mix profiles file&gt;
setenv SPCS     &lt;path-name for speciation list file&gt;
setenv TKDAT    &lt;path-name for surface temperature file&gt;
#
#  Now run the program, using a here-document for input:
#
spcpmat  &lt;&lt; EOF
Yes, continue with the program
MOBL                    !  mobile source annual inventory file
MEFSND                  !  non-diurnal emissions factor file
MEFSD                   !  diurnal emissions factor file
TKDAT                   !  surface temperature file
MUMAT                   !  ungridding matrix file
MINMAXT                 !  ungridded min/max temperature file
MVMTM                   !  mobile source VMT mix profiles file
MPLIST                  !  emissions simulation-specific x-ref list
MTREF                   !  temporal cross reference file
MTPRO                   !  temporal profile file
SPCS                    !  speciation list file
5                       !  time zone for output file
1988200                 !  starting date, YYYYDDD or YYYYMMDD
000000                  !  starting time, HHMMSS
121                     !  output duration (hours)
MTMP                    !  time stepped mobile source emissions file
EOF
#
#  done
#
</PRE>
 
<HR>

<H2> <A NAME = "dataset"> Mobile Source Data Set Definitions </A> </H2>

For information on the terms that are used in this section, please refer to the
<a href= "ABOUT.html#FileTerms"> Terms for file definitions</a>  part of the <a
href= "ABOUT.html"> About SMOKE Documentation</a> Section.<p>

    <UL>
        <li> <a href="#LNKDEF"><b>LNKDEF:</b></a> Link
             definition file (ASCII)

        <LI>  <A HREF = "#MCMAT"> <b>MCMAT: </b></A>
              Mobile source control/projection matrix (NetDCF)

        <li> <A HREF = "#MEFSD"> <b>MEFSD: </b></A>
              Diurnal emission factors (NetCDF)

        <LI>  <A HREF = "#MEFSND"> <b>MEFSND: </b></A>
              Non-diurnal emission factors (NetCDF)
              
        <LI>  <A HREF = "#MEFTEMP"> <b>MEFTEMP: </b></A>
              Minimum/maximum temperature indices for
              each emission factor (ASCII)

        <li>  <a href="#MEFUPD"><b>MEFUPD:</b></a>  List of PSIs to update in
              existing emission factor files (ASCII)

        <LI>  <A HREF = "#MGMAT"> <b>MGMAT: </b></A>
              Mobile source gridding matrix (NetCDF)

        <LI>  <A HREF = "#MGPRO"> <b>MGPRO: </b></A> Gridding surrogates (ASCII)

        <LI>  <A HREF = "#MGREF"> <b>MGREF: </b></A> Gridding surrogate cross- 
              reference file (ASCII)

        <LI>  <A HREF = "#MINMAXT"> <b>MINMAXT: </b></A>
              Minimum and maximum temperature and index per day for each source
              (NetCDF)

        <li>  <a href= "#MLKLST"> <b>MLKLST:</b></a> List of link source VMT
        input files (includes format for link input files) (ASCII)

        <li>  <a href= "#MNLST"> <b>MNLST:</b></a> List of non-link source VMT
        input files (includes format for non-link input files) (ASCII)

        <LI>  <A HREF = "#MOBL"> <b>MOBL: </b></A>
              SMOKE inventory file (NetCDF)

        <LI>  <A HREF = "#MPLIST"> <b>MPLIST: </b></A>
             Simulation- specific emissions factors cross- reference file
             (ASCII)

        <LI>  <A HREF = "#MPREF"> <b>MPREF: </b></A>
              MOBILE5 parameters cross- reference (defines PSIs) (ASCII)

        <li>  <A HREF = "#MSCNV"> <b>MSCNV:</b></a> Volatile conversion factors
        (e.g., VOC to TOG) (ASCII) 

        <LI>  <A HREF = "#MSMAT"> <b>MSMAT: </b></A>
              Mobile source speciation matrix  (NetCDF)

        <LI>  <A HREF = "#MSPRO"> <b>MSPRO: </b></A>
              Speciation profiles (ASCII)

        <LI>  <A HREF = "#MSREF"> <b>MSREF: </b></A>
              Speciation cross-reference (ASCII)

        <LI>  <A HREF = "#MTMP"> <b>MTMP: </b></A>
              Mobile source hourly emission-type emissions (NetCDF)

        <LI>  <A HREF = "#MTPRO"> <b>MTPRO: </b></A>
              Temporal profiles (ASCII)

        <LI>  <A HREF = "#MTREF"> <b>MTREF: </b></A>
              Temporal cross- reference (ASCII)

        <LI>  <A HREF = "#MUMAT"> <b>MUMAT: </b></A>
              Mobile source ungridding matrix (NetCDF)

        <LI>  <A HREF = "#MVMTM"> <b>MVMTM: </b></A>
              VMT mix data (ASCII)

        <li>  <A HREF = "#SPCS"> <b>SPCS:</b></a> Generalized speciation file 
        (to control emissions processes, inventory pollutants, and model 
        species) (ASCII)

        <li>  <A HREF = "#TKDAT"> <b>TKDAT:</b> </a> Gridded, hourly
        temperatures from meteorology model (NetCDF)

        <LI>  Optional EMISFAC profile files
        <UL>

            <LI>  <A HREF = "#MACUM"> <b>MACUM: </b></A>
                  Mileage accumulation rates profiles file (ASCII)

            <LI>  <A HREF = "#MAVSPD"> <b>MAVSPD: </b></A>
                  Average speeds profiles file (ASCII)

            <LI>  <A HREF = "#MBSEXH"> <b>MBSEXH: </b></A>
                  Basic exhaust emissions rates profiles file (ASCII)

            <LI>  <A HREF = "#MCTOFF"> <b>MCTOFF: </b></A>
                  cutoffs point records for I/M 240  (ASCII): 

            <LI>  <A HREF = "#MDLSF"> <b>MDLSF: </b></A>
                  Diesel fuels sales fractions profiles file (ASCII)

            <LI>  <A HREF = "#MEFATP"> <b>MEFATP: </b></A>
                  Anti-tampering programs effects profiles file (ASCII)

            <LI>  <A HREF = "#MEFIM"> <b>MEFIM: </b></A>
                  Inspection and maintanence programs effects profiles file
                  (ASCII)

            <LI>  <A HREF = "#MEFLEV"> <b>MEFLEV: </b></A>
                  LEV program effects profiles file (ASCII)

            <LI>  <A HREF = "#MEFRFL"> <b>MEFRFL: </b></A>
                  Refueling controls parameters profiles file (ASCII)

            <LI>  <A HREF = "#MLAPMO"> <b>MLAPMO: </b></A>
                  LAP/ month profiles file (ASCII)

            <LI>  <A HREF = "#MLOAD"> <b>MLOAD: </b></A>
                  A/C usages, extra loading, trailer, humidity effects
                  profiles file

            <LI>  <A HREF = "#MNEVAP"> <b>MNEVAP: </b></A>
                  New evaporative emissions tests profiles file  (ASCII)

            <LI>  <A HREF = "#MOPMOD"> <b>MOPMOD: </b></A>
                  Operating modes profiles file  (ASCII)

            <LI>  <A HREF = "#MOXYF"> <b>MOXYF: </b></A>
                  Oxygenated fuels parameters profiles file (ASCII)

            <LI>  <A HREF = "#MPREST"> <b>MPREST: </b></A>
                  Functional pressure test profiles file 9ASCII)

            <LI>  <A HREF = "#MPURGT"> <b>MPURGT: </b></A>
                  Functional purge test profiles file (ASCII)

            <LI>  <A HREF = "#MRGDS"> <b>MRGDS: </b></A>
                  Registration distributions profiles file (ASCII)

            <LI>  <A HREF = "#MTLEN"> <b>MTLEN: </b></A>
                  Trip length distribution profiles file (ASCII)

            <LI>  <A HREF = "#MTRATE"> <b>MTRATE: </b></A>
                  Tampering rates profiles file (ASCII)
        </UL>
    </UL>
    <P> 

<HR> 

<H2> <a name="LNKDEF"> LNKDEF File
</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Link definition file<p>
    <b>Sequence:</b>    Optional Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b> <a href= "#GRDMMAT"> GRDMMAT</a> program<p>
    <b>Summary:</b>     
    
      This file is used to allocate non-link mobile sources to grid cells based
      on the links in a given county.  This file must contain all links for a
      county and road class if it contains any links for that county and road
      class.  <p>

<H3>File Format(s)</H3>
    <b>Same As:</b> EPS2.0 file, see page B-47 of EPS2.0 manual<p>

    <b>Structure:</b> Column-specific
<DL><DT> &nbsp;<DD>
<table align=center>
   <tr> <th>Line <th> Columns  <th align=left> Description
   <tr> <td>1+ <td> 1-5      <td> FIPS state and county code
   <tr> <td> &nbsp; <td> 6-10     <td> <a href= "#RoadClasses"> AIRS AMS road 
                                     type code</a>
   <tr> <td>  &nbsp; <td> 11-20   
        <td> UTM Easting coordinate of beginning of link
   <tr> <td> &nbsp; <td> 21-30   
        <td> UTM Northing coordinate of beginning of link
   <tr> <td> &nbsp; <td> 31-40   
        <td> UTM Easting coordinate of end of link
   <tr> <td> &nbsp; <td> 41-50   
        <td> UTM Northing coordinate of end of link
   <tr> <td> &nbsp; <td> 51-60    <td>UTM zone 
</table>
</DL>


<HR> 

<P>
<H2> <a name="MCMAT">MCMAT File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Mobile source control/projection matrix<p>
    <b>Sequence:</b>    Optional intermediate<p>
    <b>Type:</b>        NetCDF<p>
    <b>Origin:</b>      CTLMMAT program<p>
    <b>Used by:</b> <a href= "MERGE.html#CSGMERGE"> CSGMERGE</a>,
                    <a href= "MERGE.html#CSGLMERGE"> CSGLMERGE</a>, or
                    <a href= "MERGE.html#CSGLDAYMRG"> CSGLDAYMR</a>
                    programs<p>
    <b>Summary:</b>     
     This file does not yet exist because the program that will create it, 
     CTLMMAT, does not yet exist.<p>

<H3>File Format(s)</H3>
    <b>Structure:</b> Degenerate GRIDDED3<p>

<HR> 

<P>
<H2> <a name="MEFSD"> File MEFSD</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Diurnal emission factors <p>
    <b>Sequence:</b>    Intermediate<p>
    <b>Type:</b>        NetCDF<p>
    <b>Origin:</b>      <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Used by:</b> <a href= "#TMPMOBIL"> TMPMOBIL</a> program<p>
    <b>Summary:</b>    The MEFSD file contains the diurnal emission factors
    from MOBILE5a or MOBILE5b. These emission factors are used to convert VMT
    to emissions. Each variable in the file cooresponds to a type of emission
    factor, and contains emission factors from many different PSIs and for many
    different minimum/maximum temperature combinations.  Because EMISFAC only
    creates the diurnal emission factors for the minimum/maximum temperature
    combinations that have been encountered in a given meteorological episode,
    the variables often contain many missing records to hold a place for these.  
    <P>
    
    Even if all of the emission types are not used in a given invocation of
    SMOKE, all of the diurnal emission factors that SMOKE can use are
    stored in this file.  This permits the user to change the emission factors
    being used (but not the volatile pollutant type), without having to rerun
    EMISFAC. Actually, EMISFAC even stores one emission factor that SMOKE can't
    use: the weighted diurnal emission factor.  SMOKE can't use this because
    it's units are in grams instead of grams/mile, but it is stored for future
    version of SMOKE that may be able to use this factor.
   
    <H3>File Format(s)</H3>
    <b>Structure:</b> Degenerate GRIDDED3<p>
    <b>Header:</b>
    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <th> Header variable
                        <th align=left> Meaning
                        <th align=left> Set by...
        </tr>
        <tr valign=top> <td> SDATE 
             <td> The YYYY portion of the Julian starting date indicates the date 
             for which the emission
             factors have been created.  Only one year is permitted per file.
             <td>User at run time
        </tr>
        <tr valign=top> <td> TSTEP
             <td> The time step is set to 1 second.  Each PSI is stored in a
             different "time step" of the file.  For example, PSI 10 is stored
             in the tenth second, or at HHMMSS 000010; PSI 200 is stored in
             the 200th second, or at HHMMSS 000320 (three minutes, 20 seconds).
             Because of this file storage method, and because NetCDF writes
             missing values for time steps that are not present in the file, 
             the lower the PSI numbers are, the smaller the file will be.
             <td> Default
        </tr>
        <tr valign=top> <td> NCOLS
             <td> The number of columns stores the length of the
             minimum/maximum temperature combinations array.
             <td> Parameter NMINMAX in MBDIMS3.EXT
        </tr>
        <tr valign=top> <td> NROWS
             <td> The number of rows stores the number of vehicle types, as
             emission factors for each vehicle type need to be stored
             individually.
             <td> Parameter NVTYPE in MBDIMS3.EXT 
        </tr>
        <tr valign=top> <td> XORIG
             <td> The X-origin field stores the negative of the starting
             lowest minimum temperature used.
             <td> Parameter MINT_MIN in MBDIMS3.EXT
        </tr>
        <tr valign=top> <td> XCELL
             <td> The x-direction cell size field stores the temperature
             interval
             <td> Parameter TINTV in MBDIMS3.EXT
        </tr>
    </table>
    </DL>
    
    <b>Variables:</b>
    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <th> Variable
                        <th> Type
                        <th> Units
                        <th align=left> Description
        </tr>
        <tr valign=top> <td> WDL_THC or WDL_NMH or WDL_VOC or WDL_TOG or WDL_NMO
             <td> Float
             <td> grams
             <td> Weighted diurnal emission factor
        </tr>
        <tr valign=top> <td> DNL_THC or DNL_NMH or DNL_VOC or DNL_TOG or DNL_NMO
             <td> Float 
             <td> grams/mile
             <td> Diurnal emission factor
        </tr>
        <tr valign=top> <td> HOT_THC or HOT_NMH or HOT_VOC or HOT_TOG or HOT_NMO
             <td> Float 
             <td> grams/mile
             <td> Hot soak diurnal emission factor
        </tr>
        <tr valign=top> <td> CRC_THC or CRC_NMH or CRC_VOC or CRC_TOG or CRC_NMO
             <td> Float 
             <td> grams/mile
             <td> Crank case diurnal emission factor
        </tr>
    </table>
    </DL>

<HR> 

<P>
<H2> <a name="MEFSND">MEFSND File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Non-diurnal emission factors<p>
    <b>Sequence:</b>    Intermediate<p>
    <b>Type:</b>        NetCDF<p>
    <b>Origin:</b>      <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Used by:</b> <a href= "#TMPMOBIL"> TMPMOBIL</a> program <p>
    <b>Summary:</b>    The MEFSND file contains the non-diurnal emission
    factors from MOBILE5a or MOBILE5b. These emission factors are used to
    convert VMT to emissions. Each variable in the file cooresponds to a type
    of emission factor, and contains emission factors from many different PSIs
    and for many different temperatures.  EMISFAC creates emission factors for
    all temperature using a run-time defined range, and compile-time defined
    temperature increment.  See the EMISFAC documentation for more information. 
    <p> 
    
    Even if all of the emission types are not used in a given invocation of
    SMOKE, all of the non-diurnal emission factors that SMOKE can use are
    stored in this file.  This permits the user to change the emission factors
    being used (but not the volatile pollutant type), without having to rerun
    EMISFAC.

<H3>File Format(s)</H3>
    <b>Structure:</b> Degenerate GRIDDED3<p>

    <b>Header:</b>
    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <th> Header variable
                        <th align=left> Meaning
                        <th align=left> Set by...
        </tr>
        <tr valign=top> <td> SDATE 
             <td> The YYYY portion of the Julian starting date indicates the date 
             for which the emission
             factors have been created.  Only one year is permitted per file.
             <td>User at run time
        </tr>
        <tr valign=top> <td> TSTEP
             <td> The time step is set to 1 second.  Each PSI is stored in a
             different "time step" of the file.  For example, PSI 10 is stored
             in the tenth second, or at HHMMSS 000010; PSI 200 is stored in
             the 200th second, or at HHMMSS 000320 (three minutes, 20 seconds).
             Because of this file storage method, and because NetCDF writes
             missing values for time steps that are not present in the file, 
             the lower the PSI numbers are, the smaller the file will be.
             <td> Default
        </tr>
        <tr valign=top> <td> NCOLS
             <td> The number of columns stores the maximum length of the
             temperature array.
             <td> Parameter MAXTMP in MBDIMS3.EXT
        </tr>
        <tr valign=top> <td> NROWS
             <td> The number of rows stores the number of vehicle types, as
             emission factors for each vehicle type need to be stored
             individually.
             <td> Parameter NVTYPE in MBDIMS3.EXT 
        </tr>
        <tr valign=top> <td> XORIG
             <td> The X-origin field stores the negative of the lowest run-time
              temperature used.
             <td> User at run time
        </tr>
        <tr valign=top> <td> XCELL
             <td> The x-direction cell size field stores the temperature
             interval
             <td> Parameter TINTV in MBDIMS3.EXT
        </tr>
    </table>
    </DL>
    
    <b>Variables:</b>
    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <th> Variable
                        <th> Type
                        <th> Units
                        <th align=left> Description
        </tr>
        <tr valign=top> <td> EXH_CO
             <td> Float
             <td> grams/mile
             <td> Exhaust CO emission factor
        </tr>
        <tr valign=top> <td> EXH_NOX
             <td> Float
             <td> grams/mile
             <td> Exhaust NOX emission factor
        </tr>
        <tr valign=top> <td> EXH_THC or EXH_NMH or EXH_VOC or EXH_TOG or EXH_NMO'
             <td> Float
             <td> grams/mile
             <td> Exhaust volatile pollutant emission factor
        </tr>
        <tr valign=top> <td> EVP_THC or EVP_NMH or EVP_VOC or EVP_TOG or EVP_NMO
             <td> Float 
             <td> grams/mile
             <td> Non-diurnal evaporative emission factor
        </tr>
        <tr valign=top> <td> RNL_THC or RNL_NMH or RNL_VOC or RNL_TOG or RNL_NMO
             <td> Float 
             <td> grams/mile
             <td> Running loss evaporative emission factor
        </tr>
        <tr valign=top> <td> RST_THC or RST_NMH or RST_VOC or RST_TOG or RST_NMO
             <td> Float 
             <td> grams/mile
             <td> Resting loss evaporative emission factor
        </tr>
        <tr valign=top> <td> RFL_THC or RFL_NMH or RFL_VOC or RFL_TOG or RFL_NMO
             <td> Float 
             <td> grams/mile
             <td> Refueling loss evaporative emission factor
        </tr>
    </table>
    </DL>
<P>

<HR> 

<H2> <a name="MEFTEMP"> MEFTEMP File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Minimum/maximum temperature indices for each emission factor<p>
    <b>Sequence:</b>    Intermediate<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      <a href= "#PREDIUR"> PREDIUR</a> program<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>

    <b>Summary:</b>  MEFTEMP  contains all minimum/maximum temperature indices
    TMMI  (see <A HREF="#MINMAXT"> MINMAXT</A> for more information on TMMI
    codes) for a given temperature input file <A HREF="#TKDAT"> TKDAT</A> and a
    given scenario- specific  set of emission factors from <A HREF="#MPLIST">
    MPLIST</A>. <P>

<H3>File Format(s)</H3>
    <b>Structure:</b> List- formatted<p>
    <DL><DT> &nbsp; <DD>
    <table>
       <tr><th> Line <th>Columns <th align=left>Description
       <tr><td align=center> 1+
            <td align=center>A 
            <td> PSI code
       </tr>
       <tr><td align=center> &nbsp;
            <td align=center>B
            <td> Number of TMMI codes for this PSI
       </tr>
       <tr><td align=center> &nbsp;
            <td align=center>C(1) ... C(N)
            <td> TMMI(1) ... TMMI(N)
      </tr>
    </table>

    <P> <b>NOTE:</b> Entries with more than 20 TMMI codes are continued on a new
    line.

    </DL>

<HR> 

   
<H2> <a name="MEFUPD"> MEFUPD File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> List of PSIs to update in existing emission factor files<p>
    <b>Sequence:</b>    Optional Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    
    <b>Summary:</b>     The MEFUPD file is used to control the EMISFAC program.
    When the user needs emission factors for specific PSIs to be updating in a
    MEFSD or MESFND file that already exists, and the default behavior of
    EMISFAC will not update those PSIs, this file can be used to instruct
    EMISFAC to update those PSIs.  This updating feature is most useful for
    correcting PSIs when they were inadvertently created with incorrect MOBILE5
    inputs.<p>

<H3> File Format(s)</H3>

    <b>Structure:</b> List- formatted<p>
    
    <DL><DT> &nbsp; <DD>
    <table>
        <tr><th> Line <th> Columns <th align=left> Description
        <tr><td align=center> 1+ <td align=center> A 
        
	     <td> Starting and ending PSI separated by a dash, or single PSI
	     value
        </tr>
    </table>
    </DL>
    
    <b>Example:</b><p>
    
    <PRE> 
    051-055
    063
    067-075          
    </PRE>
    

<HR> 

   
<H2> <a name="MGMAT"> MGMAT File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Mobile source gridding matrix<p>
    <b>Sequence:</b>    Intermediate<p>
    <b>Type:</b>        IO/API NetCDF<p>
    <b>Origin:</b>      <a href= "#GRDMMAT"> GRDMMAT</a> program<p>
    <b>Used by:</b> <a href= "QA.html#GRDMOBIL"> GRDMOBIL</a>,
                    <a href= "QA.html#CSGMOBIL"> CSGMOBIL</a>,
                    <a href= "MERGE.html#CSGMERGE"> CSGMERGE</a>,
                    <a href= "MERGE.html#CSGLMERGE"> CSGLMERGE</a>, or
                    <a href= "MERGE.html#CSGLDAYMRG"> CSGLDAYMRG</a>
                    programs.<p>
                    
    <b>Summary:</b> The MGMAT gridding matrix is used to transform source- based
    emissions to grid cell- based emissions.  The rows of the matrix correspond
    to the mobile sources (with the rows sorted in the same order as the sources
    in the <a href= "#MOBL"> MOBL</a> file.  The columns of the matrix
    correspond to the grid cells, and because each source intersects only a few
    grid cell, this matrix is very sparse (has a lot of zeroes).  Where a grid
    cell and source do intersect, the gridding factor is stored in this matrix,
    along with it's position in the matrix , but the zero values are not stored
    (this is called sparse storage).<p>
    
<H3>File Format(s)</H3>
    <b>Structure:</b> Time-independent SMATRX3<p>

    The number of sparse-matrix coefficients, NCOLS3D, is NMATX, and the number
    of matrix rows NROWS3D is NGRID.  Both are defined in  <A HREF =
    "INCLUDES.html#grdims"> GRDIMS3.EXT </A>; MGMAT has one application-supplied
    variable, the sparse matrix  coefficient table, in addition to the sparse
    matrix indexing  data structures:
    
        <UL>
        
	<LI>  INTEGER <b>NX( NGRID )</b> -- sparse matrix indexing array for the
	number of active coefficients per row;

        <LI>  INTEGER <b>IX( NMATX )</b> -- sparse matrix indexing
              array listing the set of active columns for all the rows;
              and

        <LI>  REAL <b>MGRDMAT( NMATX )</b> -- the array of
              active coefficients in the sparse matrix structure.

    </UL>    
    <P> 
<HR> 
   
<H2> <a name="MGPRO">MGPRO File </a></H2>

<H3> Overview</H3>
    <b>Description:</b> Gridding surrogates<p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b> <a href= "#GRDMMAT"> GRDMMAT</a> program<p>
    <b>Summary:</b>    

    MGPRO is used by program <A HREF = "#GRDMMAT">
    GRDMMAT</A>  to construct the <A HREF = "#MGMAT"> MGMAT</A> 
    and <A HREF = "#MUMAT"> MUMAT</A> gridding and ungridding 
    matrix files.  If the EMS95- formatted surrogates are available, the SAS
    program  <A HREF="mvgrd2smoke.sas"> mvgrd2smoke.sas</A> can be run
    in the EMS-95 system in order to reformat the grdtiger.mv file
    to a format close to that expected by SMOKE (doesn't have the header).
     
<H3>File Format(s)</H3>
    <b>Same as:</b> EPS2.0 format (with exceptions)<p>
    <b>Structure:</b> Column-specific based on columns, below. All lines after
    line 1 must be in sorted order by FIPS code and cell coordinates. <p>
    <DL><DT> &nbsp; <DD>
    <table>
        <tr><th> Line <th>Columns  <th align=left> Description
        <tr><td align=center> 1
            <td align=center> 1-10
            <td> Minimum East-West coordinate in units of output grid
            projection
        <tr><td align=center>  &nbsp; 
            <td align=center> 11-20
            <td> Minimum North-South coordinate in units of output grid 
            projection        
        <tr><td align=center>  &nbsp; 
            <td align=center> 21-30
            <td> Maximum East-West coordinate in units of output grid
            projection 
        <tr><td align=center>  &nbsp; 
            <td align=center> 31-40
            <td> Maximum North-South coordinate in units of output grid
            preojection
        <tr><td align=center>  &nbsp; 
            <td align=center> 41-50
            <td> Number of surrogates in file (<b>NOTE:</b> Not UTM zone as in
            EPS file format)   
        <tr><td align=center>  &nbsp; 
            <td align=center> 51-60
            <td> East-West cell size in units of output grid projection
        <tr><td align=center>  &nbsp; 
            <td align=center> 61-70
            <td> North-South cell size in units of output grid projection    
        <tr><td align=center> 2+
            <td align=center> 1-5
            <td> State and County FIPS code
        <tr><td align=center> &nbsp; 
            <td align=center> 6-15
            <td> Minimum East-West coordinate of lower left corner of grid cell
            <b> OR </b> grid column number
        <tr><td align=center>  &nbsp; 
            <td align=center> 16-25
            <td> Minimum North-South coordinate of lower left corner of grid
            cell <b> OR </b> grid row number            
        <tr><td align=center> &nbsp; 
            <td align=center> 26-35
            <td> UTM zone or blank for non-UTM grid projections            
        <tr><td align=center> &nbsp; 
            <td align=center> 36-
            <td> Fraction of county totals in cell for each of the surrogates
                 (Each surrogate fraction must occupy a 10 column field)
    </table>
    </DL>
    <p>

    <b>Example:</b><p>
 
<PRE>
   -972.D3  -1728.D3   1620.D3    936.D3        11    36000.    36000.
 1001    252000   -828000         0 0.0000000 0.0000000 0.0077926 0.0016623 0.0012996 0.0011825 0.0000000 0.0016629 0.0000000 0.1463758 0.0013908
 1001    288000   -864000         0 0.0635372 0.0000000 0.0103893 0.0017510 0.0022372 0.0022052 0.0000000 0.0016154 0.0000000 0.0000000 0.0631801
 1001    288000   -828000         0 0.5311099 0.0000000 0.7112701 0.2372464 0.9927374 0.9929678 0.4102161 0.2331764 0.0000000 0.3262857 0.6938299
 1001    288000   -792000         0 0.0000000 0.0000000 0.0452168 0.0203222 0.0001610 0.0001586 0.0233939 0.0194722 0.0000000 0.0000000 0.0010293
 1001    324000   -864000         0 0.0000000 0.0000000 0.0001107 0.0000288 0.0034724 0.0034010 0.0000000 0.0000271 0.0000000 0.0000000 0.0037152
 1001    324000   -828000         0 0.4053530 0.0000000 0.2004726 0.7214998 0.0000662 0.0000624 0.5043095 0.7252333 0.0000000 0.3031706 0.2368549
 1001    324000   -792000         0 0.0000000 0.0000000 0.0247483 0.0174897 0.0000263 0.0000225 0.0620804 0.0188129 0.0000000 0.2241678 0.0000000
 1003    180000  -1080000         0 0.0790109 0.0000000 0.1392975 0.1072884 0.0033616 0.0072119 0.0188128 0.0638861 0.0000000 0.0000000 0.5160297
</PRE>
    <P> 

<HR> 

<H2> <a name="MGREF"> MGREF File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Gridding surrogate cross- reference<p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b> <a href= "#GRDMMAT"> GRDMMAT</a> program<p>

    <b>Summary:</b> The MGREF file is used to match mobile sources with the
    gridding surrogates that the sources are to use for the gridding step.  For
    example, this file could indicate that all interstate sources should be
    gridded based on the major highways surrogate, and that all rural roads
    should be gridded based on the rural surrogate.  The source attributes of
    state and county FIPS code and road class code are used to match the sources
    to the gridding surrogates.  The file can indicate defaults by using zeroes
    instead of valid FIPS codes or road class codes.<p>

<H3>File Format(s)</H3>
    <b>Structure:</b> List- formatted <p> 
    <DL><DT> &nbsp; <DD>
    <table>
        <tr><th> Line <th>Columns <th align=left> Description
        <tr><td> 1+ <td> A <td> State and county FIPS code
        <tr><td> &nbsp;   <td> B <td> Surrogate ID code 
        <tr><td> &nbsp;   <td> C <td> <a href="#RoadClasses"> AIRS AMS road type code </a>
    </table>
    </DL>
    <p>
    
    <b>Example:</b><p>

    <DL><DT> &nbsp; <DD>
    Note: In this example, comments are placed after column C.  These comments
    are not used by the SMOKE system.
    </DL>
     
    <PRE>
    00000   7 110   RURAL INTERSTATE 
    00000   8 130   RURAL PRIN ART 
    00000   8 150   RURAL MINOR ART
    00000   8 170   RURAL MAJOR COL 
    00000   8 190   RURAL MINOR COL
    00000   8 210   RURAL LOCAL
    00000   7 230   URBAN INTERSTATE
    00000   8 250   URBAN FREEWAY 
    00000   8 270   URBAN PRIN ART
    00000   8 290   URBAN MINOR ART 
    00000   8 310   URBAN COLLECTOR
    00000   8 330   URBAN LOCAL 
    </PRE>

<HR> 

<H2> <a name="MINMAXT"> MINMAXT File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Minimum and maximum temperature and index per 
       day for each source<p>
    <b>Sequence:</b>    Intermediate<p>
    <b>Type:</b>        NetCDF<p>
    <b>Origin:</b>      <a href= "#PREDIUR"> PREDIUR</a> program<p>
    <b>Used by:</b>     <a href= "#TMPMOBIL"> TMPMOBIL</a> program<p>

    <b>Summary:</b> The file MINMAXT contains the mimimum and maximum 
    temperatures for each source for each day.  Since it depends on the
    meteorology data, this file must be created for every episode and grid.
    <p>
    
    The TMMI code is a concept used in generating this file that requires
    additional explanation. Each combination of minimum and maximum temperatures
    is assigned a TMMI index.  The value of the index is obtained by sorting all
    temperature combinations with maximum temperature cycling fastest.   All
    combinations are retained in this sorted order, including combinations that
    do not make sense (such as  min=60 and max=50), and the index to each of
    these combinations is set to its placement in the sorted list. If the actual
    min/max for the source violates any of the constraints of MOBILE5 (such as
    max - min &gt 40 degrees F) or if the minimum and/or maximum is  outside the
    compile-time range specified in <A HREF= "INCLUDES.html#mbdims">
    MBDIMS3.EXT</A>, <A HREF="#PREDIUR"> PREDIUR</A> gives a warning is written
    to standard I/O and the nearest valid index number is assigned. These index
    codes are also used to summarize the min/max temperature combinations needed
    for each PSI (see <A HREF="#MPREF"> MPREF</A>), and this information is
    stored in the  <A HREF="#MEFTEMP"> MEFTEMP</A> file. <P>

<H3>File Format(s)</H3>
    <b>Structure:</b> Degenerate, time-dependent, GRIDDED3<p>

    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <th> Header variable
                        <th align=left> Meaning
                        <th align=left> Set by...
        <tr valign=top> <td> NROWS3D
            <td> The number of rows is the number of mobile sources
            <td> Parameter NMSRC in <a href= "INCLUDES.html#mbdims">
            MBDIMS3.EXT</a>
    </table>
    </DL>
    <p>
    
   <b>Variables:</b> <p>
    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <th> Variable
                        <th> Type
                        <th> Units
                        <th align=left>Description
        <tr valign=top> <td> TMMI
                        <td> Integer
                        <td> Unitless
                        <td> minimum/maximum temperature
                             combination index
        <tr valign=top> <td> TKMIN
                        <td> Float
                        <td> deg K
                        <td> minimum source-based temperature per day
        <tr valign=top> <td> TKMAX
                        <td> Float
                        <td> deg K
                        <td> maximum source-based temperature per day
        </tr>
    </table>
    </DL>
    <p>
    

<HR> 

<H2> <a name="MLKLST"> MLKLST File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> List of link source VMT
        input files (includes format for link input files)<p>
    <b>Sequence:</b>    Optional Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b> <a href= "#RAWMOBIL"> RAWMOBIL</a> program<p>
    
    <b>Summary:</b> The MLKLST file is simply an ASCII file that lists one or
    more link VMT raw data files.  This file is used to assign the input files
    because it is sometimes desirable to have input data in separate files and
    directories.  The format for the individual link raw VMT files is described
    below.<p>

The MLKLST file must also contain one or more <b>INVYEAR</b> packets.  This
packet acts as a switch that sets the inventory year for the files listed in
MLKLST, each of which will get the year designated by the packet until another
<b>INVYEAR</b> packet is used. The inventory year is one of the fields stored
in the <a href= "#MOBL"> MOBL</a> file output from <a href=
"#RAWMOBIL"> RAWMOBIL</a>.  The first line of the MLKLST file must contain
this packet, in order to intialize the inventory year.  The INVYEAR packet
exists because it is sometimes desirable to combine input data from multiple
years.  However, because the mobile section of SMOKE does not yet have
projection capabilities, <b>it is not recommended that link VMT are input
using with more than one inventory year.</b><p>

<H3>File Format(s)</H3>

<b>Format for MLKLST file:</b> List formatted<br>
    <b>Example:</b>The following is an example of a correct MLKLST file.<p>
 
    <pre>
     INVYEAR 1995
    /storage/smoke/inventory/1995/mobile/link1.vmt.txt
    /storage/smoke/inventory/1995/mobile/link2.vmt.txt
    </pre>
<p>

<b>Format for link VMT files listed in MLKLST: </b> List formatted<br>
Raw mobile link data files are ASCII files with multiple records.  Each
record is expected be on a new line and to contain the following fields:

<ul>
    
    <li> State and county FIPS code (5-digits) (INTEGER) </li>
    <li> <A HREF="#RoadClasses"> AIRS AMS road type code</A> (3 digit INTEGER,
    e.g., 310) or <A HREF="#RoadClasses"> area and facility code</A> (2 digit
    INTEGER, e.g., 07)</li>
    <li> Link number : 
         Any positive integer, 8 digits or less, which is unique for every link 
	 in a given (FIPS code)x(Road class).
         </li>
    <li> UTM X-coordinate for beginning of link-county (FLOAT)</li>
    <li> UTM Y-coordinate for beginning of link-county (FLOAT)</li>
    <li> UTM X-coordinate for end of link-county (FLOAT)</li>
    <li> UTM Y-coordinate for end of link-county (FLOAT)</li>
    <li> UTM zone on which link coordinates are based (INTEGER)</li>
    <li> Link-county-specific VMT [miles/day] (FLOAT)</li>
</ul>

Note that all fields in the record must be county-specific, therefore, if the
actual road crosses a county, multiple records must be specified in this file
such the the link starts or ends at the boundary of the county. For the same
reason, the VMT data for a road must be manually divided amongst the counties,
and those values input in the VMT field of this file. <P>

The read of this file is list formatted, and therefore requires only that each 
record be on a new line, and that the fields are delimited. <P>

<HR> 

<H2> <a name="MNLST"> MNLST File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> List of non-link source VMT
        input files (includes format for non-link input files)<p>
    <b>Sequence:</b>    Optional Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b> <a href= "#RAWMOBIL"> RAWMOBIL</a> program<p>
    <b>Summary:</b>     
The MNLST file is simply an ASCII file that lists one or more non-link VMT raw
data files.  This file is
used to assign the input files because it is sometimes desirable to have input
data in separate files and directories.  The format for the individual non-link
raw VMT files is described below.<p>

The MNLST file must also contain one or more <b>INVYEAR</b> packets.  This
packet acts as a switch that sets the inventory year for the files listed in
MNLST, each of which will get the year designated by the packet until another
<b>INVYEAR</b> packet is used. The inventory year is one of the fields stored
in the <a href= "#MOBL"> MOBL</a> file output from <a href=
"#RAWMOBIL"> RAWMOBIL</a>.  The first line of the MNLST file must contain
this packet, in order to intialize the inventory year.  The INVYEAR packet
exists because it is sometimes desirable to combine input data from multiple
years.  However, because the mobile section of SMOKE does not yet have
projection capabilities, <b>it is not recommended that non-link VMT are input
using with more than one inventory year.</b><p>

<H3>File Format(s)</H3>
<b>Format for MNLST file:</b> List formatted<br>
    <b>Example:</b> The following is an example of a correct MNLST file.<br>
<pre>
     INVYEAR 1995
    /storage/smoke/inventory/1995/mobile/nonlink1.vmt.txt
    /storage/smoke/inventory/1995/mobile/nonlink2.vmt.txt
</pre>
<p>

<b>Format for non-link VMT files listed in MNLST:</b> List formatted <br> 
Raw mobile non-link data files are ASCII files with multiple records.  Each
record is expected be on a new line and to contain the following fields:

<ul>
    <li> State and county FIPS code (5-digits) (INTEGER)</li>
    <li> <A HREF="#RoadClasses"> AIRS AMS road type code</A> (3 digit INTEGER,
    e.g., 310) or <A HREF="#RoadClasses"> area and facility code</A> (2 digit
    INTEGER, e.g., 07)</li>
    <li> County-specific VMT [miles/day] (FLOAT)</li>
</ul>

The read of this file is list formatted, and therefore requires only that
each record be on a new line, and that the fields are delimited. <P>

<HR> 

<H2> <a name="MOBL"> MOBL File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> SMOKE inventory file<p>
    <b>Sequence:</b>    Intermediate<p>
    <b>Type:</b>        NetCDF<p>
    <b>Origin:</b>      <a href= "#RAWMOBIL"> RAWMOBIL</a> program<p>
    <b>Used by:</b>     <a href= "#GRDMMAT"> GRDMMAT</a>,
                        <a href= "#SPCMMAT"> SPCMMAT</a>,
                        <a href= "#PREDIUR"> PREDIUR</a>,
                        <a href= "#TMPMOBIL"> TMPMOBIL</a>,
                        <a href= "QA.html#GRDMOBIL"> GRDMOBIL</a>, and
                        <a href= "QA.html#CSGMOBIL"> CSGMOBIL</a> programs <p>
                        
    <b>Summary:</b>   The MOBL file is the "Emissions Source Attributes
    Database" for mobile sources, also known as the "mobile source inventory
    file". It contains the mobile source VMT and all source attributes.  At any
    of the processing stages in which SMOKE needs the state and county FIPS
    code, road class code, link ID, inventory year, VMT, etc., this is the file
    that is used. These sources atrributes are not duplicated in any other SMOKE
    file.<p>

    Subscripts for the file's variables represent the source number.  The
    sources are sorted deliberately in a specific sequence. They are sorted 
    first by state and county FIPS code, then by road class code, and then by
    link code.  Non-link sources have a link value equal to zero.  All other
    files that are arrays or matrices with rows corresponding to sources have
    the variables sorted in this same order.<p>

<H3>File Format(s)</H3>
    <b>Structure:</b> Degenerate GRDDED3<p>
    <b>Header:</b><p>
    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <th> Header variable
                        <th align=left> Meaning
                        <th align=left> Set by...
        </tr>
        <tr valign=top> <td> NROWS3D
            <td> The number of rows is the number of mobile sources
            <td> Parameter NMSRC in <a href= "INCLUDES.html#mbdims">
            MBDIMS3.EXT</a>
        </tr>
        <tr valign=top> <td> P_ALP3D
            <td> The UTM zone to which all input link coordinates have been 
            converted
            <td> User at run-time
        </tr>
    </table>
    </DL>
    <p>

    <b>Variables:</b>
    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <th> Variable
                        <th> Type
                        <th> Units
                        <th align=left>Description
        <tr valign=top> <td> FIP
                        <td> Integer
                        <td> Unitless
			<td> State and county FIPS code
        <tr valign=top> <td> IRCLAS
                        <td> Integer
                        <td> Unitless
			<td> AIRS AMS road type code
        <tr valign=top> <td> TZONES
                        <td> Integer
                        <td> hours from GMT 
			<td> Standard time zone
        <tr valign=top> <td> TPFLAG
                        <td> Integer
                        <td> Unitless 
			<td> 
                            <UL>
                            <LI>  seasonal temporal profiles should be used for 
                                  a source S only if TPFLAG(S) is divisible by 
                                  parameter STPRFAC from INCLUDE file 
                                  <A HREF =
                                  "INCLUDES.html#tmdims">TMDIMS3.EXT</A>.

                            <LI>  monthly temporal profiles should be used for 
                                  a source S only if TPFLAG(S) is divisible by 
                                  parameter MTPRFAC.

                            <LI>  day-of-week temporal profiles should be used 
                                  and normalized over the whole week
                                  for a source S only if TPFLAG(S) is divisible 
                                  by parameter WTPRFAC.
                                  
                            <LI>  day-of-week temporal profiles should be used 
                                  and normalized over only the weekdays
                                  for a source S only if TPFLAG(S) is divisible 
                                  by parameter WDTPFAC.
                            </UL>
        <tr valign=top> <td> INVYR
                        <td> Integer
                        <td> year AD 
			<td> inventory year of emissions
        <tr valign=top> <td> ILINK
                        <td> Integer
                        <td> Unitless
                        <td> Link ID code (8-digits or less)
        <tr valign=top> <td> XLOC1
                        <td> Float
                        <td> m
                        <td> UTM X coordinates for beginning of link
        <tr valign=top> <td> YLOC1
                        <td> Float
                        <td> m
                        <td> UTM Y coordinates for beginning of link
        <tr valign=top> <td> XLOC2
                        <td> Float
                        <td> m
                        <td> UTM X coordinates for end of link
        <tr valign=top> <td> YLOC2
                        <td> Float
                        <td> m
                        <td> UTM Y coordinates for end of link
        <tr valign=top> <td> VMT
                        <td> Float
                        <td> mi/day
                        <td> Vehicle miles traveled
        </tr>
    </table>
    </DL>
    <p>
    
<HR> 

<P>
<H2> <a name="MPLIST"> MPLIST File </a></H2>

<H3> Overview</H3>
    <b>Description:</b> Simulation- specific emissions factors cross- reference file<p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b>     <a href= "#PREDIUR"> PREDIUR</a> and
                        <a href= "#EMISFAC"> EMISFAC</a> programs<p>
    <b>Summary:</b> MPLIST is an ASCII file created for a given mobile source
    data processing scenario.  The file associates spatial and temporal
    characteristics of the simulation with sets of MOBILE5 input parameters in
    the file <A HREF="#MPREF"> MPREF</A>. In other words, this file is used to
    assign specific emission factors or combinations of emission factors to
    each state, county, road class, and link ID. In cases where defaults are
    desired, zeroes should be used in place of the actual codes for fields
    that will not be used.  See the examples below for how to use defaults.<p>

<H3>File Format(s)</H3>
    <b>Structure:</b> List formatted<p>
 
    <DL><DT> &nbsp; <DD>
    <table>
        <tr><td> 1+<td> A <td>State and County FIPS code
        <tr><td> &nbsp;  <td> B <td><a href="#RoadClasses"> Road class code</a>
        <tr><td> &nbsp;  <td> C <td>Link ID or zero if not link-specific
        <tr><td> &nbsp;  <td> D+ <td>PSI entries for each hour (can use shortcut
        format, see below)
    </table>
    <p>
    
    The PSI references need to be specified for each of 24 hours of the day. 
    In the typical case, the emission factors (and hence the PSIs) do not vary
    with time, and 24 PSIs are needed.  The most basic way to structure this
    file is by putting one PSIs per column.  A shortcut format, however, can
    also be used to indicate blocks of hours to use a specific PSI.  This
    format is the number of hours, followed by an asterisk, followed by a PSI.
    See the examples below.
    
    </DL>

    <b>Example:</b><p>
 
    <ol>
    
    <li><b>  Ultimate default</b> This MPLIST entry would be used to apply PSI
    001 for all 24 hours, and all sources that do not have a more specific
    entry in the file.
    <PRE>
00000 000 000 24*001
    </PRE>
    <P>
    <li> <b>State default for specific road type</b> This example applies PSI
    002 to all Urban Freeways (road type 250) in North Carolina (FIPS code
    37000).
    <PRE>
37000 250 000 24*002
    </PRE>
    <P>
    <li> <b> Time variable application</b> This example applies PSI 003 for the
    first 8 hours, PSI 004 for the second 8 hours, and PSI 001 for the final 8
    hours of the day.
    <PRE>
37000 000 000 8*003 8*004 8*001
    </PRE>
    <P>
    <li> <b> Example file</b>  Normally, this file will contain multiple
    lines of different type, all in a single file.
    <PRE>
00000 000 000 24*001
37000 000 000 8*003 8*004 8*001
37000 250 000 24*002
45000 000 000 24*009  
    </PRE>
    <P>
    </ol>

<HR> 
<H2> <a name="MPREF">MPREF File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> MOBILE5 parameters cross- reference (defines PSIs)<p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b>     <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b>     

MPREF associates a parameter scheme index (PSI) with the MOBILE5 input (using
the MOBILE5 input format), tables used to drive MOBILE5, or with a description
for combining other emission factors.  MPREF is used by the  <A HREF=
"#EMISFAC"> EMISFAC</A> program to ensure that the necessary emission factors
exist for a given  simulation. For more information on the meaning of a PSI,
please refer to the section on <a href= "#PSI"> parameter scheme indices</a>
at the beginning of this chapter.<P>

<H3>File Format(s)</H3>
    There are four types of multi-line records that can appear in this
    file. At least one record of types (1), (2), or (3) must appear, but both
    type (1) and type (2) cannot legitimately appear in the same file. All
    types of records can appear in the same file, and there can be multiple
    entries of each type. No blank lines should exist between each record. The
    four record types and their formats are:<p>
    
    <b> 1. MOBILE5a input:</b> Use to input MOBILE5a input files and generate
        MOBILE5a emission factors.<br>
        <b>Structure, SMOKE part:   </b> List formatted <br>
        <b>Structure, MOBILE5a part:</b> Column specific
        <DL><DT> &nbsp; <DD>
        <table>
            <tr><th> Line <th>Columns <th align=left> Description
            <tr><td align = center> 1
                <td align = center> A
                <td> The entry "MOBILE5A" should appear in this line and column
                     (no quotes in the actual entry - see example, below)
            </tr>
            <tr><td align = center> &nbsp;
                <td align = center> B
                <td> The number of PSIs generated in the record (equivalent to
                the number of "scenarios" in the MOBILE5a input file .  The
                scenarios in the example below are defined by the lines 
                labeled "URBAN INTERSTATE", etc.
            </tr>
            <tr><td align = center>  &nbsp;
                <td align = center> C through C(B)
                <td> For each of the number of PSIs listed in column B, these
                     columns should contain the PSI codes for each scenario in
                     the MOBILE5a input file (assign arbitrary numbers)
            </tr>
            <tr><td align = center> 2+
                <td align = center> all
                <td>  For as many rows are as needed, this part of the record
                should contain the MOBILE5a inputs
            </tr>
        </table>
        </DL>
    <b> 2.  MOBILE5b input:</b> Use to input MOBILE5a or MOBILE5b input files 
        and generate MOBILE5b emission factors<br>   
        <b>Structure, SMOKE part:</b>  List formatted <br>
        <b>Structure, MOBILE5b part:</b> Column specific
        <DL><DT> &nbsp; <DD>
        <table>
            <tr><th> Line <th>Columns <th align=left> Description
            <tr><td align = center> 1
                <td align = center> A
                <td> The entry "MOBILE5B" should appear in this line and column 
                     (no quotes in the actual entry - see example, below)
            </tr>
            <tr><td align = center>  &nbsp; 
                <td align = center> B
                <td> The number of PSIs generated in the record (equivalent to
                the number of "scenarios" in the MOBILE5a or MOBILE5b input
                file. The scenarios in the example below are defined by the 
                lines labeled "URBAN INTERSTATE", etc.
            </tr>
            <tr><td align = center>  &nbsp; 
                <td align = center> C through C(B)
                <td> For each of the number of PSIs listed in column B, these
                     columns should contain the PSI codes for each scenario in
                     the MOBILE5a or MOBILE5b input file (assign arbitrary numbers)
            </tr>
            <tr><td align = center> 2+
                <td align = center> all
                <td>  For as many rows are as needed, this part of the record
                should contain the MOBILE5a or MOBILE5b inputs
            </tr>
        </table>
        </DL>
        
    <b> 3. Table-based:</b> Generate emission factors from MOBILE5 inputs that
    reside in tables (not all MOBILE5 input categories supported for tables).
    All entries in the second line must be present, and a zero entry indicates
    the use of the MOBILE5 default for that parameter.  Some columns in this
    line, however, may never contain a zero. <p>
    
    Note that both the oxygenated fuels and reformulated gas are given using 
    the profile pointed to by F4 (see the  <A HREF="#MLAPMO"> MLAPMO</A> file
    description). In the case of oxygenated fuels, the entry in the MLAPMO
    record is a pointer to the oxygenated fuels profile in <A
    HREF="#MOXYF">MOXYF</A>, or zero to indicate no oxygenated fuels program. 
    For reformulated gas, the entry in MLAPMO is 1 to turn on a reformulated
    gas program, and 0 to leave it off. <p>

        <b>Structure:</b> List formatted
        <DL><DT> &nbsp; <DD>
        <table>
            <tr><th> Line <th>Columns <th align=left> Description
            <tr><td align = center> 1
                <td align = center> A
                <td> PSI number 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> B
                <td> Should contain a zero 
            </tr>
            <tr><td align = center> 2
                <td align = center> A
                <td> <b>F1</b>
             - mileage accumulation rates for all vehicle types 
             (see <A HREF="#MACUM"> MACUM</A> )
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> B
                <td> <b>F2</b>
             - registration distribution rates for all vehicle types 
             (see <A HREF="#MRGDS"> MRGDS</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> C
                <td> <b>F3</b>
             - tampering rates( 4 vehicle types, 8 rates ) 
             (see <A HREF="#MTRATE"> MTRATE</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> D
                <td> <b>F4</b>
             - LAP/month records.  Index must &gt 0 
             (see <A HREF="#MLAPMO"> MLAPMO</A> and
                  <A HREF="#MOXYF"> MOXYF</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> E
                <td> <b>F5</b>
             - trip length distribution 
             (see <A HREF="#MTLEN"> MTLEN</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> F
                <td> <b>F6</b>
             - diesel fuels sales fraction 
             (see <A HREF="#MDLSF"> MDLSF</A> )
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> G
                <td> <b>F7</b>
             - average speeds for all vehicle types 
             (see <A HREF="#MAVSPD"> MAVSPD</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> H
                <td> <b>F8</b>
             - operating modes for all vehicle types Index must &gt 0
             (see <A HREF="#MOPMOD"> MOPMOD</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> I
                <td> <b>F9</b>
             - Region indicator ( altitude or LEV program flag )
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> J
                <td> <b>F10</b>
             - A/C usage, extra loading, trailer towing, humidity 
             (see <A HREF="#MLOAD"> MLOAD</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> K
                <td> <b>G1</b>
             - Basic exhaust emissions rates 
             (see <A HREF="#MBSEXH"> MBSEXH</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> L
                <td> <b>G2</b>
             - New evaporative emissions tests 
             (see <A HREF="#MNEVAP"> MNEVAP</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> M
                <td> <b>G3</b>
             - I/M program specifications 
             (see <A HREF="#MEFIM"> MEFIM</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> N
                <td> <b>G4</b>
             - Non-default tech I-II I/M credits file: use 0 for 
               default MOBILE5a credits file "TECH12.D" and a positive number 
               indicating the suffix of the non-default credits file
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> O
                <td> <b>G5</b>
             - Non-default tech IV+ I/M credits file: use 0 for default 
               MOBILE5a credits file "IMDATA.D" and a positive number 
               indicating the suffix of the non-default credits file
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> P
                <td> <b>G6</b>
             - Anti-tampering program (ATP) 
             (see <A HREF="#MEFATP"> MEFATP</A> )
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> Q
                <td> <b>G7</b>
             - Functional pressure test 
             (see <A HREF="#MPREST"> MPREST</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> R
                <td> <b>G8</b>
             - Functional purge test 
             (see <A HREF="#MPURGT"> MPURGT</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> S
                <td> <b>G9</b>
             - LEV programs 
             (see <A HREF="#MEFLEV"> MEFLEV</A> ) 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> T
                <td> <b>G10</b>
             - refueling controls 
             (see <A HREF="#MEFRFL"> MEFRFL</A> ) 
            </tr>
        </table>
        </DL>

    <b> 4. Combinations:</b> Generate emission factors based on combinations
    of other emission factors. The number of columns in the second line of this
    record depends on the value in the second column of line 1  of this record.
    If N is the value in the second column of line 1, the second line contains
    N*2 entries where the entries PERCENT( I ) and PSI( I ) are used in the
    following formula to create a new set of emission factors: <P>

    EF = SUM( PERCENT( I ) * PSI( I ), I = 1,N ) <P>

    PERCENT( I ) is the percentage of  PSI( I ) on which to base the
    new emission factor. <P>

    PSI( I ) is the PSI index from elsewhere in the MPREF file to use
    in calculating the new emission factor.  The EMISFAC program will not
    accept the MPREF file if any PSI given to be used in a combination emission
    factor is not defined by its own record.<p>

        <b>Structure:</b> List formatted 
        <DL><DT> &nbsp; <DD>
        <table>
          <tr><th> Line <th>Columns <th align=left> Description
          <tr><td align = center> 1
                <td align = center> A
                <td> PSI number 
            </tr>
            <tr><td align = center> &nbsp; 
                <td align = center> B
                <td> Should contain a positive integer indicating the number of
                PSIs on which this PSI depends 
            </tr>
            <tr><td align = center> 2
                <td align = center> A
                <td> Percentage of first PSI to contribute to this PSI
            </tr>
            <tr><td align = center>  &nbsp; 
                <td align = center> B
                <td> First PSI to contribute to this PSI
            </tr>
            <tr><td align = center>  &nbsp; 
                <td align = center> C, E, G, etc.
                <td> Percentage of additional PSIs to contribute to this PSI
            </tr>
            <tr><td align = center>  &nbsp; 
                <td align = center> D, F, H, etc.
                <td> Additional PSIs to contribute to this PSI
            </tr>
        </table>
        </DL>
    
<P>

    <b>Example:</b><p>
 
    The following example shows three of the four input types.  PSI 14 is
    table-based, PSI 13 is a combination, PSIs 001 through 012 are MOBILE5b
    based.  A MOBILE5a example would be similar to the MOBILE5b ones, but the
    field 'MOBIL5B' would be replaced with 'MOBILE5A'.

    <PRE>
014 0
0 001 0 011 0 00 0560 001 1 0 0 0 37119 0     0 0 37119 0 0 0 0
013 2
0.5 001 0.5 006
MOBILE5B 6 001 002 003 004 005 006
3  0
JULY 10-15, I/M RUN, 1995, OZONE SEASON, MAINTENANCE COUNTIES
1 1 2 3 1 2 1 2 1 1 1 3 4 1 3 2
.055 .094 .098 .093 .088 .085  081 .058 .047 .046
.043 .046 .039 .031 .021 .011 .010 .010 .009 .005
.005 .003 .003 .002 .017
.087 .131 .138 .107 .101 .088 .067 .035 .034 .021
.017 .029 .032 .023 .016 .009 .013 .008 .007 .004
.006 .004 .004 .003 .016
.060 .112 .117 .098 .097 .074 .066 .044 .031 .030
.027 .039 .033 .029 .021 .013 .018 .018 .015 .009
.010 .009 .006 .006 .018
.063 .093 .085 .092 .084 .087 .065 .035 .031 .025
.040 .055 .044 .026 .019 .023 .029 .025 .021 .009
.008 .005 .005 .005 .026
.055 .094 .098 .093 .088 .085  081 .058 .047 .046
.043 .046 .039 .031 .021 .011 .010 .010 .009 .005
.005 .003 .003 .002 .017
.087 .131 .138 .107 .101 .088 .067 .035 .034 .021
.017 .029 .032 .023 .016 .009 .013 .008 .007 .004
.006 .004 .004 .003 .016
.074 .109 .109 .103 .080 .084 .077 .039 .043 .032
.045 .046 .034 .030 .015 .012 .013 .012 .007 .004
.002 .003 .002 .001 .024
.079 .095 .070 .076 .099 .088 .058 .058 .067 .053
.044 .213 .000 .000 .000 .000 .000 .000 .000 .000
.000 .000 .000 .000 .000
87 14 75 20 01 01  80 2 1 2222 1111
92 75 20 2222 21  80  22212222
1 95 58.1 81.0 00.0 00.0 00.0  7
URBAN INTERSTATE  70.0091.007.8007.800 92 1 1
.668.112.051.018.002.001.144.004
1 95 57.2 81.0 00.0 00.0 00.0  7
URBAN FREEWAY     70.0091.007.8007.800 92 1 1
.773.093.042.015.002.000.071.004
1 95 24.0 81.0 20.6 27.3 20.6  7
URBAN PRIN ART    70.0091.007.8007.800 92 1 1
.785.085.039.014.003.000.070.004
1 95 21.0 81.0 20.6 27.3 20.6  7
URBAN MIN ART     70.0091.007.8007.800 92 1 1
.819.079.036.013.003.000.046.004
1 95 22.0 81.0 20.6 27.3 20.6  7
URBAN COLLECTOR   70.0091.007.8007.800 92 1 1
.900.046.021.007.003.000.019.004
1 95 13.0 81.0 20.6 27.3 20.6  7
URBAN LOCAL       70.0091.007.8007.800 92 1 1
.900.046.021.007.003.000.019.004
</PRE>
<p>
<PRE>
MOBILE5B 6 007 008 009 010 011 012
3  0
JULY 10-15, I/M RUN, 1995, OZONE SEASON, MAINTENANCE COUNTIES
1 1 2 3 1 2 1 2 1 1 1 3 4 1 3 2
.055 .094 .098 .093 .088 .085  081 .058 .047 .046
.043 .046 .039 .031 .021 .011 .010 .010 .009 .005
.005 .003 .003 .002 .017
.087 .131 .138 .107 .101 .088 .067 .035 .034 .021
.017 .029 .032 .023 .016 .009 .013 .008 .007 .004
.006 .004 .004 .003 .016
.060 .112 .117 .098 .097 .074 .066 .044 .031 .030
.027 .039 .033 .029 .021 .013 .018 .018 .015 .009
.010 .009 .006 .006 .018
.063 .093 .085 .092 .084 .087 .065 .035 .031 .025
.040 .055 .044 .026 .019 .023 .029 .025 .021 .009
.008 .005 .005 .005 .026
.055 .094 .098 .093 .088 .085  081 .058 .047 .046
.043 .046 .039 .031 .021 .011 .010 .010 .009 .005
.005 .003 .003 .002 .017
.087 .131 .138 .107 .101 .088 .067 .035 .034 .021
.017 .029 .032 .023 .016 .009 .013 .008 .007 .004
.006 .004 .004 .003 .016
.074 .109 .109 .103 .080 .084 .077 .039 .043 .032
.045 .046 .034 .030 .015 .012 .013 .012 .007 .004
.002 .003 .002 .001 .024
.079 .095 .070 .076 .099 .088 .058 .058 .067 .053
.044 .213 .000 .000 .000 .000 .000 .000 .000 .000
.000 .000 .000 .000 .000
87 14 75 20 01 01  80 2 1 2222 1111
92 75 20 2222 21  80  22212222
1 95 58.1 81.0 00.0 00.0 00.0  7
RURAL INTERSTATE  70.0091.007.8007.800 92 1 1
.676.078.035.013.002.000.192.004
1 95 56.5 81.0 00.0 00.0 00.0  7
RURAL PRIN ART    70.0091.007.8007.800 92 1 1
.719.104.047.017.002.001.106.004
1 95 37.0 81.0 20.6 27.3 20.6  7
RURAL MINOR ART   70.0091.007.8007.800 92 1 1
.746.105.047.017.002.001.078.004
1 95 24.0 81.0 20.6 27.3 20.6  7
RURAL MAJ COL     70.0091.007.8007.800 92 1 1
.746.107.049.018.002.001.073.004
1 95 24.0 81.0 20.6 27.3 20.6  7
RURAL MIN COL     70.0091.007.8007.800 92 1 1
.802.098.044.016.003.001.032.004
1 95 24.0 81.0 20.6 27.3 20.6  7
RURAL LOCAL       70.0091.007.8007.800 92 1 1
.802.098.044.016.003.001.032.004
    </PRE>


<HR> 

<H2> <a name="MSCNV"> MSCNV File </a></H2>

<H3> Overview</H3>
    <b>Description:</b> Volatile conversion factors (e.g., VOC to TOG)<p>
    <b>Sequence:</b>    Optional Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b>     <a href= "#SPCMMAT"> SPCMMAT</a> program <p>

    <b>Summary:</b>    The ASCNV file is used to convert the volatile inventory
    pollutant emissions in the area source inventory to a different volatile
    inventory pollutant, for which the speciation profiles are available.  This
    file is not necessary if the volatile inventory pollutant is consistent
    between the two files. <p>

<H3>File Format(s)</H3>
    <b>Structure:</b> Column-specific<p>
        <DL><DT> &nbsp; <DD>
        <table>
            <tr><td align=center> Line</td> <td align=center>Columns</td> 
                <td>Description</td>
            <tr><td align=center> 1+
                <td align=center> 1-5
                <td> State FIPS and county code 
            <tr><td align=center>  &nbsp; 
                <td align=center> 7-8
                <td> The letters 'MV' 
            <tr><td align=center>  &nbsp; 
                <td align=center> 9-10
		<td> Number of the <a href= "#VehicleTypes"> vehicle type</a>
		(e.g. '01' or '00' for all
            <tr><td align=center>  &nbsp; 
                <td align=center> 11-13
                <td> <a href= "#RoadClasses"> AIRS AMS Road type code</a> (e.g.,
                '110' or '000' for all)
            <tr><td align=center>  &nbsp; 
                <td align=center> 14-16
                <td> <a href= "#EmisProcMode"> Emissions process</a> (e.g., 'EXH')
            <tr><td align=center>  &nbsp; 
                <td align=center> 19-25
                <td> Conversion factor	
      </table>
       </DL>
       <p>
   <b>Example:</b><p>
   <pre>
    00000 MV01000RNL   1.03
    00000 MV01000EXH   1.15
    00000 MV02000RNL   1.03
    00000 MV02000EXH   1.15
    00000 MV03000RNL   1.03
    00000 MV03000EXH   1.15
    00000 MV04000DNL   1.03
    00000 MV04000EVP   1.03
    00000 MV04000EXH   1.03
    00000 MV04000HOT   1.03
    00000 MV04000RNL   1.03
    00000 MV04000RST   1.03
    00000 MV08000EXH   1.15
   </pre>

<HR> 

<H2> <a name="MSMAT"> MSMAT File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Mobile source speciation matrix<p>
    <b>Sequence:</b>    Intermediate<p>
    <b>Type:</b>        NetCDF<p>
    <b>Origin:</b>      <a href= "#SPCMMAT"> SPCMMAT</a> program<p>
    <b>Used by:</b> <a href= "QA.html#CSGMOBIL"> CSGMOBIL</a>,
                    <a href= "MERGE.html#CSGMERGE"> CSGMERGE</a>,
                    <a href= "MERGE.html#CSGLMERGE"> CSGLMERGE</a>, or
                    <a href= "MERGE.html#CSGLDAYMRG"> CSGLDAYMRG</a><p>
                   
    <b>Summary:</b> The speciation matrix is used to transform source- based
    emissions of inventory pollutants from the various emissions processes to
    source- based emissions of model species. The rows of the matrix correspond
    to the mobile sources (with the rows sorted in the same order as the sources
    in the <a href= "#MOBL"> MOBL</a> file.  The columns of the matrix
    correspond to the intersections of the <a href= "#EmisProcMode"> emission
    types</a> (e.g., EXH_NOX), and the model species.  Because each emission
    type gives rise to only a few model species, this matrix is sparse (has a
    lot of zeroes).  In order to prevent the storage of zeroes for nonsense
    transformations (such as EXH_CO to NO2 - when only EXH_NOX produces NO2),
    the non-zero portions of the matrix are stored as variables in the file.
    Furthermore, since the speciation conversions can be different for the
    different <a href= "#VehicleTypes"> vehicle types</a>, the "layers" of the
    file are used to store the speciation factors for each vehicle type.
    See below for more information on the storage format.  <P> 

<H3>File Format(s)</H3>
    <b>Structure:</b> Time- independent, degenerate GRDDED3<p>
    <b>Header:</b>
    <DL><DT> &nbsp; <DD>
    <table>
        <tr valign=top> <td> Header variable
                        <td> Meaning
                        <td> Set by...
        </tr>
        <tr valign=top> <td> NROWS
            <td> The number of rows is used for the actual number of mobile
            sources 
            <td> Parameter NMSRC in <a href= "INCLUDES.html#mbdims">
            MBDIMS3.EXT</a>
        <tr valign=top> <td> NLAYS
            <td> The number of layers is used for the actual number of vehicle
            types
            <td> Parameter NVTYPE in <a href= "INCLUDES.html#mbdims">
            MBDIMS3.EXT</a>
        </tr>
    </table>
    </DL>

    <p>
    <b>Variables:</b><p>

    The variables have names built out of the names of the emissions processes,
    inventory pollutants, and the chemical mechanism species from the speciation
    list file <A HREF = "#SPCS"> SPCS</A>.  In the example below, VOC is assumed
    to be the volatile inventory pollutant, and the species shown are from the
    Carbon Bond IV mechanism.<p>

    Generally, the structure of the variable names in the MSMAT file is:
        <BLOCKQUOTE>
            <VAR>&lt;Emissions Process(i)&gt;_&lt;Inventory Pollutant(j)&gt;
            _&lt;Chemical Mechanism Species(k)&gt</VAR>
        </BLOCKQUOTE>
    <p>
    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <td> Variable
                        <td> Type
                        <td> Units
                        <td> Description
        <tr valign=top> <td> EXH_CO_CO
                        <td> Float
                        <td> moles/ton
			<td> Conversion factor from exhaust CO in tons to CO in 
			moles
        <tr valign=top> <td> EXH_NOX_NO 
                        <td> Float
                        <td> moles/ton
			<td> Conversion factor from exhaust NOx in tons to NO in
		        moles
        <tr valign=top> <td> EXH_NOX_NO2
                        <td> Float
                        <td> moles/ton
			<td> Conversion factor from exhaust NOx in tons to NO2 
			in moles
        <tr valign=top> <td> EXH_VOC_OLE
                        <td> Float
                        <td> moles/ton
			<td> Conversion factor from exhaust VOC in tons to 
			Olefins in moles
        <tr valign=top> <td> EVP_VOC_OLE
                        <td> Float
                        <td> moles/ton
			<td> Conversion factor from evaporative VOC in tons 
			to Olefins in moles
         <tr valign=top> <td> RNL_VOC_OLE
                        <td> Float
                        <td> moles/ton
			<td> Conversion factor from running loss VOC in tons 
			to Olefins in moles
        <tr valign=top> <td> RST_VOC_OLE
                        <td> Float
                        <td> moles/ton
			<td> Conversion factor from resting loss VOC in tons 
			to Olefins in moles
        <tr valign=top> <td> RFL_VOC_OLE
                        <td> Float
                        <td> moles/ton
			<td> Conversion factor from refueling VOC in tons 
			to Olefins in moles
        <tr valign=top> <td> DNL_VOC_OLE
                        <td> Float
                        <td> moles/ton
			<td> Conversion factor from diurnal VOC in tons 
			to Olefins in moles
        <tr valign=top> <td> EXH_VOC_PAR
                        <td> Float
                        <td> moles/ton
			<td> Conversion factor from exhaust VOC in tons to 
			Parafins in moles
        <tr valign=top> <td> etc.
                        <td>  &nbsp; 
                        <td>  &nbsp; 
			<td>  &nbsp; 

    </table>
    </DL>                    
    <p>

<HR> 

   
<H2> <a name="MSPRO"> MSPRO File </a></H2>

<H3> Overview</H3>
    <b>Description:</b> Speciation profiles<p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b>     <a href= "#SPCMMAT"> SPCMMAT</a> program <p>
    
    <b>Summary:</b> The MSPRO file is used for creating the speciation matrix
    factors for converting the volatile inventory pollutant (e.g., VOC, ROG,
    TOG) to its component species (e.g., OLE, PAR, ETH).  The factors in this
    file are called "split factors" or "speciation profiles".<p>

<H3>File Format(s)</H3>
    <b>Same as:</b> EPS2.0 split factors file (from EMSCVT), Table B-35 in
    EPS2.0 manual (exception in line length: maximum length here is 256, not
    306)<p>
    <b>Structure:</b> Column-specific<p>
        <DL><DT> &nbsp; <DD>
        <table>
            <tr><td align=center> Line</td> <td align=center>Columns</td> 
                <td>Description</td>
            <tr><td align=center> 1
                <td align=center> 1-5
                <td> Number of species in file
            <tr><td align=center> 2+
                <td align=center> 1-10
                <td> Species name (as appears in <a href=
                    "INCLUDES.html#chdgen"> CHDGEN3.EXT</a> and <a href= "#SPCS">
                    SPCS</a>)
             <tr><td align=center> &nbsp;  
                <td align=center> 12-16
                <td> Molecular weight
             <tr><td align=center>  &nbsp; 
                <td align=center> 18-22
                <td> Inventory pollutant for which speciation factors are applicable
                    (as appears in <a href= "INCLUDES.html#chdgen"> CHDGEN3.EXT</a>
                    and <a href= "#SPCS"> SPCS</a>)
             <tr><td align=center> 3+
                <td align=center> 1-5
                <td> Profile code
             <tr><td align=center>  &nbsp; 
                <td align=center> 6-256
                <td> Splitting factors for species, with each species in the
                its own E10.3 column in the order as described in the header
       </table>
       </DL>
       <p>

    <b>Example:</b> 
    <p>
    <pre>
       10
    ALD2        32.0 TOG  
    ETH         32.0 TOG  
    ETOH        32.0 TOG  
    FORM        16.0 TOG  
    ISOP        80.0 TOG  
    MEOH        16.0 TOG  
    OLE         32.0 TOG  
    PAR         16.0 TOG  
    TOL        112.0 TOG  
    XYL        128.0 TOG  
     0000  .761E-03  .129E-02  .295E-03  .525E-03  .587E-04  .437E-03  .190E-02  .264E-01  .593E-03  .398E-03
     0001  .000E+00  .000E+00  .000E+00  .140E-01  .000E+00  .000E+00  .000E+00  .276E-01  .000E+00  .000E+00
     0002  .000E+00  .000E+00  .000E+00  .162E-01  .000E+00  .000E+00  .000E+00  .352E-01  .000E+00  .000E+00
     0003  .000E+00  .000E+00  .000E+00  .266E-02  .000E+00  .000E+00  .000E+00  .202E-01  .217E-03  .000E+00
     0004  .000E+00  .000E+00  .000E+00  .253E-02  .000E+00  .000E+00  .416E-02  .323E-01  .000E+00  .000E+00
     0005  .000E+00  .417E-02  .000E+00  .000E+00  .000E+00  .000E+00  .713E-04  .147E-02  .000E+00  .000E+00
     0007  .000E+00  .000E+00  .000E+00  .999E-02  .000E+00  .000E+00  .000E+00  .436E-03  .000E+00  .000E+00
     0008  .000E+00  .102E-01  .000E+00  .000E+00  .000E+00  .000E+00  .909E-02  .147E-01  .000E+00  .000E+00
     0009  .000E+00  .102E-01  .000E+00  .000E+00  .000E+00  .000E+00  .909E-02  .147E-01  .000E+00  .000E+00
     0011  .000E+00  .988E-02  .000E+00  .000E+00  .000E+00  .000E+00  .654E-03  .427E-02  .760E-04  .000E+00
     0012  .000E+00  .000E+00  .000E+00  .000E+00  .000E+00  .000E+00  .000E+00  .184E-01  .000E+00  .000E+00
     0013  .000E+00  .210E-02  .000E+00  .000E+00  .000E+00  .000E+00  .713E-03  .725E-02  .000E+00  .000E+00
     0014  .000E+00  .000E+00  .000E+00  .000E+00  .000E+00  .000E+00  .000E+00  .403E-01  .391E-03  .000E+00

    </pre>
<p>
<HR> 

<H2> <a name="MSREF"> MSREF File </a></H2>

<H3> Overview</H3>
    <b>Description:</b> Speciation cross- reference<p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b>     <a href= "#SPCMMAT"> SPCMMAT</a> program <p>

    <b>Summary:</b> The MSREF file is used to match mobile sources (and vehicle
    type and/or emissions process) with the speciation profiles that the sources
    are to use for the speciation step.  For example, this file could indicate that
    the emissions from heavy duty diesel vehicles and exhaust emissions for all
    sources should use profile 1201. The source attributes of state and county FIPS
    code codes and road class code, and the sub-source attributes of vehicle type
    and emissions process are used to match the sources to the speciation
    profiles.  The file can indicate defaults by using zeroes instead of valid FIPS
    codes, road classes, or vehicle types.  Zeroes cannot be used as a default for
    emissions process (each emissions process must be appear explicitly).<p> 

<H3>File Format(s)</H3>
    <b>Same as:</b> EPS2.0 speciation cross-refernces, Table B-11 in the EPS2.0
    manual.<p>
    
    <b>Structure:</b> Column-specific<p>
        Only fields that are used by SMOKE are listed:<p>
        <DL><DT> &nbsp; <DD>
        <table>
            <tr><td align=center> Line</td> <td align=center>Columns</td> 
                <td>Description</td>
            <tr><td align=center> 1+
                <td align=center> 1-5
                <td> State and county FIPS code
            <tr><td align=center> &nbsp
                <td align=center> 17-18
                <td> The letters 'MV'
            <tr><td align=center>  &nbsp
                <td align=center> 19-20
		<td> Number of the <a href= "#VehicleTypes"> vehicle type</a>
		(e.g. '01' or '00' for all
            <tr><td align=center>  &nbsp
                <td align=center> 21-23
                <td> <a href= "#RoadClasses"> AIRS AMS Road type code</a> (e.g.,
                '110' or '000' for all)
            <tr><td align=center>  &nbsp
                <td align=center> 24-26
                <td> <a href= "#EmisProcMode"> Emissions process</a> (e.g., 'EXH')
            <tr><td align=center>  &nbsp
                <td align=center> 28-32
                <td> Speciation profile code
            <tr><td align=center>  &nbsp
                <td align=center> 34-38
                <td> VOC fracion for profile; fraction of total mass that is to
                be speciated (used for THC inventory only)
            <tr><td align=center>  &nbsp
                <td align=center> 55-59
                <td> Ethane correction factor (default = 1.0)
            <tr><td align=center>  &nbsp
                <td align=center> 61-65
                <td> Formaldehyde correction factor (default = 0.0)
            <tr><td align=center>  &nbsp
                <td align=center> 67-71
                <td> Overall correction factor (default = 1.0)
       </table>
       </DL>
       <p>

    <b>Example:</b>
    <p> 
    <pre>
    00000           MV00000DNL 1204  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV00000EVP 1204  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV00000EXH 1203  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV00000RNL 1204  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV00000RST 1204  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV05000DNL 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV05000EVP 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV05000EXH 1201  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV05000RNL 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV05000RST 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV06000DNL 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV06000EVP 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV06000EXH 1201  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV06000RNL 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV06000RST 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV07000DNL 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV07000EVP 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV07000EXH 1201  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV07000RNL 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    00000           MV07000RST 0078  1.000  0 9.999 9.999 1.000 0.000 1.000
    </pre>
<p>
<HR> 

   
<H2> <a name="MTMP"> MTMP File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Mobile source hourly emission-type emissions<p>
    <b>Sequence:</b>    Intermediate<p>
    <b>Type:</b>        NetCDF<p>
    <b>Origin:</b>      <a href= "#TMPMOBIL"> TMPMOBIL</a> program<p>
    <b>Used by:</b> <a href= "MERGE.html#GRDMOBIL"> GRDMOBIL</a>,
                    <a href= "MERGE.html#CSGMOBIL"> CSGMOBIL</a>,
                    <a href= "MERGE.html#CSGMERGE"> CSGMERGE</a>,
                    <a href= "MERGE.html#CSGLMERGE"> CSGLMERGE</a>, or
                    <a href= "MERGE.html#CSGLDAYMRG"> CSGLDAYMRG</a>
                    programs<p>
                    
    <b>Summary:</b>  The MTMP file contains hourly, <a href= "#EmisProcMode">
    emissions type</a> (e.g., EXH_NOX)  emissions for each source.  The file
    contains one hour for each hour of output that will be generated by the
    merge step(s). It is created by applying temporal profiles and VMT mix data 
    to the product of the VMT and the emission factors.  For each hour, the
    emissions are stored in the same sorted order as the <a href= "#MOBL">
    MOBL</a> inventory file, so that the source characteristics (e.g., FIPS
    code, road class) do not need to be stored in this file. The emissions are
    stored separately for each <a href= "#VehicleType"> vehcile type</a> using
    the "layers" of the NetCDF file structure (see below for more information on the file structure).<p>    

    <b>Structure:</b> Time-dependent, degenerate GRDDED3<p>
    <b>Header:</b>
    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <th> Header variable
                        <th align=left> Meaning
                        <th align=left> Set by...
        </tr>
        <tr valign=top> <td> NROWS3D
            <td> The number of rows is the number of mobile sources
            <td> Parameter NMSRC in <a href= "INCLUDES.html#mbdims">
            MBDIMS3.EXT</a>
        </tr>
        <tr valign=top> <td> NVARS3D
            <td> The number of variables is the number of emissions types 
            <td> Inputs in the <a href= "#SPCS"> SPCS</a> file
        <tr valign=top> <td> NLAYS3D
            <td> The number of layers is the number of vehicle types
            <td> Parameter NVTYPE in <a href= "INCLUDES.html#mbdims">
            MBDIMS3.EXT</a>
        </tr>
    </table>
    </DL>
    <p>
    
    <b>Variables:</b><p>

    The variables have names built out of the names of the emissions processes
    and the inventory pollutants from the speciation list file <A HREF =
    "#SPCS"> SPCS</A>.  In the example below, VOC is assumed to be the volatile
    inventory pollutant.<p>

    Generally, the structure of the variable names in the MTMP file is:
        <BLOCKQUOTE>
            <VAR>&lt;Emissions Process(i)&gt;_&lt;Inventory
            Pollutant(j)&gt</VAR>
        </BLOCKQUOTE>
    <p>
    <DL><DT> &nbsp; <DD>
    <table >
        <tr valign=top> <th> Variable
                        <th> Type
                        <th> Units
                        <th align=left>Description
        <tr valign=top> <td>EXH_CO
                        <td> Float
                        <td> tons/hr
                        <td>Exhaust CO
        <tr valign=top> <td>EXH_NOX
                        <td> Float
                        <td> tons/hr
                        <td> Exhaust NOX
        <tr valign=top> <td>EXH_VOC
                        <td> Float
                        <td> tons/hr
                        <td> Exhaust VOC
        <tr valign=top> <td>EVP_VOC
                        <td> Float
                        <td> tons/hr
                        <td> Evaporative VOC
        <tr valign=top> <td>etc.
                        <td> &nbsp; 
                        <td> &nbsp; 
                        <td> &nbsp; 
        </tr>
    </table>
    </DL>
    <p>

<HR> 
   
<H2> <a name="MTPRO"> MTPRO File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Temporal profiles<p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b> <a href= "#TMPMOBIL"> TMPMOBIL</a> program <p>
    <b>Summary:</b> 
         
    The MTPRO file contains the monthly, weekly, and hourly temporal profiles
    used to convert the average day VMT stored in the inventory file to an
    hourly resolution.  The file can contains four types of records:
    
    <UL> 
        <LI>  <b>Monthly</b>  temporal weighting factors (/MONTHLY/ packet)
        <LI>  <b>Weekly</b>  temporal weighting factors  (/WEEKLY/ packet)
        <LI>  <b>Weekday Diurnal</b>  temporal weighting factors (/DIURNAL
        WEEKDAY/ packet)
        <LI>  <b>Weekend Diurnal</b>  temporal weighting factors (/DIURNAL
        WEEKEND/ packet)
    </UL>

    The weekend diurnal temporal factors are optional.  If the monthly factors
    are not used becasuse all of the inventory emissions are supplied as
    "per day" emissions, at least one monthly profile is still needed to
    prevent and error.<p>
    
    
<H3>File Format(s)</H3>
    <b>Same as:</b> EPS2.0 temporal profiles file, Tables B-38
    through B-40, produced by TMPFAC <p>
    <b>Structure:</b> Column specific<p>
        <DL><DT> &nbsp; <DD>
        <table>
            <tr><th> Line <th>Columns <th align=left> Description
            <tr>
            <th colspan=3> /MONTHLY/  packet</th>
            <tr><td align=center> 1
                <td align=center> 1-20
                <td> Packet identifier = /MONTHLY/
            <tr><td align=center> 2+
                <td align=center> 1-5
                <td> Monthly temporal profile code
            <tr><td align=center> &nbsp; 
                <td align=center> 7-9
                <td> Temporal weight for January
            <tr><td align=center> &nbsp; 
                <td align=center> 11-13
                <td> Temporal weight for February
            <tr><td align=center>  &nbsp; 
                <td align=center> ...
                <td> ...
            <tr><td align=center>  &nbsp; 
                <td align=center> 51-53
                <td> Temporal weight for December
            <tr><td align=center>  &nbsp; 
                <td align=center> 51-53
                <td> Total of weights for entire year
            <tr><td align=center> 3
                <td align=center> 1-20
                <td> Packet terminator = /END/
            <tr>
            <th colspan=3> /WEEKLY/  packet</th>
            <tr><td align=center> 1
                <td align=center> 1-20
                <td> Packet identifier = /WEEKLY/
            <tr><td align=center> 2+
                <td align=center> 1-5
                <td> Weekly temporal profile code
            <tr><td align=center> &nbsp; 
                <td align=center> 7-9
                <td> Temporal weight for Monday
            <tr><td align=center> &nbsp; 
                <td align=center> 11-13
                <td> Temporal weight for Tuesday
            <tr><td align=center>  &nbsp; 
                <td align=center> ...
                <td> ...
            <tr><td align=center>  &nbsp; 
                <td align=center> 31-33
                <td> Temporal weight for Sunday
            <tr><td align=center>  &nbsp; 
                <td align=center> 35-39
                <td> Total of weights for entire week
            <tr><td align=center> 3
                <td align=center> 1-20
                <td> Packet terminator = /END/
            <tr>
            <th colspan=3> /DIURNAL */ packet</th>
            <tr><td align=center> 1
                <td align=center> 1-20
                <td> Packet identifier = /DIURNAL WEEKDAY/ or /DIURNAL WEEKEND/
            <tr><td align=center> 2+
                <td align=center> 1-5
                <td> Diurnal temporal profile code
            <tr><td align=center> &nbsp; 
                <td align=center> 7-9
                <td> Temporal weight for hour beginning 0000
            <tr><td align=center> &nbsp; 
                <td align=center> 11-13
                <td> Temporal weight for hour beginning 0100
            <tr><td align=center>  &nbsp; 
                <td align=center> ...
                <td> ...
            <tr><td align=center>  &nbsp; 
                <td align=center> 99-101
                <td> Temporal weight for hour beginning 2300
            <tr><td align=center>  &nbsp; 
                <td align=center> 103-105
                <td> Total of weights for entire day
            <tr><td align=center> 3
                <td align=center> 1-20
                <td> Packet terminator = /END/
       </table>
       </DL>
    <p>

    <b>Example:</b>
    <pre>
    /MONTHLY/
        1  83  83  83  83  83  83  83  83  83  83  83  83  996
    /END/
    /WEEKLY/
        1   1   1   1   1   1   0   0    5
        2   0   0   0   0   0   1   1    2
        3   1   1   1   1   1   0   0    5
    /END/
    /DIURNAL WEEKDAY/
        1   0   0   0   0   0   0   0   0   1   1   1   1   1   1   1   1   0   0   0   0   0   0   0   0    8
        2   0   0   0   0   0   0   0   0   1   1   1   1   1   1   1   1   0   0   0   0   0   0   0   0    8
       81 417 417 417 417 417 417 417 417 417 417 417 416 414 415 417 417 417 417 417 417 417 417 417 41510000
       82 388 351 315 299 299 321 348 402 441 456 457 461 457 461 461 460 464 460 456 456 455 453 450 42910000
    /END/
    </pre>
    <p>
    
<HR> 

<H2> <a name="MTREF"> MTREF File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Temporal cross- reference<p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b> <a href= "#TMPMOBIL"> TMPMOBIL</a> program <p>
    <b>Summary:</b>
         
    MTREF is the mobile source  temporal cross-reference file.  It is in the
    same format as the EPS-style temporal cross reference file as described
    below.  The EPS format has been ammended by  permitting specific link IDs
    to be placed in the field that the EPS format reserves for "plant ID" (used
    for point sources only in EPS).  This change in the format permits links to
    be given specific temporal profiles, although the current format allows for
    4-digit links only.   <P>

    
<h3> File Format </h3>

     <b>Same As:</b> EPS2.0 file, Table B-37 of EPS2.0 manual<p>
     <b>Structure:</b> Column specific<p>
        <DL><DT> &nbsp; <DD>
        <table>
            <tr><th> Line <th>Columns <th align=left> Description
            <tr><td align = center> 1+
                <td align = center> 1-5
                <td> State and County FIPS code
            <tr><td align = center> &nbsp; 
                <td align = center> 7-11
                <td> Link ID code (blank or -9 for no link)
            <tr><td align=center>  &nbsp; 
                <td align=center> 21-22
                <td> The letters 'MV'
            <tr><td align=center>  &nbsp; 
                <td align=center> 23-24
		<td> Number of the <a href= "#VehicleTypes"> vehicle type</a>
		(e.g. '01' or '00' for all
            <tr><td align=center>  &nbsp; 
                <td align=center> 25-27
                <td> <a href= "#RoadClasses"> AIRS AMS Road type code</a> (e.g.,
                '110' or '000' for all)
            <tr><td align=center>  &nbsp; 
                <td align=center> 28-30
                <td> <a href= "#EmisProcMode"> Emissions process</a> (e.g.,
                'EXH')
             <tr><td align = center> &nbsp; 
                <td align = center> 32-36
                <td> Pollutant code (five-digit integer) 
             <tr><td align = center> &nbsp; 
                <td align = center> 38-40
                <td> Monthly temporal profile code (to monthly profile in
                MTPRO)
             <tr><td align = center> &nbsp; 
                <td align = center> 42-44
                <td> Weekly temporal profile code (to weekly profile in
                MTPRO)
            <tr><td align = center> &nbsp; 
                <td align = center> 46-48
                <td> Diurnal temporal profile code (to diurnal profile in
                MTPRO)
        </table>
        </DL>
        <p>
        
        <b>Example:</b>
        <p>
        <pre>
        00000        -9     MV00000DNL 00000 1    1    9
        00000        -9     MV00000EVP 00000 1    1    1
        00000        -9     MV00000EXH 00000 1    1    1
        00000        -9     MV00000RNL 00000 1    1    1
        00000        -9     MV00000RST 00000 1    1    1
        17000        -9     MV00000DNL 00000 1    1    9
        17000        -9     MV00000EVP 00000 1    1    2
        17000        -9     MV00000EXH 00000 1    1    2
        17000        -9     MV00000RNL 00000 1    1    2
        17000        -9     MV00000RST 00000 1    1    2
        37000        -9     MV00000DNL 00000 1    1    9
        37000        -9     MV00000EVP 00000 1    1    3
        37000        -9     MV00000EXH 00000 1    1    3
        37000        -9     MV00000RNL 00000 1    1    3
        37000        -9     MV00000RST 00000 1    1    3
        37000        -9     MV00130DNL 00000 1    1    9
        37000        -9     MV00130EVP 00000 1    1    4
        37000        -9     MV00130EXH 00000 1    1    4
        37000        -9     MV00130RNL 00000 1    1    4
        37000        -9     MV00130RST 00000 1    1    4
        37000        -9     MV03150DNL 00000 1    1   10
        37000        -9     MV03150EVP 00000 1    1   11
        37000        -9     MV03150EXH 00000 1    1   11
        37000        -9     MV03150RNL 00000 1    1   11
        37000        -9     MV03150RST 00000 1    1   11
        </pre>

<HR> 

<H2> <a name="MUMAT"> MUMAT File </a></H2>

<H3> Overview</H3>
    <b>Description:</b> Mobile source ungridding matrix<p>
    <b>Sequence:</b>    Intermediate<p>
    <b>Type:</b>        NetCDF<p>
    <b>Origin:</b>      <a href= "#GRDMMAT"> GRDMMAT</a> program<p>
    <b>Used by:</b> <a href= "#PREDIUR"> PREDIUR</a> and
                    <a href= "#TMPMOBIL"> TMPMOBIL</a> programs <p>
                    
    <b>Summary:</b>  The MUMAT ungridding matrix is used to transform grid cell-
    based temperatures to source- based temperatures.  This is necessary in
    order to preserve the source- based processing from which SMOKE derives its
    high performance.  The rows of the matrix correspond to the grid cells.  The
    columns of the matrix correspond to the the sources, and because each grid
    cell intersects only a few source, this matrix is very sparse (has a lot of
    zeroes).  Where a source and grid cell do intersect, the ungridding factor
    is stored in this matrix, along with it's position in the matrix , but the
    zero values are not stored (this is called sparse storage).<p> 

<H3>File Format(s)</H3>
    <b>Structure:</b> Time-independent SMATRX3<p>

    The number of sparse-matrix coefficients (NCOLS3D) is NMATX, defined in  <A
    HREF= "INCLUDES.html#grdims"> GRDIMS3.EXT </A>, and the number of matrix
    rows (NROWS3D) is NMSRC, defined in <a href= "INCLUDES.html#mbdims">
    MBDIMS3.EXT</a>.  MUMAT has one application-supplied variable, the sparse
    matrix coefficient table, in addition to the sparse matrix indexing data
    structures:
    
    <UL>
        <LI>  INTEGER <b>NU( NGRID )</b> -- sparse matrix indexing
              array for the number of active coefficients per row;

        <LI>  INTEGER <b>IU( NMATX )</b> -- sparse matrix indexing
              array listing the set of active columns for all the rows;
              and

        <LI>  REAL <b>MUMAT( NMATX )</b> -- the array of
              active coefficients in the sparse matrix structure.
    </UL>    
<p>

<HR> 

<H2> <a name="MVMTM"> MVMTM File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> VMT mix data<p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b> <a href= "#TMPMOBIL"> TMPMOBIL</a> program <p>
    
    <b>Summary:</b> MVMTM is an ASCII file that contains information on vehicle
    miles traveled (VMT) for all vehicle types. The data are used to break up
    source- specific VMT data to VMT data for each vehicle type.<p>


<H3>File Format(s)</H3>
    <b>Structure:</b> List formatted<p>
    <DL><DT> &nbsp; <DD>
    <table>
        <tr><th> Line <th>Columns <th align=left>Description
        <tr><td> 1+<td> A<td> Year of data
        <tr><td> &nbsp;  <td> B<td> State and County FIPS code
        <tr><td> &nbsp; <td> C<td> <a href="#RoadClasses"> AIRS AMS Road type code </a>
        <tr><td>  &nbsp;  <td> D<td> Link ID number
        <tr><td>  &nbsp;  <td> E<td> Percentage of total VMT from gas vehicles
        <tr><td>  &nbsp;  <td> F<td> Percentage of total VMT from light duty gas
        trucks 1
        <tr><td> &nbsp;   <td> G<td> Percentage of total VMT from light duty gas
        trucks 2
        <tr><td>  &nbsp;  <td> H<td> Percentage of total VMT from heavy duty gas
        vehicles
        <tr><td>  &nbsp;  <td> I<td> Percentage of total VMT from light duty diesel
        vehicles
        <tr><td>  &nbsp;  <td> J<td> Percentage of total VMT from heavy duty diesel
        trucks
        <tr><td>  &nbsp;  <td> K<td> Percentage of total VMT from heavy duty diesel
        vehicles
        <tr><td>  &nbsp;  <td> L<td> Percentage of total VMT from motorcycles
 
    </table>
    </DL>

    <b>Example:</b><p>
 
    <DL><DT> &nbsp; <DD>
    This examples shows the VMT Mix for ultimate default and for Appling County
    Georgia (FIPS code 13001) for all road classes in that county.<p>
    <PRE>
1995 00000 000  0 0.743 0.134 0.068 0.013 0.009 0.001 0.028 0.004
1995 13001 110  0 0.646 0.161 0.081 0.025 0.008 0.002 0.073 0.004
1995 13001 130  0 0.648 0.160 0.081 0.024 0.008 0.002 0.072 0.004
1995 13001 150  0 0.648 0.160 0.081 0.024 0.008 0.002 0.072 0.004
1995 13001 170  0 0.648 0.160 0.081 0.024 0.008 0.002 0.072 0.004
1995 13001 190  0 0.648 0.160 0.081 0.024 0.008 0.002 0.072 0.004
1995 13001 210  0 0.664 0.141 0.081 0.025 0.008 0.002 0.074 0.005
1995 13001 230  0 0.743 0.134 0.068 0.013 0.009 0.002 0.028 0.003
1995 13001 250  0 0.741 0.133 0.070 0.012 0.010 0.003 0.029 0.003
1995 13001 270  0 0.742 0.134 0.068 0.013 0.009 0.001 0.028 0.004
1995 13001 290  0 0.717 0.147 0.075 0.015 0.010 0.002 0.031 0.004
1995 13001 310  0 0.748 0.135 0.061 0.014 0.009 0.001 0.029 0.003
1995 13001 330  0 0.748 0.135 0.061 0.013 0.009 0.001 0.029 0.004

    </PRE>
    </DL>


<HR> 

<H2> <a name="SPCS"> SPCS File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Generalized speciation file <p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        ASCII<p>
    <b>Origin:</b>      User preparation<p>
    <b>Used by:</b>    <a href= "#SPCMMAT"> SPCMMAT</a>,
                       <a href= "#TMPMOBIL"> TMPMOBIL</a>.
                       <a href= "QA.html#CSGMOBIL"> CSGMOBIL</a> programs<p>
    <b>Summary:</b>      
SPCS is an ASCII file that can be used to control the inventory pollutants,
model species, and mobile emission processes run through SMOKE.
<P>
<b> Currently, this file is used only by the motor-vehicle processors,
         but will be used by point and area sources in the near future</b>
<P>
The format of the file is the following.  Each line has several entries, each
corresponding to a model species.  All character entries must be 
enclosed in quotes.
<P>
<PRE>
"INV", "MODEL", NP, "EMMPRC( 1 )", "EMPRC( 2 )", ... "EMPRC( NP )"
</PRE>

<b>INV</b> The inventory species associated with MODEL, for example 
                     "NOX"
<P>
<b>MODEL</b> The model species name, for example "NO2"
<P>
<b>NP</b> The number of motor-vehicle emission processes associated
                     with the model species
<P>
<b>EMMPRC</b> The emission processes, for example "EXH"
<P>
This file is read using the subroutine CSVNAME, which ensure that no
matter what order the entries are given, the program that calls CSVNAME
will receive the names in the order that SMOKE recognizes them.  SMOKE 
keeps a list of valid inventory pollutants, model species , emission
processes, and emission modes in the INCLUDE file 
<A HREF="INCLUDES.html#mbdims"> MBDIMS3.EXT</A>.
<P>

The following is a sample SPCS file. Note that the first line of the file
is a header line.  This header line is required.

<PRE>
Matched inventory species, model species, and mv processes
'CO '  'CO  ' 1  'EXH'
'NOX'  'NO  ' 1  'EXH'
'NOX'  'NO2 ' 1  'EXH'
'VOC'  'PAR ' 5  'EVP' 'EXH' 'RST' 'RNL' 'DNL'
'VOC'  'OLE ' 5  'EVP' 'EXH' 'RST' 'RNL' 'DNL'
'VOC'  'TOL ' 5  'EVP' 'EXH' 'RST' 'RNL' 'DNL'
'VOC'  'XYL ' 5  'EVP' 'EXH' 'RST' 'RNL' 'DNL'
'VOC'  'FORM' 5  'EVP' 'EXH' 'RST' 'RNL' 'DNL'
'VOC'  'ALD2' 5  'EVP' 'EXH' 'RST' 'RNL' 'DNL'
'VOC'  'ETOH' 5  'EVP' 'EXH' 'RST' 'RNL' 'DNL'
'VOC'  'ETH ' 5  'EVP' 'EXH' 'RST' 'RNL' 'DNL'
'VOC'  'ISOP' 5  'EVP' 'EXH' 'RST' 'RNL' 'DNL'
'VOC'  'MEOH' 5  'EVP' 'EXH' 'RST' 'RNL' 'DNL'
</PRE>

<P>

<HR> 

<H2> <a name="TKDAT"> TKDAT File</a></H2>

<H3> Overview</H3>
    <b>Description:</b> Gridded, hourly temperatures from meteorology model<p>
    <b>Sequence:</b>    Input<p>
    <b>Type:</b>        NetCDF<p>
    <b>Origin:</b>      Meteorology model format converter MCIP or <a href=
    "UTILS.html#FAKETEMP"> FAKETEMP</a><p>
    <b>Used by:</b>    <A HREF="#PREDIUR"> PREDIUR</A> and <a href= "#TMPMOBIL">
                       TMPMOBIL</a> programs<p>

    <b>Summary:</b>  The TKDAT file is a meteorology file that contains the
    temperature variable  <b>TA</b>.  This file can be the "Met 3D cross-point
    file" directly from the MCIP processor, or it can be an extraction from such
    a file using the utilities <b>m3xtract</b>, <b>m3wndw</b>,  <b>m3tshift</b>,
    or  <b>m3tproc</b>.  It can also be generated with the SMOKE utility <a
    href= "UTILS.html#FAKETEMP"> FAKETEMP</a>, which allows state-specific
    temperatures, uniform temperatures (time dependent or not), and cell by cell
    temperature adjustments of an existing temperature file.

<P>
<HR>

<b>The remainder of this chapter contains the documentation for the optional
files used by EMISFAC.  These files are used only if the table-based input type
is used in the <a href= "#MPREF"> MPREF</a> file.  </b>


<HR>
<P>
<H2> <a name="MACUM"> MACUM File</a></H2>

<H3> Overview</H3>
    <b>Description:</b>Mileage accumulation rates profiles file <p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented <P>    

The MOBILE5a manual (May 1994) states the following: 

<p>
<blockquote>
     MOBILE5's emission factor calculations rely in part on travel fractions 
     for vehicles of each given age and type, which in turn are based on
     estimates of the average annual mileage accumulation by age (first year 
     to 25th-and-greater years of operation) for each of the eight <A HREF="#VehicleTypes"> 
     vehicle types </A> ..., except motorcycles, for which
     annual mileage accumulation rates ... are only provided 
     for the first 20 the 12th-and-later years of operation (ages 0-1 to 11-12+).
</blockquote>

<p>

The use of MOBILE5 default mileage accumulation rates is recommended, however,
this file  provides a means of specifying non-default mileage accumulation rates
via the <A HREF = "#MPLIST"> MPLIST </A> and <A HREF = "#MPREF"> MPREF </A>
files. <p>

<H3>File Format(s)</H3>

Each entry of MACUM has an integer profile number, IACCUM, and 200 real entries 
specifying the estimated annual mileage accumulated by vehicles of each of the
eight types for each of 25 ages (except 12 ages for motorcycles, use 0.0 to fill
out entries 188 through 200).  <b>  These values are input in units of 100,000
miles </b> (e.g., 12,637 miles is input as 0.12637 ). <p>  MOBILE5a uses the
first 5 decimal places, so additional accuracy in the input data is not
necessary.<p>

All reads of this file are list formatted, so the entries need only be in the correct order, 
and delimited by a space, comma, or tab.  Entries may be continued on subsequent lines, 
without additional formatting requirements. <p>

<H3> Notes </H3>
<ul>
    <li> For QA, pg 2-24 of Mobile documentation describes how accumulation rates cannot
         be inconsistent with registration distributions </li>
</ul>


<P>
<HR> 
<H2> <a name="MAVSPD"> MAVSPD File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Average speeds profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented<p>
    
<H3>File Format(s)</H3>

<P>
<HR> 
<H2> <a name="MBSEXH"> MBSEXH File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Basic exhaust emissions rates profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> Implemented<p>
    
<H3>File Format(s)</H3>

<P>
<HR> 
<H2> <a name="MCTOFF"> MCTOFF File</a></H2>
    <b>Description:</b> I/M transient cutoffs profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> Implemented<p>

<H3>File Format(s)</H3>

<P>
<HR> 
<H2> <a name="MDLSF"> MDLSF File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Diesel fuels sales fractions profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented<p>
<H3>File Format(s)</H3>

Each record in MDLSF has an integer profile number, NDIESL, a year
for which the sales fractions apply, and 25 groups
of 2 real entries, one each for Light Duty Vehicles (LDV) and Light 
Duty Trucks (LDT).  The entries need to be delimited in some way, as
all reads of this file are list formatted. <p>

The diesel sales fractions are the fractions of the LDV and LDT fleets for
a given year which used diesel fuel instead of gasoline.  The data are
required for each 
vehicle model year for 25 years inclusive of the modeling year (which is the
same as the year associated with the file).  For example, the
3rd and 4th real entries are associated with the vehicle model year equal to 
the modeling year minus 1.  The 49th and 50th real entries, however, 
are associated with vehicles with model years of 24 years less than 
the modeling year <em> as well as </em> all prior vehicle model years.

<P>
<HR> 
<H2> <a name="MEFATP"> MEFATP File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Anti-tampering programs profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemetned<p>
    
<H3>File Format(s)</H3>

Each record in the MEFATP file requires an integer profile number, IATP, and
18 integer entries.  Each of these is described below:

<ol>
    <li>Profile numner, IATP</li>
    <li>Program start year (60-99, 00-20) </li>
    <li>First (earliest) model year of vehicles
        subject to the requirements of the program (60-99, 00-20) </li>
    <li>Last( most recent) model year of vehicles 
        subject to the requirements of the program (60-99, 00-20) </li>
    <li>LDGV subject to inspection? (1=no; 2=yes)</li>
    <li>LDGT1 subject to inspection? (1=no; 2=yes)</li>
    <li>LDGT2 subject to inspection? (1=no; 2=yes)</li>
    <li>LDGV subject to inspection? (1=no; 2=yes)</li>
    <li>Program type</li>
        <ul>
           <li>1=Test only</li>
           <li>2=Test and repair</li>
        </ul>
    <li>Inspection frequency</li>
        <ul>
           <li>1=Annual</li>
           <li>2=Biennial</li>
        </ul>
    <li>Compliance rate ( percent from 0 to 100 ) </li>
    <li><b>Air pump system</b> inspection performed? (1=no; 2=yes) </li>
    <li><b>Catalyst inspection</b> performed? (1=no; 2=yes)</li>
    <li><b>Fuel inlet restrictor</b> inspection performed? (1=no; 2=yes)</li>
    <li><b>Tailpipe lead deposit test</b> inspection performed? (1=no; 2=yes)</li>
    <li><b>Exhaust gas recirculation (EGR) system</b> inspection performed? (1=no; 2=yes)</li>
    <li><b>Evaporative emissions control system</b> inspection performed? (1=no; 2=yes)</li>
    <li><b>Positive crankcase ventilation (PCV) system</b> inspection performed? (1=no; 2=yes)</li>
    <li><b>Gas cap</b> inspection performed? (1=no; 2=yes)</li>
</ol>

All reads of this file are list formatted, therefore, the entries need only
be delimited with a space, comma, or tab.  Although the format is similar
to that of MOBILE5a, <b>ALL</b> entries must be delimited, 
and the compliance rate comes after the eight flags for inspection types.
<P>
<H3>QA Concerns </H3>
<ul>
    <li>MOBILE5 requires the test type for I/M programs and ATP/press/purg
        to be the same.  This is a bit strange since I/M has 3 test types and
        ATP,etc. have only 2.  Furthermore, when an error is made,
        the resulting wanring message is inaccurate. </li>
</ul>
For additional information, see section 2.2.6 of the MOBILE5a user's manual.

<p>
<HR> 
<H2> <a name="MEFIM"> MEFIM File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Inspection and maintenance programs effects profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented<p>
All reads of this file are list formatted, so entries on each record need only to
be delimited with a space, and comma, or a tab. <p>

Implementing an Inspection and maintanence in Mobile requires up to 2 files.
Files for alternative I/M credits for both Tech I-II and Tech IV+ if 
certain options are set in the I/M record.  <p>

For the SMOKE formulation, these record options would possibly be located in
the file which contains a list of various I/M programs.  Thus, the question
of whether a file is required or not, and which file is needed, is 
embedded into the list of I/M plans.  Furthermore, since the I/M plan can 
vary in a regional domain, the required file can vary as well. <p>

See also the G4 and G5 entries in the <A HREF="#MPREF"> MPREF </A> file.
    
<H3>File Format(s)</H3>

Each record in this file has 17 entries, all integers:
<ol>
   <li>Profile number, IEFIM </li>
   <li>Program year start (60-99, 00-20) </li>
   <li>Stringency level (percent from 10 to 50) </li>
   <li>First model year (41-99, 00-20) </li>
   <li>Last model year (41-99, 00-20) </li>
   <li>Waiver rate for pre-1981 model year vehicles (percent from 0 to 50)</li>
   <li>Waiver rate for 1981 and later model year vehicles (percent from 0 to 50)
       </li>
   <li>Compliance rate (percent from 0 to 100) </li>
   <li>Program type</li>
       <ul>
           <li>1=Test only</li>
           <li>2=Test and repair (computerized)</li>
           <li>3=Test and repair (manual)</li>
       </ul>
   <li>Inspection frequency</li>
       <ul>
           <li>1=annual</li>
           <li>2=biennial</li>
       </ul>
   <li>LDGV subject to inspection? (1=no; 2=yes) </li>
   <li>LDGT1 subject to inspection? (1=no; 2=yes) </li>
   <li>LDGT2 subject to inspection? (1=no; 2=yes) </li>
   <li>HDGV subject to inspection? (1=no; 2=yes) </li>
   <li>Test type specifier:</li>
       <ul>
           <li>1 = Idle test</li>
           <li>2 = 2500/Idle test</li>
           <li>3 = Loaded Idle test</li>
           <li>4 = Transient (IM240) test</li>
       </ul>
   <li>Cutpoints index:<br> 
       This is a non-negative number which indicates the index of the cutpoints
       profile which should be used.  For test type 4, this entry <b>
       must </b> be a positive number.  For test types 1 and 2, this
       entry <b> must </b> be zero, unless non-default files are
       given for I/M credits (see G4 and G5) in <A HREF="#MPREF">MPREF</A>
       </li>
   <li>Tampering rates profile index to use when non-default tampering rates 
       are used (see F3 on <A HREF="#MPREF"> MPREF </A>) </li> 

</ol>

<P>
<HR> 
<H2> <a name="MEFLEV"> MEFLEV File</a></H2>
<H3> Overview</H3>
    <b>Description:</b>Low Emissions Vehicles program effects profiles file <p>
    <b>Sequence:</b> <p>
    <b>Type:</b> <p>
    <b>Origin:</b> <p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    
<b> NOT implemented in EMISFAC </b>

<P>
<HR> 
<H2> <a name="MEFRFL"> MEFRFL File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Refueling controls parametes profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation <p>
    <b>Used by:</b><a href= "#EMISFAC"> EMISFAC</a>  program<p>
    <b>Summary:</b> <p>
    
<b> NOT implemented in EMISFAC </b>

<P>
<HR> 
<H2> <a name="MLAPMO"> MLAPMO File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> LAP/month profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented</p>
    
The LAP/month profile file permits the specification of two inter-related  MOBILE5 
inputs: the "Local Area Parameter record" and the month of emission factor evaluation.
Although these parameters are not specified using the same record in a MOBIL5 input 
file, they are very much related, because the month selected affects how
reformulated gas is modeled.  Furthermore, the appropriate values of Reid's
vapor pressure differ depending on the selected month.  These issues are 
described in greater detail below, and references to the MOBILE5 manual are 
given where appropriate. <p>

<H3>File Format(s)</H3>

Each record in the file contains 8 eight entries:

<ol>
   <li>Profile number, ILAPMO </li>
   <li>Month number: has two possible values, 1 or 7</li>
       <ul>
           <li>Enter <b>1</b> for emission factors calculated using a fleet
               composition from the first half of the year, and winter season 
               reformulated gas rules.</li>
           <li>Enter <b>2</b> for emission factors calculated using a fleet
               composition from the second half of the year, and summer season 
               reformulated gas rules.</li>
           <li>Note that the value of month is independent of temperature, fuel
               volatility, and other inputs, which still must be
               selected by the user in a way that is consistent with the intended 
               application of the emission factors.</li>
       </ul>
   <li>Enter 0 for no oxygenated fuels program, and a positive number to indicate
       the oxygenated fuels profile from <A HREF="#MOXYF"> MOXYF</A>
       to implement</li>
   <li>Enter 0 for no reformulated gas program, and a 1 to implement a 
       reformulated gas program.  Note that the month number (above) will dictate how this
       reformulated gas program will be modeled</li>
   <li>Fuel volatility class </li>
       <ul>
           <li>If a reformulated gas program is to be modeled, a letter A through E
               must be specified here.  See section 2.2.10 of the MOBILE5 manual for
               additional information.</li>
           <li>For no reformulated gas program, a letter N should be used.
       </ul>
   <li>"Period 1" Reid's Vapor Pressure.  This value can be between 7.0 and 15.2 psi
       inclusive, but refer to section 2.2.12 of the MOBILE5 manual for more 
       information.</li>
   <li>"Period 2" Reid's Vapor Pressure.  This value can be between 6.5 and 
       15.2 psi inclusive, but refer to section 2.2.13 of the MOBILE5 manual 
       for more information.</li>
   <li>"Period 2" Start year.  This year can be greater than or equal to 1989, 
       but refer to section 2.2.13 of the MOBILE5 manual for more
       information.</li> 
</ol> 
<p> 
All reads this file are list formatted, so records must only be 
in the correct order, and delimited by a space, comma, or tab.

<H3> QA Concerns </H3>
<ul>
    <li>Check Reid's vapor pressure values and year given month specified.</li>
    <li>Ensure fuel volatility is set when RFG program requested.</li>
</ul>

<P>
<HR> 
<H2> <a name="MLOAD"> MLOAD File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> A/C usage, extra loading, trailer, humidity effects profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented<p>
    
<H3>File Format(s)</H3>

<P>
<HR> 
<H2> <a name="MNEVAP"> MNEVAP File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> New evaporative emissions tests profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    
<b> NOT implemented in EMISFAC </b> <p>

According to the MOBILE5 manual, the necessity of implementing alternative 
evaporative emissions test profiles with MOBILE5 was eliminated
with the release of MOBILE5a.  For this reason, until the need arises,
the ability to specify alternate evaporative emissions test profiles
will not be supported by <A HREF="#EMISFAC"> EMISFAC</A>.

<P>
<HR> 
<H2> <a name="MOPMOD"> MOPMOD File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Operating modes profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented<p>
    
<H3>File Format(s)</H3>

<P>
<HR> 
<H2> <a name="MOXYF"> MOXYF File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Oxygenated fuels parameters profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program <p>
    <b>Summary:</b> <p>
    Implemented<p>
    
<H3>File Format(s)</H3>

Each record in MOXYF has an integer profile number, NOXYGF, and 5 additional
entries.  These five entries are:

<ul>
    <li>Enther blend market share</li>
    <li>Alcohol blend market share</li>
    <li>Average oxygen content of ether blend fuels (% wieght, expressed as
        fraction)</li>
    <li>Average oxygen content of alcohol blend fuels (% wieght, expressed as
        fraction)</li>
    <li>RVP waiver switch [integer value indicating whether alcohol-based 
        oxygenated fuels must meet the same RVP limit as straight gasoline
        (value=1), or have been granted a 1.0 psi waiver (value=2)]</li>
</ul>
For addtional information, refer to the MOBILE5a reference manual, section 
2.3.9.
<P>

<HR> 
<H2> <a name="MPREST"> MPREST File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Functional pressure test profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented<p>
    
<H3>File Format(s)</H3>

Each record in the MPREST file requires an integer profile number, IPREST, 
and 10 integer entries.  Each of these is described below:
 
<ol>
    <li>Profile numner, IPREST</li>
    <li>Program start year (60-99, 00-20) </li>
    <li>First (earliest) model year of vehicles
        subject to the requirements of the program (60-99, 00-20)</li>
    <li>Last( most recent) model year of vehicles
        subject to the requirements of the program (60-99, 00-20)</li>
    <li>LDGV subject to inspection? (1=no; 2=yes)</li>
    <li>LDGT1 subject to inspection? (1=no; 2=yes)</li>
    <li>LDGT2 subject to inspection? (1=no; 2=yes)</li>
    <li>LDGV subject to inspection? (1=no; 2=yes)</li>
    <li>Program type</li>
        <ul>
           <li>1=Test only</li>
           <li>2=Test and repair</li>
        </ul>
    <li>Inspection frequency</li>
        <ul>
           <li>1=Annual</li>
           <li>2=Biennial</li>
        </ul>
    <li>Compliance rate (percent from 0 to 100) </li>
</ol>
 
All reads of this file are list formatted, therefore, the entries need only
be delimited with a space, comma, or tab.  Although the format is similar
to that of MOBILE5a, <b>ALL</b> entries must be delimited.

<P>
<HR> 
<H2> <a name="MPURGT"> MPURGT File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Functional purge test profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b><a href= "#EMISFAC"> EMISFAC</a> program <p>
    <b>Summary:</b> <p>
    Implemented<p>
    
<H3>File Format(s)</H3>
Each record in the MPURGT file requires an integer profile number, IPURGT, and
10 integer entries.  Each of these is described below:
 
<ol>
    <li>Profile numner, IPURGT</li>
    <li>Program start year (60-99, 00-20) </li>
    <li>First (earliest) model year of vehicles
        subject to the requirements of the program (60-99, 00-20)</li>
    <li>Last( most recent) model year of vehicles (60-99, 00-20)
        subject to the requirements of the program</li>
    <li>LDGV subject to inspection? (1=no; 2=yes)</li>
    <li>LDGT1 subject to inspection? (1=no; 2=yes)</li>
    <li>LDGT2 subject to inspection? (1=no; 2=yes)</li>
    <li>LDGV subject to inspection? (1=no; 2=yes)</li>
    <li>Program type</li>
        <ul>
           <li>1=Test only</li>
           <li>2=Test and repair</li>
        </ul>
    <li>Inspection frequency</li>
        <ul>
           <li>1=Annual</li>
           <li>2=Biennial</li>
        </ul>
    <li>Compliance rate (percent from 0 to 100) </li>
</ol>
 
All reads of this file are list formatted, therefore, the entries need only
be delimited with a space, comma, or tab.  Although the format is similar
to that of MOBILE5a, <b>ALL</b> entries must be delimited.

<P>
<HR> 
<H2> <a name="MRGDS"> MRGDS File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Registration distributions profiles file<p>
    <b>Sequence:</b> Optional input <p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented<p>
    
The MOBILE5a manual (May 1994) states the following: 

<p>
<blockquote>
     MOBILE5's emission factor calculations rely in part on travel fractions 
     for vehicles of each given age and type, which in turn are based on
     estimates of ... the registration istribution by age (first year 
     to 25th-and-greater years of operation) for each of the eight <A HREF="#VehicleTypes"> 
     vehicle types </A>, except motorcycles, for which ... registration 
     distributions are only provided 
     for the first 20 the 12th-and-later years of operation (ages 0-1 to 11-12+).
</blockquote>

<p>
The use of non-default registration distributions is appropriate for cases where
these data reflect significant differences from the national average, on which the
MOBILE5 defaults are based.  This file 
provides a means of specifying non-default registration distributions via
the <A HREF = "#MPLIST"> MPLIST </A> and <A HREF = "#MPREF"> MPREF </A> files. <p>

<H3>File Format(s)</H3>
 
Each entry of MRGDS has an integer profile number, IRDIST, followed by 200 real values.

As stated in the MOBILE5 manual, 
for each <A HREF="#VehicleTypes">vehicle type </A>, a set of 25 values (except 12 values for
motorcycles, with zeroes filling out entries 188 through 200) are required to 
represent the fraction of all vehicles for the given type and age.  The sum of the 
registration distribution values for a given vehicle type must equal 1.0; of they
do not, MOBILE5 normalizes the input values so that the sum for each vehicle type is
equal to 1.0, and a warning message is issued for each occurence.  Furthermore, MOBILE5
uses only 3 decimal places of accuracy, so additional accuracy in the input data is
not used.
<p>
As stated in the MOBILE5 manual, the same registration distributions by age must be 
entered for LDGVs and LDDVs, and for LDGTs and LDDTs.  MOBILE5 uses an internal function
to separate there pairs of vehicle types into distinct gas and diesel distributions,
based on deisel sales fraction by model year. A non-default diesel sales fraction can be
specified in the profile file <A HREF="#MDLSF"> MDLSF </A>.
<p>

All reads of this file are list formatted, so the entries need only be in the correct order, 
and delimited by a space, comma, or tab.  Entries may be continued on subsequent lines, 
without additional formatting requirements. <p>

<H3> QA Concerns</H3>
<ul>
    <li> Registration distributions must be consisent with non-default mileage accumulation
         rates </li>
    <li> Make sure same RDs are entered for LDGVs and LDDVs, and for LDGTs and LDDTs</li>
    <li> Make sure the RDs for each vehicle type sum to 1 </li>
</ul>

<P>
<HR> 
<H2> <a name="MTLEN"> MTLEN File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Trip length distribution profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented<p>
    
As described in section 2.3.12 of the MOBILE5 manual, "trip length" refers to 
the duration of the trip (how long the vehicle has been traveling), <b> not 
</b> the distance traveled in the trip (how far the vehicle has been driven).
Test data show that for any given set of conditions (speed, ambient temperature, 
and fuel volatility), running loss emissions are zero to neglible at first, 
but increase significantly as the duration of the trip is extended and the fuel
tank, fuel lines, and engine become heated. <p>

This file, as referenced by the parameter-scheme cross-reference file <A HREF=
"#MPREF">  MPREF</A>, provide a means of specifying alternate trip length 
distributions.  User-specified trip length distributions can only be specified
when a single average speed is specified, not a speed for each vehicle class,
as in the <A HREF="#MAVSPD">  MAVSPD</A> file.  For this reason, an average
speed is requested in each trip length distribution record, and this speed value
overides any average speed distribution specified using 
<A HREF="#MAVSPD">  MAVSPD </A>.  A message warning is given from EMISFAC
to this affect when this situation occurs.  A correct parameter scheme, however,
will not have F5 and F7 both greater than zero. <p>

<H3>File Format(s)</H3>

Each record in the file contains 8 entries:

<ol>
    <li>Profile number, ITPLEN</li>
    <li>Average speed for all trip lengths</li> <P>
    The remaining six entries contain the percentage of a source's total VMT being
    accumulated in trips of the following lengths:

    <li>Under 10 minutes </li>
    <li>11 to 20 minutes </li>
    <li>21 to 30 minutes </li>
    <li>31 to 40 minutes </li>
    <li>41 to 50 minutes </li>
    <li>51 minutes and longer </li>
</ol>

See section 2.3.12 of the MOBILE5a manual for additional guidance on specification
of alternate trip length distributions.
<p>
<H3>QA Concerns </H3>
<ul>
    <li>MOBILE5 has a specific allowable range of speeds </li>

</ul>

<P>
<HR> 
<H2> <a name="MTRATE"> MTRATE File</a></H2>
<H3> Overview</H3>
    <b>Description:</b> Tampering rates profiles file<p>
    <b>Sequence:</b> Optional input<p>
    <b>Type:</b> ASCII<p>
    <b>Origin:</b> User preparation<p>
    <b>Used by:</b> <a href= "#EMISFAC"> EMISFAC</a> program<p>
    <b>Summary:</b> <p>
    Implemented<p>
    
Each entry of MTRATE has an integer profile number, ITAMRT, 96 real entries 
for zero-mile level (ZML), and 96 real entries for deterioration rate (DR). 
The entries need not follow a specific format, as the reads of this file are 
list formatted.<p>

ZML and DR are real numbers between 0 and 1.0.  ZML is a zero-mile level 
tampering rate.  A value of 0.0 indicates 0 percent of the cars for the
given model-year group and vehicle type have the given kind of tampering
a mile 0.  DR is the rate of increase in the tampering rate per 10,000 miles 
accumulated mileage.  A value of 0.1 indicates that 10 percent more vehicles 
in a group (more than the percentage given by the ZML) have the 
tampering after 10,000 miles. <P>

<H3>File Format(s)</H3>

The integer ITAMRT is pointed to by the F3 entry in 
<A HREF = "#MPREF"> MPREF </A>.  The variables for ZML and DR have
96 entries because there are values for 3 model-year groups, 4 vehicle types, 
and 8 kinds of tampering.  In MTRATE, the 8 kinds of tampering should cycle 
fastest, the 4 vehicle types next fastest, and the 3 model-year groups 
should cycle slowest.  These categories have the following 
attributes and orders:<p>

<ul> 
    <li>Model year groups</li>
       <ol> 
           <li>Pre-1981 model year</li>
           <li>1981-1983 model year </li>
           <li>1984+ model year </li>
       </ol> 
    <li>Vehicle type</li>
       <ol> 
           <li>Light duty gasoline vehicles, LDGV</li>
           <li>Light duty gasoline trucks 1, LDGT1</li>
           <li>Light duty gasoline trucks 2, LDGT2</li>
           <li>Heavy duty gasoline vehicles, HDGV</li>
       </ol> 
    <li>Kinds of tampering</li>
       <ol> 
           <li>Air pump disablement</li>
           <li>Catalyst removal</li>
           <li>Fuel inlet restrictor disablement</li>
           <li>Overall misfueling</li>
           <li>Exhaust Gas Recirculation (EGR) system disablement</li>
           <li>Evaporative control system disablement</li>
           <li>Positive Cracnkcase Ventilation (PCV) system disablement</li>
           <li>Missing gas cap</li>
       </ol> 
</ul> 

<H3> Notes </H3><p>
<ol>
   <li>Interaction with I/M program.  Get a tampering rates profile code 
       from the I/M profile when I/M program is modeled. </li>
   <li>Also see MOBILE5a documentation p. 2-20</li>

</ol>
<p>

<HR> 

<A HREF = "POINT.html">    
<b>Previous:</b>  Point Source Emissions</A>
<P> 

<A HREF = "BIOGENIC.html"> 
<b>Next:</b>      Biogenic Source Emissions </A>
<P> 

<A HREF = "index.html#models">  
<b>Up:</b>  Models  -- Area, Point, Biogenic, Mobile </A>
<P> 

<A HREF = "index.html"> 
<b>Top:</b>  SMOKE Root Document  </A>
<P> 


</BODY> 
</HTML> 

