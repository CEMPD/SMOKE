<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Chapter 2</title>
</head>

<body>

<h1><a name="Chapter_2_SMOKE_concepts"></a><span style="color:black">Chapter
2. SMOKE concepts<o:p>
</o:p>
</span></h1>
<h2><span style="color:black">Contents<o:p>
</o:p>
</span></h2>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#Introduction">Introd<span style="mso-bookmark:
_Hlt482175955">u</span>ction</a><a name="_Hlt482175955"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#Formulation">Sparse <span style="mso-bookmark:
_Hlt482175958">m</span><span style="mso-bookmark:_Hlt482180801">a</span>trix
formulation of emiss<span style="mso-bookmark:_Hlt482180787">i</span>ons
modeling</a><a name="_Hlt482180787"></a><a name="_Hlt482180801"></a><a name="_Hlt482175958"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#data_structuring">Data <span style="mso-bookmark:_Hlt482181052">s</span>t<span style="mso-bookmark:_Hlt482181069">r</span>ucturing</a><a name="_Hlt482181069"></a><a name="_Hlt482181052"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#future_past">Futur<span style="mso-bookmark:
_Hlt482181055">e</span>-pa<span style="mso-bookmark:_Hlt482181073">s</span>t
projection</a><a name="_Hlt482181073"></a><a name="_Hlt482181055"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#temporal">Temporal p<span style="mso-bookmark:
_Hlt482181074">r</span>ocessing</a><a name="_Hlt482181074"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#speciation">Chemical s<span style="mso-bookmark:
_Hlt482181076">p</span>eciation processing</a><a name="_Hlt482181076"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#gridding">Spatial proce<span style="mso-bookmark:_Hlt482181078">s</span>sing</a><a name="_Hlt482181078"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#control">Control proc<span style="mso-bookmark:
_Hlt482181080">e</span>ssing</a><a name="_Hlt482181080"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#merge">E<span style="mso-bookmark:_Hlt482331841">m</span>issions
tran<span style="mso-bookmark:_Hlt482181082">s</span>form</a><a name="_Hlt482181082"></a><a name="_Hlt482331841"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#processing_exceptions">Proc<span style="mso-bookmark:_Hlt482181106">e</span>ssi<span style="mso-bookmark:_Hlt482331845">n</span>g<span style="mso-bookmark:_Hlt482331737">
</span>exceptions</a><a name="_Hlt482331737"></a><a name="_Hlt482331845"></a><a name="_Hlt482181106"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#reactivity_controls">Reac<span style="mso-bookmark:_Hlt482181109">t</span>ivity
contr<span style="mso-bookmark:
_Hlt482180530">o</span>ls</a><a name="_Hlt482180530"></a><a name="_Hlt482181109"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#xrefs_and_profiles">Cross-re<span style="mso-bookmark:_Hlt482180669">f</span>er<span style="mso-bookmark:_Hlt482181085">e</span><span style="mso-bookmark:_Hlt482332951">n</span>ces
an<span style="mso-bookmark:
_Hlt482180622">d</span> profiles</a><a name="_Hlt482180622"></a><a name="_Hlt482332951"></a><a name="_Hlt482181085"></a><a name="_Hlt482180669"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#file_formats">File for<span style="mso-bookmark:
_Hlt482341671">m</span>ats</a><a name="_Hlt482341671"></a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#environment_variables">Environment variables</a></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#logical_file_names">Logical file names</a></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1026" style='position:absolute;
 z-index:1' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:0;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_2.gif" v:shapes="_x0000_s1026" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="Introduction"></a><span style="color:black">Introduction<o:p>
</o:p>
</span></h2>
<p class="MsoNormal">The paradigm for atmospheric emissions models prior to
SMOKE was a network-of-pipes-and-filters. This means that at any given stage in
the processing, an emissions file must be a self-contained record describing
each source and all of the attributes acquired from previous processing stages.
Each processing stage is a filter that inputs a stream of these self-defined
records, combines it with data from one or more auxiliary files, and produces a
new stream of these records. Redundant data are passed down the pipe at the cost
of extra input/output (I/O), storage, data processing, and program complexity.
Using this method, all processing is performed one record at a time, without
structure or order to the records.</p>
<p class="MsoNormal">This old paradigm came about as a way to avoid repeatedly
searching through unindexed Fortran data files for needed information, which
would be very inefficient. It is admirably suited to older computer
architectures with very small available memories and tape-only storage, but is
not suitable for current desktop machines or high performance computers. SMOKE
developers demonstrated this when EPS 2.0 was run on a Cray Y-MP. It ran four
times slower on the Cray machine (a much faster computer) than on a desktop
150MHZ DEC Alphastation 3000/300.</p>
<p class="MsoNormal">The paradigm implemented in SMOKE came about from analysis
indicating that emissions computations should be admirably adaptable to high
performance computing if the paradigm is appropriately changed. For each
category of emissions (i.e., area, biogenic, mobile, and point sources), the
following tasks are performed by an emissions processor:</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>read emissions inventory data files;</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>optionally project emissions from the inventory year to the
(future or past) modeled year (except biogenic sources);</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>transform inventory species into chemical mechanism species
defined by an air quality model;</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>optionally apply controls (except for biogenic sources);</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>model the temporal distribution of the emissions, including any
meteorology effects;</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>model the spatial distribution of the emissions; and</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>merge the various source categories of emissions to form input
files for the air quality model.</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>perform quality assurance on the input data and results;</p>
<p class="MsoNormal">Each type of emissions has its particular complexities. For
all of these types, however, most of the tasks are <em>factor-based</em> -- that
is, they are linear operations that can be represented as multiplication by
matrices. Further examination revealed that some of the matrices are <strong><i style="mso-bidi-font-style:normal"><span style="font-weight:normal">sparse</span></i></strong>
matrices (i.e., most of their entries are zeros). SMOKE is designed to take
advantage of these facts by formulating emissions modeling in terms of sparse
matrix operations, which can be performed by optimized sparse matrix libraries.</p>
<p class="MsoNormal">Because matrix multiplication is associative (i.e., can be
regrouped), SMOKE developers further rearranged the order of multiplication
operations to avoid redundant computations. For example, given a stable
inventory, temporal modeling is performed only once per inventory and episode.
Gridding matrices are calculated only once per model grid definition. Speciation
matrices are calculated only once for each chemical mechanism. These facts
contribute to computational efficiency, as well as to the integrity and
consistency of the model inputs generated by the emission processing system.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
to<span style="mso-bookmark:_Hlt482180969"> </span>top</a><a name="_Hlt482180969"></a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1027" style='position:absolute;
 z-index:2' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:1;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_3.gif" v:shapes="_x0000_s1027" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="Formulation"></a><span style="color:black">Sparse matrix
formulation of emissions modeling<o:p>
</o:p>
</span></h2>
<p class="MsoNormal">Any part of emissions processing that is based on applying
factors to a series of records can be restructure as a sparse matrix
computation. For anthropogenic sources, the following emissions data processing
steps are factor-based operations:</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>projection of emissions from inventory year to model year,</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>application of emission controls,</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>conversion of chemical species from inventory species to chemical
mechanism species (i.e., speciation),</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>spatial allocation of emissions to grid cells in the modeling
domain (gridding), and</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>conversion of inventory emissions to hourly emissions (temporal
allocation).</p>
<p class="MsoNormal">Consequently, emissions modeling has been reorganized by
SMOKE into the following phases:</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b style="mso-bidi-font-weight:normal">Data structuring:</b> order
the data into vectors of emissions data, so that matrix operations are
appropriate;</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b style="mso-bidi-font-weight:normal">Future-past projection:</b>
compute and apply projection factors to emissions inventory;</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b style="mso-bidi-font-weight:normal">Temporal processing:</b>
allocate emissions to hours of modeling episode;</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b style="mso-bidi-font-weight:normal">Chemical speciation
processing: </b>form a sparse matrix of chemical speciation factors;</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b style="mso-bidi-font-weight:normal">Spatial processing:</b>
form a sparse matrix of spatial allocation factors;</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b style="mso-bidi-font-weight:normal">Control processing: </b>form
a sparse matrix of control factors;</p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo1"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b style="mso-bidi-font-weight:normal">Emissions transform:</b>
form the product of all matrices and apply the product matrix to the emissions
inventory vector.</p>
<p class="MsoNormal">The organization described above has a number of
advantages. First of all, the processes are made much more independent and
modular, thereby promoting more reuse of data. For example, the same
time-stepped, source level emissions file is used for the base case and for
control strategies, as well as for each grid in a nest of grids. This design
also avoids many expensive recalculations. The implementation of a new control
strategy involving non-mobile sources, for example, typically requires only the
construction of a new control matrix and a new transform matrix, which is then
used by the emissions transform module. The time required to process a new
control strategy is thereby reduced to minutes, as compared to several days
using traditional emissions processing that requires re-running the entire
emissions preprocessor.</p>
<p class="MsoNormal">The computational performance of SMOKE is even greater
using modern HPC architectures, since the parallelism in the vector-matrix
operations is explicitly available and can take advantage of vendor-optimized
libraries. The use of a specific source ordering eliminates the searches that
degrade con<a name="_Hlt482180667"></a>ventional emissions processor
performance. Redundancy is eliminated in the emissions records, thereby greatly
reducing storage requ<a name="_Hlt482180668"></a>irements and improving data
integrity. However, the user must be aware of the source ordering so that
matrices intended to be used with one inventory are not accidentally used with
other inventory of the same size.</p>
<p class="MsoNormal">Ordinarily, a new control strategy does not require any of
the other components of the emissions processor to be executed. However, special
cases require execution of additional components. For example, if a process is
changed for a source category (e.g., organic solvents are replaced by aqueous
solvents) Spcmat must be executed. Similarly, a change in operating schedule for
a particular source category requires Temporal to be executed.</p>
<p class="MsoNormal">The following sections provide additional detail on each of
the major processing stages.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Ret<span style="mso-bookmark:_Hlt482181068">u</span>rn
to top</a><a name="_Hlt482181068"></a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1030" style='position:absolute;
 z-index:5' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:2;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_4.gif" v:shapes="_x0000_s1030" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="data_structuring"></a>Data structuring</h2>
<p class="MsoNormal">The data structuring operation reads an inventory and puts
its sources into a specific sorted order, stored in SMOKE inventory files. These
files store both emissions and source characteristics, such as location, stack
parameters, source category codes (SCCs), etc. Matrix operations require a
consistent order between related files. The ordering enables assignment of
factors to be made through subscripting instead of searching. In other words,
the index to the SMOKE inventory file will match the index to the speciation
matrix, and assignment of speciation factors is a simple matter of selecting the
same source index from both files.</p>
<p class="MsoNormal">The specific order used is not important for the matrix
multiplication; therefore, the sorting order may be chosen to optimize some
other task. For SMOKE, the sorting order was optimized for efficient use of the
cross-reference and profiles approach to emissions processing. This approach is
described below.</p>
<p class="MsoNormal">The SMOKE program <a href="smoke_programs.htm#SMKINVEN">Smkinven</a>
is responsible for the data structuring operation, but it is not used for
biogenic sources. The Smkinven program is used to import all emissions and
activity data for all source categories but biogenic sources. The program is
designed to import EPS2.0, EMS-95, and inventory data analyzer (IDA) formats.
The latter is the format used by the SMOKE Tool to supply the SMOKE programs
with inventory data.</p>
<p class="MsoNormal">The structure of the SMOKE inventory files is an extremely
important concept in SMOKE. As long as no sources are added or source
characteristics changed, that order will be the same. This means, for example,
that a speciation matrix created for an inventory need not be ever recreated,
unless the inventory or speciation information changes. This speciation matrix
could be used for dozens of grids intersecting the same inventory.</p>
<p class="MsoNormal">If , however, the inventory source list and/or source
characteristics do change, then the user must rerun all subsequent processing
steps. If only the emission values change in the inventory, then the Temporal
step and merge steps must be rerun, because these steps actually output
emissions data values. The main point is that the user should think about what
data are being changed, and what processing steps must subsequently be rerun. Of
course, one can always rerun all steps just to be safe, but this strategy will
ultimately cause more time to be spent on emission processing than is necessary.</p>
<p class="MsoNormal">The SMOKE programs <a href="smoke_programs.htm#Rawbio">Rawbio</a>
(BEIS2) and <a href="smoke_programs.doc#NORMBEIS3">Normbeis3 </a> (BEIS3)
are responsible for the data-structuring operation for biogenic sources. More
information on the data import for biogenic emissions is available in <a href="smoke_src_cat_concepts.htm#Biogenic">Chapter
3</a>.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
to top</a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1029" style='position:absolute;
 z-index:4' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:3;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_5.gif" v:shapes="_x0000_s1029" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="future_past"></a>Future/past projection</h2>
<p class="MsoNormal">The future/past projection operation constructs emission
data sets for years other than a year for which an emissions inventory is
available. For example, if an inventory is available for 1996, but the modeling
effort involves predicting ozone levels in 2007, then the emissions inventory
must be grown to the year 2007. The first step to do this is to create a
projection matrix. In SMOKE, this can be done with the <a href="smoke_programs.htm#CNTLMAT">Cntlmat</a>
program.</p>
<p class="MsoNormal">If no new sources are being added from the inventory year
to the future year, then the emissions values in the SMOKE inventory files can
be multiplied by the projection matrices. In SMOKE, the <a href="smoke_programs.htm#GRWINVEN">Grwinven</a>
program performs these operations. If new sources must be added, then the Data
Structuring (Smkinven) step must be rerun for the new number of sources, then
the future/past Projection (Cntlmat) can be run to create the projection matrix,
and the matrix can be applied to the new inventory file (Grwinven).</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
to top</a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1031" style='position:absolute;
 z-index:6' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:4;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_6.gif" v:shapes="_x0000_s1031" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="temporal"></a>Temporal processing</h2>
<p class="MsoNormal">The temporal processing operation applies factors based on
the source characteristics to the emissions data from the SMOKE inventory files.
The resulting emissions data vectors (not a matrix) contain hourly emissions for
the inventory species. An hourly time step is assumed in the current system.
Most of the calculations are implemented as sparse matrix algebra based upon
temporal cross-references and profiles, augmented by the substitution of values
from day- and hour-specific emissions data sets. For biogenic and mobile
sources, hourly emissions values also depend on meteorology (e.g., temperature
dependence of evaporative emissions). For the more advanced emissions modeling
needed for biogenic emissions, the temporal model is a true simulation model
driven by ambient meteorology and other data. The SMOKE <a href="smoke_programs.htm#TEMPORAL">Temporal</a>
program performs temporal processing for anthropogenic sources and <a href="smoke_programs.htm##TMPBIO">Tmpbio</a>
processes biogenic sources.</p>
<p class="MsoNormal">SMOKE treats the temporal profiles used in the Temporal as <i>local</i>
profiles. In other words, the profile applied to the source is adjusted based on
the difference between the time zone of the source (determined by the country,
state, and county) and the output time zone (selected by the user with the
OUTZONE environment variable). SMOKE automatically considers daylight time when
converting from a regions standard time zone to the output time zone, and
SMOKE can exclude regions that never use daylight time based on the country,
state, and county. While temporal has been tested for time zones in the Western
Hemisphere, we have not tested it (and it is likely that it will fail) for time
zones in the Eastern Hemisphere.</p>
<p class="MsoNormal">For more information on time zones, see <a href="http://time.greenwich2000.com/info/timezone.htm">http://time.greenwich2000.com/info/timezone.htm</a>.
Note that SMOKE expects OUTZONE to be set as a positive number for time zones in
the Western Hemisphere, although standard notation would list these as negative
values. For example, Eastern Standard Time is listed on this site as -5,
but OUTZONE for EST in SMOKE is 5.</p>
<p class="MsoNormal">&nbsp;<o:p>
</o:p>
</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
to top</a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1032" style='position:absolute;
 z-index:7' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:5;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_7.gif" v:shapes="_x0000_s1032" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="speciation"></a>Chemical speciation processing</h2>
<p class="MsoNormal">An emission inventory is built and reported for a variety
of compounds or chemical classes such as CO, NOx, VOC, PM10, and SO2. However,
photochemical mechanisms (e.g., Carbon Bond 4, RADM) contain a simplified set of
equations that use representative model species to represent atmospheric
chemistry. Therefore, source-specific factors are required to convert the
emissions from the chemical classes in the emission inventory to the species in
the photochemical mechanism. The purpose of the chemical speciation processing
operation program is to produce matrices that contain the factors for converting
the input emissions to the species used in the photochemical mechanism of the
air quality model.</p>
<p class="MsoNormal">The resulting mole- and mass-based speciation matrices are
sparse matrices that transform column vectors of inventory-pollutant emissions
into column vectors of model-species emissions. Note that the speciation
matrices depend only upon the chemical mechanism and the inventory, and they are
therefore independent of other factor-based operations for emissions processing.
The SMOKE <a href="smoke_programs.htm#SPCMAT">Spcmat</a> program
performs chemical speciation processing.</p>
<p class="MsoNormal">To support the flexibility inherent in Models-3 and future
needs for reactivity assessments, SMOKE additionally supports run-time,
user-selected inventory pollutants and chemical mechanisms. Although the user
can define any names for pollutants and species, and indeed process any data,
there are limits to how many pollutants and species can be processed at one
time. In the current version of SMOKE, 120 species can be processed at once. The
number of pollutants allowed in the inventory varies by sources category: area
sources, 19; mobile sources 54; and point sources, 15.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
to top</a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1033" style='position:absolute;
 z-index:8' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:6;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_8.gif" v:shapes="_x0000_s1033" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="gridding"></a>Spatial processing</h2>
<p class="MsoNormal">The spatial processing operation or <i style="mso-bidi-font-style:
normal">gridding</i> combines the grid specification for the air-quality
modeling domain with source locations from the SMOKE inventory file. The
resulting gridding matrix is a sparse matrix that describes where the emissions
occur within the modeling domain. The gridding matrix can be applied to the
inventory emissions to transform source-based inventory emissions to gridded
emissions.</p>
<p class="MsoNormal">The SMOKE <a href="smoke_programs.htm#GRDMAT">Grdmat</a>
program performs spatial processing. The gridding step is different depending on
the type of source being processed. For area sources, county-total emissions are
spread among the cells intersecting the county through the use of gridding
surrogates. These surrogates are alternative data sources that can be obtained
as gridded data sets and can reasonably be expected to represent emissions
apportionment among the grid cells in a county. For example, an agriculture
surrogate could be used to apportion farm-based emissions. For mobile sources,
the data can be provided by county as area sources are, or the data can be
provided as line sources (links). County-based mobile emissions are
apportioned with gridding surrogates as well, preferably with surrogates based
on the different road types for which the mobile emissions are provided. The
line source emissions will be apportioned depending on the length of the link in
each cell. Finally, for point sources, emissions are apportioned to the grid
cell intersecting the point.</p>
<p class="MsoNormal">Note that the gridding matrix depends only upon the source
locations, the grid definition, and in some cases gridding surrogates and
cross-references, and it is therefore independent of other steps of emissions
processing.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
to top</a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1034" style='position:absolute;
 z-index:9' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:7;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_9.gif" v:shapes="_x0000_s1034" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="control"></a>Control processing</h2>
<p class="MsoNormal">The control processing operation applies control factors
from a control definition file based on source characteristics in the inventory.
The control scenario definition contains instructions on how to change the
values of emissions based on regulations on corporate activities or personal
behaviors. The resulting control matrix is a diagonal (hence, sparse) matrix of
source-level control factors for each inventory pollutant. Note that the control
matrix depends only upon the source characteristics in the SMOKE inventory and
the set of controls chosen. The control step can therefore be decoupled from the
rest of the processing steps. The SMOKE <a href="smoke_programs.htm#CNTLMAT">Cntlmat</a>
program performs control processing for area, mobile, and point sources.
However, mobile sources controls are typically implemented by using different
input files in generating mobile source emission factors.</p>
<p class="MsoNormal">In SMOKE v1, a new type of control has been added that
requires more than simple factors for changing the emissions values. <a href="#reactivity_controls">Reactivity
controls</a>, explained in more detail below, also depend on a future year SCC,
which means that the process causing the emissions is changing in the future
year. This type of control can impact speciation profiles, as well as the base
year emissions data values.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
to<span style="mso-bookmark:_Hlt482181051"> </span>top</a><a name="_Hlt482181051"></a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1035" style='position:absolute;
 z-index:10' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:8;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_10.gif" v:shapes="_x0000_s1035" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="merge"></a>Emissions transform</h2>
<p class="MsoNormal">Emissions transformation (also called merging) occurs when
one or more of the matrices are applied to emissions data. This is typically
done to prepare emissions for an air-quality model (AQM), when one multiplies
the control matrix, the gridding matrix, and the speciation matrix to produce a
composite transform matrix, and then applies this combined matrix to the hourly
emission vectors. This vector-matrix multiplication is implemented by the SMOKE <a href="smoke_programs.htm#SMKMERGE">Smkmerge</a>
program. In addition, the <a href="smoke_programs.htm#SMKMERGE">Smkmerge</a>
program can multiply only the gridding matrix, or only the gridding and
speciation matrices to the emissions, and it can multiply these with the annual
emissions or the hourly emissions, permitting the user to evaluate the emissions
with various stages of processing. The <a name="_Hlt482338186"></a><a href="../word/smoke_programs.htm#SMKMERGE"><span style="mso-bookmark:_Hlt482338186">Smkmerge</span></a>
program also combines the emissions data from two or more source categories.</p>
<p class="MsoNormal">Because the processing steps in SMOKE are typically
independent, a change in one of those steps does not usually require redoing the
other steps. In order to generate model-input data files, however, the merge
step always needs to be rerun when changes are made in other steps.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
to top</a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1036" style='position:absolute;
 z-index:11' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:9;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_11.gif" v:shapes="_x0000_s1036" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="processing_exceptions"></a><a name="xrefs_and_profiles"></a><span style="mso-bookmark:processing_exceptions">Processing
exceptions</span></h2>
<p class="MsoNormal">A few exceptions to the idea of independent emissions
processing steps must be explained. First, biogenic processing is different than
processing for other source categories. The landuse data provided as input to
biogenic source processing are either already gridded or are converted from
county data to a gridded dataset at the start of processing. This approach is in
contrast to processing for other source categories, in which gridded data files
are not created until the merge step.</p>
<p class="MsoNormal">Second, the temporal allocation of biogenic processing is
completely meteorology dependant, because no anthropogenic activities are
considered for modeling these emissions. So, the temporal factors used for
anthropogenic emissions simply do not apply for biogenic emissions processing.</p>
<p class="MsoNormal">Third, the biogenic inventory pollutants are fixed in
the current system. Although additional data are available, the BEIS2 model
groups all biogenic emissions into four categories: monoterpenes, isoprene,
nitrogen oxide, and other VOCs. All speciation profiles that are applied for
biogenic emissions are limited to these compounds or groups of compounds as a
starting point in the current system.</p>
<p class="MsoNormal">Fourth, temporal allocation for mobile source emissions
depends partly on gridded temperatures. This causes an interdependence between
gridding and temporal allocation for mobile sources. This relationship is
handled in SMOKE through the concept of ungridding. Ungridding is a term
we use to describe the concept of converting gridded temperatures to
source-based temperatures. In this process, the values of the gridded
temperatures are combined using a weighted average of temperatures in grid cells
that intersect an area or line mobile source. These temperatures are weighted
based on the gridding factors, and the weighting factors are stored in an
ungridding matrix.</p>
<p class="MsoNormal">The fifth exception is also for mobile-source temporal
allocation. SMOKE currently can use MOBILE5b to generate emission factors. For
some types of evaporative emissions, MOBILE5b depends on the minimum and maximum
daily temperatures. Consequently, SMOKE has an additional mobile processing
step: the <a href="smoke_programs.htm#PREMOBL">Premobl </a> program. The
program computes the minimum and maximum daily temperatures by source and by
day. These temperature combinations are supplied to MOBILE5b to generate the
appropriate daily emission factors.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return<span style="mso-bookmark:_Hlt482181108">
</span>to<span style="mso-bookmark:_Hlt482331840"> </span>top</a><a name="_Hlt482331840"></a><a name="_Hlt482181108"></a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1037" style='position:absolute;
 z-index:12' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><v:line id="_x0000_s1038" style='position:absolute;z-index:13' from="0,12pt"
 to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4" strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:10;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_12.gif" v:shapes="_x0000_s1037 _x0000_s1038" width="631" height="8"></span><a name="_Hlt482180665"></a>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="processing_diagrams"></a><a name="reactivity_controls"></a><span style="color:black">Reactivity
controls<o:p>
</o:p>
</span></h2>
<p class="MsoNormal">Several issues are important when addressing emissions
processing requirements for reactivity assessments. First, reactivity assessment
involves the replacement of one compound in the inventory by another compound.
This replacement can impact emission projections, the total magnitude of the
inventory pollutants, and the associated SCCs. The market penetration of the
replacement compound may vary in time and space, which affects the future-year
emissions. Also, the replacement compound may be needed in much greater or much
smaller amounts, thereby affecting the total inventory emissions. Finally, if a
different process is required to use the different compound, the SCC for that
source may change.</p>
<p class="MsoNormal">Second, the scale of the reactivity assessment is
important, and it could be local, statewide, or national. The local case could
involve investigating reactivity for one source. The statewide case could be
implementing a change in compound based on reactivity considerations for a State
Implementation Plan (SIP), and this would affect sources across the state. The
national case could involve an EPA investigation of the formulation of
nationally distributed consumer products.</p>
<p class="MsoNormal">Third, exemptions from controls for certain sources must be
permitted as part of an emissions control strategy. These exemptions can occur
when a reactivity assessment determines that certain compounds and/or processes
do not significantly affect pollution formation.</p>
<p class="MsoNormal">To address these issues, SMOKE v1 is able to target changes
in a VOC for specific classes of VOC emissions, and address the spatial and
temporal considerations implied by market penetration issues. Furthermore, when
replacement options are being investigated, the correct replacement operations
are facilitated by SMOKE. These operations include selecting sources, changing
underlying pollutant emissions, changing SCCs, correctly projecting future-year
emissions based in part on market penetration issues, and appropriately
speciating emissions for the new compound.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_smoke_concepts">Return
to t<span style="mso-bookmark:_Hlt482180499">o</span>p</a><a name="_Hlt482180499"></a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1040" style='position:absolute;
 z-index:15' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:12;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_13.gif" v:shapes="_x0000_s1040" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2>Cross-references and profiles</h2>
<p class="MsoNormal">SMOKE uses profile tables and cross-reference tables to
convert the emissions resolution for gridding, temporal allocation, speciation,
and for mobile source emission factor assignment. The profile tables contain the
factors for converting emissions from one resolution to another. For example,
for converting from daily emissions to hourly emissions, SMOKE uses 24 factors
(one for each hour). Each profile entry is assigned a profile number. The
cross-reference tables assign the profiles to each source. They contain source
characteristics and the profile numbers to use when SMOKE matches the source
characteristics in this file to a source. The cross-reference tables are applied
to the sources in a stepwise manner, such that the most specific entry is always
applied. For example, if a cross-reference entry were available for a specific
plant, stack, and source category code (SCC), SMOKE would apply it instead of
the cross-reference entry that matched that source only by SCC. These profiles
and cross-references are prepared as part of the inventory primarily from data
collected and assimilated by EPA.</p>
<p class="MsoNormal">SMOKE handles cross-references and profile application in a
very efficient manner. In reading a cross-reference file, SMOKE first sorts the
cross-reference records using the same sort criteria as is used for the
inventory records. Then, these records are grouped according to the level
of matching of each of the entries. For example, all entries that match to the
inventory using only state and county codes would be in one group, while entries
that match to the inventory using only SCCs would be in another group. Once the
cross-reference entries are grouped, SMOKE loops through all records in the
inventory, and can attempt to find a matching entry in one of the
cross-reference groups. The most specific groups are searched first, such that
when a match is found, the other groups are not searched. Because the
cross-reference entries are sorted within each group, an efficient searching
algorithm can be used. When a match to one of the cross-reference groups has
been found, SMOKE continues to the next source in the inventory. This approach
is much more efficient than other assignment methods.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Ret<span style="mso-bookmark:_Hlt482180551">u</span>rn
to<span style="mso-bookmark:_Hlt482181104"> </span>top</a><a name="_Hlt482181104"></a><a name="_Hlt482180551"></a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1028" style='position:absolute;
 z-index:3' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:13;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_14.gif" v:shapes="_x0000_s1028" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="file_formats"></a>File Formats</h2>
<p class="MsoNormal">SMOKE uses two types of file formats: ASCII files and
Input/Output Applications Programming Interface (I/O API) files.</p>
<p class="MsoNormal">ASCII files are simply text files that most computer users
are familiar with. The ASCII files input by SMOKE come in two structures:
column-specific and list-directed. In column-specific files, the fields in the
files must appear in certain columns in the file. Each character on a line
represents a single column. For example, a left-justified entry such as:</p>
<blockquote>
  <blockquote>
<p class="Preformatted"><span class="Typewriter">TEST<o:p>
</o:p>
</span></p>
  </blockquote>
</blockquote>
<p class="MsoNormal">is in the columns 1 through 4.</p>
<p class="MsoNormal">In list-directed files, the exact positioning of the fields
on a line is not important, but the order of the fields on that line is
important. The fields must be delimited, and in SMOKE, they can be delimited by
spaces, commas, or semi-colons. If a field contains any of these delimiters,
then it must be provided in single or double quotes.<span style="display:none;
mso-hide:all"><o:p>
</o:p>
</span></p>
<p class="MsoNormal">I/O API files are read and written by a library that SMOKE
uses. More information on this library is available at <a href="http://envpro.ncsc.org/products/ioapi">http://www.emc.mcnc.org/products/ioapi</a>.
These files cannot be viewed with a text editor because they are binary files.
The binary files use less disk space than ASCII files containing the same data.
They also provide for much more efficient input and output of the data, and the
I/O API library provides many quality assurance features useful for all I/O,
including I/O for emissions processing.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
to top</a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1041" style='position:absolute;
 z-index:16' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:14;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_15.gif" v:shapes="_x0000_s1041" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2><a name="environment_variables"></a>Environment Variables</h2>
<p class="MsoNormal">Environment variables are how SMOKE communicates with its
operating environment. As is described in more detail in <a href="smoke_environment.htm">Chapter
5</a>, SMOKE can be used from scripts, the Models-3 Study Planner, or with the <a href="http://www.emc.mcnc.org/EDSS">Environmental
Decision Support System (EDSS) Study Pla<span style="mso-bookmark:_Hlt482341997">n</span>ner</a>.
The are several different uses for environment variables including assigning
file names, setting options, and setting operating parameters.</p>
<p class="MsoNormal">For example, an environment variable in the Unix
environment C-shell is defined using the <span class="Variable">setenv</span>
command. For example, to define the FILENAME environment variable to the file <i style="mso-bidi-font-style:normal">testfile.txt</i>
in the <i style="mso-bidi-font-style:
normal">/home/user/</i> directory:</p>
<blockquote>
  <blockquote>
<p class="MsoNormal"><span style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;" class="Typewriter">setenv
FILENAME /home/user/testfile.txt<o:p>
</o:p>
</span></p>
  </blockquote>
</blockquote>
<p class="MsoNormal">Much more will be described about environment variables and
the variables that SMOKE uses in subsequent chapters.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
t<span style="mso-bookmark:_Hlt482342253">o</span> top</a><a name="_Hlt482342253"></a>]</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1042" style='position:absolute;
 z-index:17' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:15;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_16.gif" v:shapes="_x0000_s1042" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<h2>Logical File Names</h2>
<p class="MsoNormal">Environment variables that programs use to access files are
called <i style="mso-bidi-font-style:normal">logical file names</i>. In the
example above, FILENAME is the logical file name for the physical file
/home/user/testfile.txt. The I/O API is based on logical file names, and since
SMOKE uses the I/O API for accessing all of its files, it too uses logical file
names. The benefit of logical file names is that the programs do not require
that the physical files always have the same name. Instead, the logical file
names can be defined each time a program is run to use whatever physical file
names the user would like. In Chapters 7 through 9 the logical file names are
used to reference the files, their associations with programs, and their
formats.</p>
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="#Chapter_2_SMOKE_concepts">Return
to<span style="mso-bookmark:_Hlt482342257"> </span>top</a><a name="_Hlt482342257"></a>]<o:p>
</o:p>
</span></p>
<p class="MsoNormal"><!--[if gte vml 1]><v:line id="_x0000_s1039" style='position:absolute;
 z-index:14' from="0,12pt" to="468pt,12.05pt" o:allowincell="f" strokecolor="#d4d4d4"
 strokeweight="1.75pt">
 <v:shadow on="t" origin=",32385f" offset="0,-1pt"/>
</v:line><![endif]-->
<span style="mso-ignore:vglayout;position:
relative;z-index:16;left:-3px;top:12px;width:631px;height:20px"><img src="smoke_17.gif" v:shapes="_x0000_s1039" width="631" height="8"></span>&nbsp;<o:p>
</o:p>
</p>
<br style="mso-ignore:vglayout" clear="ALL">
<p class="MsoNormal"><span style="display:none;mso-hide:all">[<a href="../word/smoke_user_doc.htm#TOP">Return
to Ta<span style="mso-bookmark:_Hlt482331833">b</span>le of Contents</a><a name="_Hlt482331833"></a>]</span></p>

</body>

</html>
