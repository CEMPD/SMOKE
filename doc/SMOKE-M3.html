<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML> 
<HEAD>
<TITLE> 
    SMOKE Version 1.0 release
</TITLE>
</HEAD>
   
<BODY BGCOLOR="FFFFFF">
<!--#include virtual="/INCLUDES/header.html" -->

<HR> <!----------------------------------------------------------------->
<H1>
    Models-3 and SMOKE Integration
</H1>

<HR> <!----------------------------------------------------------------->

<H2> <A NAME = "contents"> Contents </A> </H2>
<UL>
   <LI> <A HREF = "#purpose"> Purpose and benefits of Models-3/SMOKE 
        integration</A>
   <LI> <A HREF = "#status"> Status of Integration</a>
   <LI> <A HREF = "#enhance"> SMOKE Enhancements</A>
   <LI> <A HREF = "#docs"> Documentation</A>
</UL>

<blockquote><b>
 Copyright &copy; 1999 MCNC--North Carolina Supercomputing Center <br>
 All rights reserved
</b></blockquote>

<HR> <!----------------------------------------------------------------->

<A NAME = "purpose">
<H3> Purpose and Benefits of Models-3/SMOKE Integration</H3>

The Sparse Matrix Operator Kernel Emission (SMOKE) modeling system has been
revised to be integrated with the Environmental Protection Agency's (EPA's) 
<a href = "http://www.epa.gov/asmdnerl/models3/"> Models-3 Air Quality Modeling
System</a> for support of (1) emissions processing with user-selected chemical
mechanisms and (2) emissions processing for reactivity assessments.  <p>

Several benefits  from the merger of Models-3 and the new version of
SMOKE are:

<ol>
  <li> Very fast emissions processing (minutes instead of days).
  <li> Reduced disk-space requirements for emissions in Models-3.
  <li> Any pollutant can be processed in the system for area and point sources.
  <li> Any chemical mechanism can be used to partition pollutants to model
       species, as long as the appropriate input data are supplied.
  <li> Control strategies can include changes in the reactivity of emitted
       pollutants. This is needed, for example, when a solvent is changed in an
       industrial process.
  <li> Run-time memory allocation, eliminating any need to recompile the system
       for different inventories, grids, or chemical mechanisms.
  <li> Multi-country capability.
  <li> User-interface for preparation of emission inventory and other SMOKE 
       inputs.
  <li> Gridded land-use input capability and several options for using
       meteorological data for biogenic emissions, using SMOKE-BEIS2.
</ol>

<A NAME = "status"> 

<H3> Status of Models-3/SMOKE Integration</H3>

The initial project to integration SMOKE and Models-3 was completed in
November, 1999.  A copy of the final report is available online at the <a href
= "SMOKEDOCS.html"> SMOKE Documentation page</a>.  Through the project, we
accomplished all of the SMOKE Enhancements listed below. However, some difficult
issues for using SMOKE from Models-3 remain.  These are listed in the final
project report.  Current efforts are underway to complete the integration to
permit release of SMOKE with Models-3 in the near future.<p>

<A NAME = "enhance"> 
<H3> SMOKE Enhancements</H3>

In order to realize the benefits, SMOKE required many enhancements:

<H4> Reactivity Assessment</H4>

There are several issues that are important when addressing emissions
processing requirements for reactivity assessments. First, reactivity
assessment involves the replacement of one compound in the inventory by 
another compound, and this replacement can impact emission projections, the
total magnitude of the inventory pollutants, and the associated source
classification codes (SCCs). The market penetration of the replacement compound
may vary in time and space, which affects the future-year emissions. Also, the
replacement compound may be needed in much greater or much smaller amounts, and
this affects the total inventory emissions. Finally, if a different process is
required to use the different compound, the SCC for that source may change.<p>

Second, the scale of the reactivity assessment is important, and it could be
local,  statewide, or national. The local case could involve investigating
reactivity for one  source. The statewide case could be implementing a change
in compound based on reactivity considerations for a State Implementation Plan
(SIP), and this would affect sources across the state. The national case could
involve an EPA investigation of the formulation of nationally distributed
consumer products.<p>

Third, exemptions from controls for certain sources must be permitted as part
of an emissions control strategy. These exemptions can occur when a reactivity
assessment determines that certain compounds and/or processes do not
significantly affect pollution formation.<p>

To address these issues, SMOKE must be able to target changes in a volatile
organic compound (VOC) for specific classes of VOC emissions, and address the
spatial and temporal considerations implied by market penetration issues.
Furthermore, when replacement options are being investigated, the correct
replacement operations need to be facilitated by SMOKE. These operations
include selecting sources, changing underlying pollutant emissions, changing
SCCs, correctly projecting future-year emissions based in part on market
penetration issues, and appropriately speciating emissions for the new
compound.<p>

<H4>User-selected inventory pollutants and chemical mechanisms</H4>

To support the flexibility inherent in Models-3 and support future needs for
reactivity assessments using Models-3, SMOKE must be enhanced to support
run-time, user-selected inventory pollutants and chemical mechanisms. These
enhancements will affect existing SMOKE components for inventory import,
temporal processing, speciation matrix generation, control matrix generation,
quality assurance, and merge processing. Models-3 does not currently support
inventory pollutants for mobile sources other than those output by Mobile5.
Mobile5 generates only CO, NOx, and one of either VOC, total hydrocarbons
(THC), non-methane hydrocarbons (NMHC), total organic gases (TOG), or
non-methane organic gases (NMOG). All of these mobile pollutants are supported
by SMOKE when the appropriate input files are provided, so the mobile-source
programs will require few changes in this regard.<p>

<H4>Run-time memory allocation</H4>

All major components of the new version of SMOKE will use FORTRAN 90 to
allocate memory dynamically (at run-time).  This will eliminate the requirement of the old version of SMOKE for recompiling for different inventories, grids, 
number of states/counties, etc.  The same executable will be used for all
runs.  Dynamic memory allocation will also reduce the memory requirements of
most of the SMOKE programs.

<H4>Transfer of Models-3 science manager database objects to SMOKE</H4>

The Models-3 database contains a number of objects with which SMOKE will have
to interface: horizontal grids, vertical grids, chemical mechanisms, and
modeling cases. The horizontal grid objects will include the grid projection
type and parameters, number of cells in both directions, and grid size in both
directions. The vertical grid objects will include the number of emissions
layers and the sigma coordinates for those layers. The chemical mechanisms will
include the model species expected by the Models-3 air quality model, and the
modeling case will include a scenario name and time period (episode) for
processing. In current applications of SMOKE, such inputs are prepared by the
user via include files and environment variables before SMOKE is compiled and
run.<p>

<H4>Projection and Control Completeness and interfacing with Models-3</H4>

The projection and controls of emissions involve several issues: point of data
transfer, area- and point-source projection, mobile-source vehicle miles
traveled (VMT) projection, area- and point-source controls, grouping sources
for projection and controls, and transfer of grown and/or controlled emissions
back to the existing Models-3 emissions QA components. The point of data
transfer is an interface being developed for Models-3 that will allow the
Models-3 user to access SMOKE. The structure of area- and point-source
projection and control files could be affected by the unique requirements of
reactivity assessments (e.g., market penetration of a replacement solvent
increasing over time), and SMOKE may require enhancements to support those
files. SMOKE enhancements will certainly be needed to add projection of VMT for
mobile sources because this is not currently part of SMOKE. SMOKE will also
need to be able to apply projection and controls to groups of sources, instead
of requiring inputs for one source at a time. Finally, for QA purposes, a
useful and optional component is a mechanism to supply future-year and/or
controlled emissions back to the Models-3 SMOKE interface.<p>

<H4>Support of the CMAQ model inputs and plume-in-grid</H4>

The Models-3 air quality model requires a 3-D gridded emissions file as input.
This file is created by the emissions postprocessor ECIP in Models-3, which
computes plume rise for all major point sources (MPSs). If plume-in-grid is to
be used in the Models-3 air qualirt model, then ECIP excludes the major
elevated point source emissions (MEPSEs) from the 3-D output file. Then the
Plume Dynamics Model (PDM) is used to create a file containing plume dynamics
calculations for all of the MEPSE stacks. The PDM output file and an hourly
emissions file from OUTPRO for MEPSEs are additional inputs to the Models-3 air
quality model for plume-in-grid processing. <P>

In SMOKE, plume rise can be included as part of the emissions processing, and
when it is included, it is computed for all point sources. The current version
of SMOKE does not have any way to identify MPSs or MEPSEs, although the
Elevpoint program can be used to separate elevated from low-level point
sources. Furthermore, SMOKE does not have a mechanism to supply inputs to a
plume-in-grid model. These issues will need to be addressed so that SMOKE can
drive the Models-3 air quality model.<P>

Also, the units of the existing emissions files can be either moles or grams,
but SMOKE currently supports only moles. SMOKE will need to be able to output
either moles or grams.<p>

<H4> Flexible point-source definitions</H4>

Depending on the input format of point source emissions, the unique set of
characteristics (or <em>keys</em>) that are used to uniquely identify a point
sources are different.  For example, different point source definitions are
used in the input file formats of the Emissions Preprocessing System 2.0
(EPS2.0) and the Emissions Modeling System, 95 (EMS-95). Also, the National
Emission Trends (NET) format has yet another definition of point sources.  In
order to better support all of these formats, SMOKE will be updated to permit a
flexible definition of point sources. This definition will consist of the
following keys:
<ul>
  <li>Country, state, and county code
  <li>Plant ID (15 characters or less)
  <li>Characteristics 1 through 5 (all 15 characters or less)
</ul>

Depending on the input format, SMOKE assigns different variables from the input
format to the fields of the SMOKE point source definition.

<A NAME = "docs">
<H3> Documentation</H3>

<ul>
   <li> Slides from August 17th software demo: 
        <a href="locdocs/smoke_demo.ppt"> Powerpoint 97 format</a> (397 KB);
        <a href="locdocs/smoke_demo_slide.pdf"> PDF format </a>(158 KB)</li>

</ul>

<HR> <!----------------------------------------------------------------->

<STRONG><A HREF = "INTRO.html">
<B>Next:</B>  SMOKE Introduction
</A></STRONG>
<P>

<A HREF = "index.html">  
<B>Top:</B>  SMOKE Root Document  </A>
<P> 


<!--#include virtual="/INCLUDES/footer.html" -->
</BODY>      <!--end body  -->
</HTML>      <!--end html  -->

